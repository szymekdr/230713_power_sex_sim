<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.36">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Szymek Drobniak">
<meta name="dcterms.date" content="2023-08-03">

<title>Sex &amp; statistical power - simulations</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="code_files/libs/clipboard/clipboard.min.js"></script>
<script src="code_files/libs/quarto-html/quarto.js"></script>
<script src="code_files/libs/quarto-html/popper.min.js"></script>
<script src="code_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="code_files/libs/quarto-html/anchor.min.js"></script>
<link href="code_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="code_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="code_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="code_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="code_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#scenarios-from-fig.-3" id="toc-scenarios-from-fig.-3" class="nav-link active" data-scroll-target="#scenarios-from-fig.-3"> <span class="header-section-number">1</span> Scenarios from Fig. 3</a>
  <ul class="collapse">
  <li><a href="#from-original-paper" id="toc-from-original-paper" class="nav-link" data-scroll-target="#from-original-paper"> <span class="header-section-number">1.1</span> From original paper</a></li>
  <li><a href="#sec-powerbreakdown" id="toc-sec-powerbreakdown" class="nav-link" data-scroll-target="#sec-powerbreakdown"> <span class="header-section-number">1.2</span> Heteroscedastic sex variances</a></li>
  </ul></li>
  <li><a href="#scenarios-from-fig.-4---interaction-of-magnitude" id="toc-scenarios-from-fig.-4---interaction-of-magnitude" class="nav-link" data-scroll-target="#scenarios-from-fig.-4---interaction-of-magnitude"> <span class="header-section-number">2</span> Scenarios from Fig. 4 - interaction of magnitude</a>
  <ul class="collapse">
  <li><a href="#from-original-paper-1" id="toc-from-original-paper-1" class="nav-link" data-scroll-target="#from-original-paper-1"> <span class="header-section-number">2.1</span> From original paper</a></li>
  <li><a href="#heteroscedastic-sex-variances" id="toc-heteroscedastic-sex-variances" class="nav-link" data-scroll-target="#heteroscedastic-sex-variances"> <span class="header-section-number">2.2</span> Heteroscedastic sex variances</a></li>
  </ul></li>
  <li><a href="#scenarios-from-fig.-5---interaction-of-direction" id="toc-scenarios-from-fig.-5---interaction-of-direction" class="nav-link" data-scroll-target="#scenarios-from-fig.-5---interaction-of-direction"> <span class="header-section-number">3</span> Scenarios from Fig. 5 - interaction of direction</a>
  <ul class="collapse">
  <li><a href="#from-original-paper-2" id="toc-from-original-paper-2" class="nav-link" data-scroll-target="#from-original-paper-2"> <span class="header-section-number">3.1</span> From original paper</a></li>
  <li><a href="#heteroscedastic-sex-variances-1" id="toc-heteroscedastic-sex-variances-1" class="nav-link" data-scroll-target="#heteroscedastic-sex-variances-1"> <span class="header-section-number">3.2</span> Heteroscedastic sex variances</a></li>
  </ul></li>
  <li><a href="#impact-of-sample-size-on-power" id="toc-impact-of-sample-size-on-power" class="nav-link" data-scroll-target="#impact-of-sample-size-on-power"> <span class="header-section-number">4</span> Impact of sample size on power</a>
  <ul class="collapse">
  <li><a href="#large-sex-eff-no-ix-5" id="toc-large-sex-eff-no-ix-5" class="nav-link" data-scroll-target="#large-sex-eff-no-ix-5"> <span class="header-section-number">4.1</span> Large sex eff, no ix</a></li>
  <li><a href="#large-sex-effect-crossed-reaction-norms-interaction" id="toc-large-sex-effect-crossed-reaction-norms-interaction" class="nav-link" data-scroll-target="#large-sex-effect-crossed-reaction-norms-interaction"> <span class="header-section-number">4.2</span> Large sex effect, crossed reaction norms (interaction)</a></li>
  <li><a href="#summaries-of-sample-size-scenarios" id="toc-summaries-of-sample-size-scenarios" class="nav-link" data-scroll-target="#summaries-of-sample-size-scenarios"> <span class="header-section-number">4.3</span> Summaries of sample size scenarios</a></li>
  </ul></li>
  <li><a href="#simulating-sample-size" id="toc-simulating-sample-size" class="nav-link" data-scroll-target="#simulating-sample-size"> <span class="header-section-number">5</span> Simulating sample size</a>
  <ul class="collapse">
  <li><a href="#simulations-assuming-target-power-80" id="toc-simulations-assuming-target-power-80" class="nav-link" data-scroll-target="#simulations-assuming-target-power-80"> <span class="header-section-number">5.1</span> Simulations assuming target power = 80%</a></li>
  <li><a href="#combined-plots" id="toc-combined-plots" class="nav-link" data-scroll-target="#combined-plots"> <span class="header-section-number">5.2</span> Combined plots</a></li>
  </ul></li>
  <li><a href="#source-of-heterogeneity" id="toc-source-of-heterogeneity" class="nav-link" data-scroll-target="#source-of-heterogeneity"> <span class="header-section-number">6</span> Source of heterogeneity</a>
  <ul class="collapse">
  <li><a href="#poisson-distribution" id="toc-poisson-distribution" class="nav-link" data-scroll-target="#poisson-distribution"> <span class="header-section-number">6.1</span> Poisson distribution</a></li>
  <li><a href="#log-normal-distribution" id="toc-log-normal-distribution" class="nav-link" data-scroll-target="#log-normal-distribution"> <span class="header-section-number">6.2</span> Log-normal distribution</a></li>
  <li><a href="#combined-plot" id="toc-combined-plot" class="nav-link" data-scroll-target="#combined-plot"> <span class="header-section-number">6.3</span> Combined plot</a></li>
  <li><a href="#non-linear-response-in-sexes" id="toc-non-linear-response-in-sexes" class="nav-link" data-scroll-target="#non-linear-response-in-sexes"> <span class="header-section-number">6.4</span> Non-linear response in sexes</a></li>
  </ul></li>
  <li><a href="#taylor-law-in-comparative-data" id="toc-taylor-law-in-comparative-data" class="nav-link" data-scroll-target="#taylor-law-in-comparative-data"> <span class="header-section-number">7</span> Taylor law in comparative data</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Sex &amp; statistical power - simulations</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Szymek Drobniak </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">August 3, 2023</p>
    </div>
  </div>
    
  </div>
  

</header>

<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pander)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggridges)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Analysis preps (colours, options, auxiliary functions)</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>cbb_palette <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#000000"</span>, <span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>, <span class="st">"#009E73"</span>, <span class="st">"#F0E442"</span>,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#0072B2"</span>, <span class="st">"#D55E00"</span>, <span class="st">"#CC79A7"</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Avoid table wrapping</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">width =</span> <span class="dv">800</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">999</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">"PhillipsKarpEtal_data/funs.r"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Below results repeat simulations from the paper of <em>Phillips et al.&nbsp;(2018) PLoS Biol 21(6): e3002129</em>. Original results simplified by removing the post-hoc and the (pooled) t-test methods of analysing data. Generation of simulated data was modified to use a formal linear model defined as:</p>
<p><span class="math display">\[\mathbf{y} = \mathbf{X}\mathbf{b} + \mathbf{e}\]</span></p>
<p>with <span class="math inline">\(\mathbf{b}=(\mu,\beta_{Treat},\beta_{Sex},\beta_{Treat:Sex})\)</span> and <span class="math inline">\(\mathbf{e} \sim \mathcal{N}(\mathbf{0}, \mathbf{s})\)</span>, with <span class="math inline">\(\mathbf{s}=\sigma\sqrt{\mathbf{1}+\mathbf{X}_{Sex}\cdot\alpha}\)</span> (<span class="math inline">\(\alpha\)</span> quantifies the amount of heteroscedasticity in sex variances, with <strong>SD</strong> <span class="math inline">\(\sigma_{m}=\sigma_{f}\sqrt{1+\alpha}\)</span>, or male <strong>variance</strong> being <span class="math inline">\(\alpha\cdot100\%\)</span> greater than female). Regression coefficients (<span class="math inline">\(\mathbf{b}\)</span>) are compatible with contrasts (sex/treatment effects) used in Phillips et al.&nbsp;(2023).</p>
<section id="scenarios-from-fig.-3" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Scenarios from Fig. 3</h1>
<section id="from-original-paper" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="from-original-paper"><span class="header-section-number">1.1</span> From original paper</h2>
<p><strong>Assuming homoscedasticity of sex variances</strong></p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">No sex eff, no ix</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">Small sex eff, no ix</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false" href="">Large sex eff, no ix</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span><span class="dv">0</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>all_effs_sex_none <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a>calc_power_sex_none <span class="ot">&lt;-</span> all_effs_sex_none <span class="sc">%&gt;%</span></span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"none"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"none"</span>))</span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a>calc_power_sex_none <span class="sc">%&gt;%</span></span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb3-92"><a href="#cb3-92" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb3-93"><a href="#cb3-93" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb3-94"><a href="#cb3-94" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>all_effs_sex_small <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb4-76"><a href="#cb4-76" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb4-77"><a href="#cb4-77" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb4-78"><a href="#cb4-78" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb4-79"><a href="#cb4-79" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-80"><a href="#cb4-80" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-81"><a href="#cb4-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-82"><a href="#cb4-82" aria-hidden="true" tabindex="-1"></a>calc_power_sex_small <span class="ot">&lt;-</span> all_effs_sex_small <span class="sc">%&gt;%</span></span>
<span id="cb4-83"><a href="#cb4-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-84"><a href="#cb4-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb4-85"><a href="#cb4-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb4-86"><a href="#cb4-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"small"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb4-87"><a href="#cb4-87" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"none"</span>))</span>
<span id="cb4-88"><a href="#cb4-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-89"><a href="#cb4-89" aria-hidden="true" tabindex="-1"></a>calc_power_sex_small <span class="sc">%&gt;%</span></span>
<span id="cb4-90"><a href="#cb4-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb4-91"><a href="#cb4-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb4-92"><a href="#cb4-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb4-93"><a href="#cb4-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb4-94"><a href="#cb4-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>all_effs_sex_large <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb5-75"><a href="#cb5-75" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb5-76"><a href="#cb5-76" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb5-77"><a href="#cb5-77" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb5-78"><a href="#cb5-78" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb5-79"><a href="#cb5-79" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb5-80"><a href="#cb5-80" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-81"><a href="#cb5-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-82"><a href="#cb5-82" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large <span class="ot">&lt;-</span> all_effs_sex_large <span class="sc">%&gt;%</span></span>
<span id="cb5-83"><a href="#cb5-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-84"><a href="#cb5-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb5-85"><a href="#cb5-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb5-86"><a href="#cb5-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb5-87"><a href="#cb5-87" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"none"</span>))</span>
<span id="cb5-88"><a href="#cb5-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-89"><a href="#cb5-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-90"><a href="#cb5-90" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large <span class="sc">%&gt;%</span></span>
<span id="cb5-91"><a href="#cb5-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb5-92"><a href="#cb5-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb5-93"><a href="#cb5-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb5-94"><a href="#cb5-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb5-95"><a href="#cb5-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<p>Plots combining all scenarios from Fig. 1</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="ot">&lt;-</span> <span class="fu">rbind</span>(calc_power_sex_none, calc_power_sex_small,</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>                               calc_power_sex_large)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">lapply</span>(all_sex_effs_sex_only, unlist))</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="sc">%&gt;%</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Effect <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Treatment"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">factor</span>(sex_eff_size,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"none"</span>, <span class="st">"small"</span>, <span class="st">"large"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">recode</span>(method,</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"ANOVA"</span> <span class="ot">=</span> <span class="st">"Factorial"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> sex_eff_size,</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> <span class="fu">interaction</span>(sex_eff_size, method))) <span class="sc">+</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> method)) <span class="sc">+</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Statistical power"</span>) <span class="sc">+</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Main treatment effect"</span>) <span class="sc">+</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">name =</span> <span class="st">"Sex effect size"</span>, <span class="at">values =</span> cbb_palette) <span class="sc">+</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_discrete</span>(<span class="at">name =</span> <span class="st">"Stat method"</span>)  <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(!Effect %in% c("T-Test Treatment Eff")) %&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">factor</span>(sex_eff_size,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"none"</span>, <span class="st">"small"</span>, <span class="st">"large"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> <span class="fu">interaction</span>(sex_eff_size, Effect))) <span class="sc">+</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> sex_eff_size)) <span class="sc">+</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Statistical power"</span>) <span class="sc">+</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Main treatment effect"</span>) <span class="sc">+</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">name =</span> <span class="st">"Effect"</span>, <span class="at">values =</span> cbb_palette) <span class="sc">+</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_discrete</span>(<span class="at">name =</span> <span class="st">"Sex effect size"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="sec-powerbreakdown" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="sec-powerbreakdown"><span class="header-section-number">1.2</span> Heteroscedastic sex variances</h2>
<p>We assume several scenarios with <span class="math inline">\(\alpha\)</span> equal to 0 (the above scenarios), 1 and 2, which relates to 100% or 200% increase in male variance, in relation to female variance (or ~44% and ~73% increase in male SD). The direction of sex bias is arbitrary.</p>
<p><strong>Low heteroscedasticity</strong></p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true" href="">No sex eff, no ix</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false" href="">Small sex eff, no ix</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false" href="">Large sex eff, no ix</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>all_effs_sex_none_lowh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb9-62"><a href="#cb9-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb9-63"><a href="#cb9-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb9-64"><a href="#cb9-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb9-65"><a href="#cb9-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb9-66"><a href="#cb9-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb9-67"><a href="#cb9-67" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb9-68"><a href="#cb9-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb9-69"><a href="#cb9-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb9-70"><a href="#cb9-70" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb9-71"><a href="#cb9-71" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb9-72"><a href="#cb9-72" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb9-73"><a href="#cb9-73" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb9-74"><a href="#cb9-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb9-75"><a href="#cb9-75" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb9-76"><a href="#cb9-76" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb9-77"><a href="#cb9-77" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb9-78"><a href="#cb9-78" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb9-79"><a href="#cb9-79" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb9-80"><a href="#cb9-80" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-81"><a href="#cb9-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-82"><a href="#cb9-82" aria-hidden="true" tabindex="-1"></a>calc_power_sex_none_lowh <span class="ot">&lt;-</span> all_effs_sex_none_lowh <span class="sc">%&gt;%</span></span>
<span id="cb9-83"><a href="#cb9-83" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-84"><a href="#cb9-84" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb9-85"><a href="#cb9-85" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb9-86"><a href="#cb9-86" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"none"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb9-87"><a href="#cb9-87" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"low"</span>))</span>
<span id="cb9-88"><a href="#cb9-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-89"><a href="#cb9-89" aria-hidden="true" tabindex="-1"></a>calc_power_sex_none_lowh <span class="sc">%&gt;%</span></span>
<span id="cb9-90"><a href="#cb9-90" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb9-91"><a href="#cb9-91" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb9-92"><a href="#cb9-92" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb9-93"><a href="#cb9-93" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb9-94"><a href="#cb9-94" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>all_effs_sex_small_lowh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb10-67"><a href="#cb10-67" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb10-68"><a href="#cb10-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb10-69"><a href="#cb10-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb10-70"><a href="#cb10-70" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb10-71"><a href="#cb10-71" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb10-72"><a href="#cb10-72" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb10-73"><a href="#cb10-73" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb10-74"><a href="#cb10-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb10-75"><a href="#cb10-75" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb10-76"><a href="#cb10-76" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb10-77"><a href="#cb10-77" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb10-78"><a href="#cb10-78" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb10-79"><a href="#cb10-79" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-80"><a href="#cb10-80" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-81"><a href="#cb10-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-82"><a href="#cb10-82" aria-hidden="true" tabindex="-1"></a>calc_power_sex_small_lowh <span class="ot">&lt;-</span> all_effs_sex_small_lowh <span class="sc">%&gt;%</span></span>
<span id="cb10-83"><a href="#cb10-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-84"><a href="#cb10-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb10-85"><a href="#cb10-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb10-86"><a href="#cb10-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"small"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb10-87"><a href="#cb10-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"low"</span>))</span>
<span id="cb10-88"><a href="#cb10-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-89"><a href="#cb10-89" aria-hidden="true" tabindex="-1"></a>calc_power_sex_small_lowh <span class="sc">%&gt;%</span></span>
<span id="cb10-90"><a href="#cb10-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb10-91"><a href="#cb10-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb10-92"><a href="#cb10-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb10-93"><a href="#cb10-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb10-94"><a href="#cb10-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>all_effs_sex_large_lowh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb11-75"><a href="#cb11-75" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb11-76"><a href="#cb11-76" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb11-77"><a href="#cb11-77" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb11-78"><a href="#cb11-78" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb11-79"><a href="#cb11-79" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb11-80"><a href="#cb11-80" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-81"><a href="#cb11-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-82"><a href="#cb11-82" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large_lowh <span class="ot">&lt;-</span> all_effs_sex_large_lowh <span class="sc">%&gt;%</span></span>
<span id="cb11-83"><a href="#cb11-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-84"><a href="#cb11-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb11-85"><a href="#cb11-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb11-86"><a href="#cb11-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb11-87"><a href="#cb11-87" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"low"</span>))</span>
<span id="cb11-88"><a href="#cb11-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-89"><a href="#cb11-89" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large_lowh <span class="sc">%&gt;%</span></span>
<span id="cb11-90"><a href="#cb11-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb11-91"><a href="#cb11-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb11-92"><a href="#cb11-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb11-93"><a href="#cb11-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb11-94"><a href="#cb11-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<p><strong>Large heteroscedasticity</strong></p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true" href="">No sex eff, no ix</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false" href="">Small sex eff, no ix</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false" href="">Large sex eff, no ix</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>all_effs_sex_none_largeh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb13-62"><a href="#cb13-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb13-63"><a href="#cb13-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb13-64"><a href="#cb13-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb13-65"><a href="#cb13-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb13-66"><a href="#cb13-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb13-67"><a href="#cb13-67" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb13-68"><a href="#cb13-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb13-69"><a href="#cb13-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb13-70"><a href="#cb13-70" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb13-71"><a href="#cb13-71" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb13-72"><a href="#cb13-72" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb13-73"><a href="#cb13-73" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb13-74"><a href="#cb13-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb13-75"><a href="#cb13-75" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb13-76"><a href="#cb13-76" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb13-77"><a href="#cb13-77" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb13-78"><a href="#cb13-78" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb13-79"><a href="#cb13-79" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb13-80"><a href="#cb13-80" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-81"><a href="#cb13-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-82"><a href="#cb13-82" aria-hidden="true" tabindex="-1"></a>calc_power_sex_none_largeh <span class="ot">&lt;-</span> all_effs_sex_none_largeh <span class="sc">%&gt;%</span></span>
<span id="cb13-83"><a href="#cb13-83" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-84"><a href="#cb13-84" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb13-85"><a href="#cb13-85" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb13-86"><a href="#cb13-86" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"none"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb13-87"><a href="#cb13-87" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"large"</span>))</span>
<span id="cb13-88"><a href="#cb13-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-89"><a href="#cb13-89" aria-hidden="true" tabindex="-1"></a>calc_power_sex_none_largeh <span class="sc">%&gt;%</span></span>
<span id="cb13-90"><a href="#cb13-90" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb13-91"><a href="#cb13-91" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb13-92"><a href="#cb13-92" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb13-93"><a href="#cb13-93" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb13-94"><a href="#cb13-94" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>all_effs_sex_small_largeh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb14-54"><a href="#cb14-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb14-55"><a href="#cb14-55" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb14-56"><a href="#cb14-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb14-57"><a href="#cb14-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb14-58"><a href="#cb14-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb14-59"><a href="#cb14-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb14-60"><a href="#cb14-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb14-61"><a href="#cb14-61" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb14-62"><a href="#cb14-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb14-63"><a href="#cb14-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb14-64"><a href="#cb14-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb14-65"><a href="#cb14-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb14-66"><a href="#cb14-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb14-67"><a href="#cb14-67" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb14-68"><a href="#cb14-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb14-69"><a href="#cb14-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb14-70"><a href="#cb14-70" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb14-71"><a href="#cb14-71" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb14-72"><a href="#cb14-72" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb14-73"><a href="#cb14-73" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb14-74"><a href="#cb14-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb14-75"><a href="#cb14-75" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb14-76"><a href="#cb14-76" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb14-77"><a href="#cb14-77" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb14-78"><a href="#cb14-78" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb14-79"><a href="#cb14-79" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb14-80"><a href="#cb14-80" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-81"><a href="#cb14-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-82"><a href="#cb14-82" aria-hidden="true" tabindex="-1"></a>calc_power_sex_small_largeh <span class="ot">&lt;-</span> all_effs_sex_small_largeh <span class="sc">%&gt;%</span></span>
<span id="cb14-83"><a href="#cb14-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-84"><a href="#cb14-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb14-85"><a href="#cb14-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb14-86"><a href="#cb14-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"small"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb14-87"><a href="#cb14-87" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"large"</span>))</span>
<span id="cb14-88"><a href="#cb14-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-89"><a href="#cb14-89" aria-hidden="true" tabindex="-1"></a>calc_power_sex_small_largeh <span class="sc">%&gt;%</span></span>
<span id="cb14-90"><a href="#cb14-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb14-91"><a href="#cb14-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb14-92"><a href="#cb14-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb14-93"><a href="#cb14-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb14-94"><a href="#cb14-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>all_effs_sex_large_largeh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb15-56"><a href="#cb15-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb15-57"><a href="#cb15-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb15-58"><a href="#cb15-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb15-59"><a href="#cb15-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb15-60"><a href="#cb15-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb15-61"><a href="#cb15-61" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb15-62"><a href="#cb15-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb15-63"><a href="#cb15-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb15-64"><a href="#cb15-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb15-65"><a href="#cb15-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb15-66"><a href="#cb15-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb15-67"><a href="#cb15-67" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb15-68"><a href="#cb15-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb15-69"><a href="#cb15-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb15-70"><a href="#cb15-70" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb15-71"><a href="#cb15-71" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb15-72"><a href="#cb15-72" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb15-73"><a href="#cb15-73" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb15-74"><a href="#cb15-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb15-75"><a href="#cb15-75" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb15-76"><a href="#cb15-76" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb15-77"><a href="#cb15-77" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb15-78"><a href="#cb15-78" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb15-79"><a href="#cb15-79" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb15-80"><a href="#cb15-80" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-81"><a href="#cb15-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-82"><a href="#cb15-82" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large_largeh <span class="ot">&lt;-</span> all_effs_sex_large_largeh <span class="sc">%&gt;%</span></span>
<span id="cb15-83"><a href="#cb15-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-84"><a href="#cb15-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb15-85"><a href="#cb15-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb15-86"><a href="#cb15-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb15-87"><a href="#cb15-87" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"large"</span>))</span>
<span id="cb15-88"><a href="#cb15-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-89"><a href="#cb15-89" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large_largeh <span class="sc">%&gt;%</span></span>
<span id="cb15-90"><a href="#cb15-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb15-91"><a href="#cb15-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb15-92"><a href="#cb15-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb15-93"><a href="#cb15-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb15-94"><a href="#cb15-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<p>It should be of note that evolutionary biology has seen heteroscedasticities exceeding 100% in variance ration between sexes. Combined results below show the impact of heteroscedasticity.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="ot">&lt;-</span> <span class="fu">rbind</span>(calc_power_sex_small,</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>                               calc_power_sex_large,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>                               calc_power_sex_small_lowh,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>                               calc_power_sex_large_lowh,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>                               calc_power_sex_small_largeh,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>                               calc_power_sex_large_largeh)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">lapply</span>(all_sex_effs_sex_only, unlist))</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="sc">%&gt;%</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Effect <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Treatment"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">factor</span>(sex_eff_size,</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"small"</span>, <span class="st">"large"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">recode</span>(method,</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"ANOVA"</span> <span class="ot">=</span> <span class="st">"Factorial"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">factor</span>(heterosc,</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"large"</span>, <span class="st">"low"</span>, <span class="st">"none"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> sex_eff_size,</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> <span class="fu">interaction</span>(sex_eff_size, heterosc))) <span class="sc">+</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> heterosc)) <span class="sc">+</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Statistical power"</span>) <span class="sc">+</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Main treatment effect"</span>) <span class="sc">+</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">name =</span> <span class="st">"Sex effect size"</span>, <span class="at">values =</span> cbb_palette) <span class="sc">+</span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_discrete</span>(<span class="at">name =</span> <span class="st">"Heteroscedasticity"</span>)  <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>plotA <span class="ot">&lt;-</span> all_sex_effs_sex_only <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sex_eff_size <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sex_eff_size = factor(sex_eff_size,</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("none", "small", "large"))) %&gt;%</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">factor</span>(heterosc,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"large"</span>, <span class="st">"low"</span>, <span class="st">"none"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> heterosc)) <span class="sc">+</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Statistical power"</span>) <span class="sc">+</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Main treatment effect"</span>) <span class="sc">+</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">name =</span> <span class="st">"Effect"</span>, <span class="at">values =</span> cbb_palette) <span class="sc">+</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_discrete</span>(<span class="at">name =</span> <span class="st">"Heteroscedasticity"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>plotA</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-15-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="scenarios-from-fig.-4---interaction-of-magnitude" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Scenarios from Fig. 4 - interaction of magnitude</h1>
<section id="from-original-paper-1" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="from-original-paper-1"><span class="header-section-number">2.1</span> From original paper</h2>
<p>Below simulations were only slightly modified. We assumed a moderate (+0.5) overall effect of sex and a varying interaction increasing the magnitude of sex difference in the treated group (+0, +0.5, +1).</p>
<p><strong>Assuming homoscedasticity of sex variances</strong></p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true" href="">No sex eff, no ix</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false" href="">Small sex eff, no ix</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false" href="">Large sex eff, no ix</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span><span class="dv">0</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>all_effs_sex_ix_none <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb18-56"><a href="#cb18-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb18-57"><a href="#cb18-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb18-58"><a href="#cb18-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb18-59"><a href="#cb18-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb18-60"><a href="#cb18-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb18-61"><a href="#cb18-61" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb18-62"><a href="#cb18-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb18-63"><a href="#cb18-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb18-64"><a href="#cb18-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb18-65"><a href="#cb18-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb18-66"><a href="#cb18-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb18-67"><a href="#cb18-67" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb18-68"><a href="#cb18-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb18-69"><a href="#cb18-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb18-70"><a href="#cb18-70" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb18-71"><a href="#cb18-71" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb18-72"><a href="#cb18-72" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb18-73"><a href="#cb18-73" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb18-74"><a href="#cb18-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb18-75"><a href="#cb18-75" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb18-76"><a href="#cb18-76" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb18-77"><a href="#cb18-77" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb18-78"><a href="#cb18-78" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb18-79"><a href="#cb18-79" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb18-80"><a href="#cb18-80" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-81"><a href="#cb18-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-82"><a href="#cb18-82" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_none <span class="ot">&lt;-</span> all_effs_sex_ix_none <span class="sc">%&gt;%</span></span>
<span id="cb18-83"><a href="#cb18-83" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-84"><a href="#cb18-84" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, ix_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb18-85"><a href="#cb18-85" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb18-86"><a href="#cb18-86" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"small"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb18-87"><a href="#cb18-87" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"none"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb18-88"><a href="#cb18-88" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"none"</span>))</span>
<span id="cb18-89"><a href="#cb18-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-90"><a href="#cb18-90" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_none <span class="sc">%&gt;%</span></span>
<span id="cb18-91"><a href="#cb18-91" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb18-92"><a href="#cb18-92" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb18-93"><a href="#cb18-93" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb18-94"><a href="#cb18-94" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb18-95"><a href="#cb18-95" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>all_effs_sex_ix_small <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb19-52"><a href="#cb19-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb19-53"><a href="#cb19-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb19-54"><a href="#cb19-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb19-55"><a href="#cb19-55" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb19-56"><a href="#cb19-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb19-57"><a href="#cb19-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb19-58"><a href="#cb19-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb19-59"><a href="#cb19-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb19-60"><a href="#cb19-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb19-61"><a href="#cb19-61" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb19-62"><a href="#cb19-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb19-63"><a href="#cb19-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb19-64"><a href="#cb19-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb19-65"><a href="#cb19-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb19-66"><a href="#cb19-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb19-67"><a href="#cb19-67" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb19-68"><a href="#cb19-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb19-69"><a href="#cb19-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb19-70"><a href="#cb19-70" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb19-71"><a href="#cb19-71" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb19-72"><a href="#cb19-72" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb19-73"><a href="#cb19-73" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb19-74"><a href="#cb19-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb19-75"><a href="#cb19-75" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb19-76"><a href="#cb19-76" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb19-77"><a href="#cb19-77" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb19-78"><a href="#cb19-78" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb19-79"><a href="#cb19-79" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb19-80"><a href="#cb19-80" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-81"><a href="#cb19-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-82"><a href="#cb19-82" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_small <span class="ot">&lt;-</span> all_effs_sex_ix_small <span class="sc">%&gt;%</span></span>
<span id="cb19-83"><a href="#cb19-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-84"><a href="#cb19-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, ix_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb19-85"><a href="#cb19-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb19-86"><a href="#cb19-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"small"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-87"><a href="#cb19-87" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"none"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-88"><a href="#cb19-88" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"small"</span>))</span>
<span id="cb19-89"><a href="#cb19-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-90"><a href="#cb19-90" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_small <span class="sc">%&gt;%</span></span>
<span id="cb19-91"><a href="#cb19-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb19-92"><a href="#cb19-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb19-93"><a href="#cb19-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb19-94"><a href="#cb19-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb19-95"><a href="#cb19-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>all_effs_sex_ix_large <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb20-48"><a href="#cb20-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb20-49"><a href="#cb20-49" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb20-50"><a href="#cb20-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb20-51"><a href="#cb20-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb20-52"><a href="#cb20-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb20-53"><a href="#cb20-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb20-54"><a href="#cb20-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb20-55"><a href="#cb20-55" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb20-56"><a href="#cb20-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb20-57"><a href="#cb20-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb20-58"><a href="#cb20-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb20-59"><a href="#cb20-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb20-60"><a href="#cb20-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb20-61"><a href="#cb20-61" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb20-62"><a href="#cb20-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb20-63"><a href="#cb20-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb20-64"><a href="#cb20-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb20-65"><a href="#cb20-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb20-66"><a href="#cb20-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb20-67"><a href="#cb20-67" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb20-68"><a href="#cb20-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb20-69"><a href="#cb20-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb20-70"><a href="#cb20-70" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb20-71"><a href="#cb20-71" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb20-72"><a href="#cb20-72" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb20-73"><a href="#cb20-73" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb20-74"><a href="#cb20-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb20-75"><a href="#cb20-75" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb20-76"><a href="#cb20-76" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb20-77"><a href="#cb20-77" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb20-78"><a href="#cb20-78" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb20-79"><a href="#cb20-79" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb20-80"><a href="#cb20-80" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-81"><a href="#cb20-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-82"><a href="#cb20-82" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_large <span class="ot">&lt;-</span> all_effs_sex_ix_large <span class="sc">%&gt;%</span></span>
<span id="cb20-83"><a href="#cb20-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-84"><a href="#cb20-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, ix_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb20-85"><a href="#cb20-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb20-86"><a href="#cb20-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb20-87"><a href="#cb20-87" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"none"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb20-88"><a href="#cb20-88" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>))</span>
<span id="cb20-89"><a href="#cb20-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-90"><a href="#cb20-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-91"><a href="#cb20-91" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_large <span class="sc">%&gt;%</span></span>
<span id="cb20-92"><a href="#cb20-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb20-93"><a href="#cb20-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb20-94"><a href="#cb20-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb20-95"><a href="#cb20-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb20-96"><a href="#cb20-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<p>Plots combining all scenarios from Fig. 1</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="ot">&lt;-</span> <span class="fu">rbind</span>(calc_power_sex_ix_none, calc_power_sex_ix_small,</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>                               calc_power_sex_ix_large)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">lapply</span>(all_sex_effs_sex_only, unlist))</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="sc">%&gt;%</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Effect <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Treatment"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">factor</span>(ix_eff_size,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"none"</span>, <span class="st">"small"</span>, <span class="st">"large"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">recode</span>(method,</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"ANOVA"</span> <span class="ot">=</span> <span class="st">"Factorial"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> ix_eff_size,</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> <span class="fu">interaction</span>(ix_eff_size, method))) <span class="sc">+</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> method)) <span class="sc">+</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Statistical power"</span>) <span class="sc">+</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Main treatment effect"</span>) <span class="sc">+</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">name =</span> <span class="st">"Ix effect size"</span>, <span class="at">values =</span> cbb_palette) <span class="sc">+</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_discrete</span>(<span class="at">name =</span> <span class="st">"Stat method"</span>)  <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(!Effect %in% c("T-Test Treatment Eff")) %&gt;%</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">factor</span>(ix_eff_size,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"none"</span>, <span class="st">"small"</span>, <span class="st">"large"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> <span class="fu">interaction</span>(ix_eff_size, Effect))) <span class="sc">+</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> ix_eff_size)) <span class="sc">+</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Statistical power"</span>) <span class="sc">+</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Main treatment effect"</span>) <span class="sc">+</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">name =</span> <span class="st">"Effect"</span>, <span class="at">values =</span> cbb_palette) <span class="sc">+</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_discrete</span>(<span class="at">name =</span> <span class="st">"Ix effect size"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-19-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="heteroscedastic-sex-variances" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="heteroscedastic-sex-variances"><span class="header-section-number">2.2</span> Heteroscedastic sex variances</h2>
<p>We assume several scenarios with <span class="math inline">\(\alpha\)</span> equal to 0 (the above scenarios), 1 and 2, which relates to 100% or 200% increase in male variance, in relation to female variance (or ~44% and ~73% increase in male SD). The direction of sex bias is arbitrary.</p>
<p><strong>Low heteroscedasticity</strong></p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true" href="">Small sex eff, no ix</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false" href="">Small sex eff, small ix</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false" href="">Small sex eff, large ix</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>all_effs_sex_ix_none_lowh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb24-56"><a href="#cb24-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb24-57"><a href="#cb24-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb24-58"><a href="#cb24-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb24-59"><a href="#cb24-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb24-60"><a href="#cb24-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb24-61"><a href="#cb24-61" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb24-62"><a href="#cb24-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb24-63"><a href="#cb24-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb24-64"><a href="#cb24-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb24-65"><a href="#cb24-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb24-66"><a href="#cb24-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb24-67"><a href="#cb24-67" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb24-68"><a href="#cb24-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb24-69"><a href="#cb24-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb24-70"><a href="#cb24-70" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb24-71"><a href="#cb24-71" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb24-72"><a href="#cb24-72" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb24-73"><a href="#cb24-73" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb24-74"><a href="#cb24-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb24-75"><a href="#cb24-75" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb24-76"><a href="#cb24-76" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb24-77"><a href="#cb24-77" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb24-78"><a href="#cb24-78" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb24-79"><a href="#cb24-79" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb24-80"><a href="#cb24-80" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-81"><a href="#cb24-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-82"><a href="#cb24-82" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_none_lowh <span class="ot">&lt;-</span> all_effs_sex_ix_none_lowh <span class="sc">%&gt;%</span></span>
<span id="cb24-83"><a href="#cb24-83" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-84"><a href="#cb24-84" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, ix_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb24-85"><a href="#cb24-85" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb24-86"><a href="#cb24-86" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"small"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb24-87"><a href="#cb24-87" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"low"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb24-88"><a href="#cb24-88" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"none"</span>))</span>
<span id="cb24-89"><a href="#cb24-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-90"><a href="#cb24-90" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_none_lowh <span class="sc">%&gt;%</span></span>
<span id="cb24-91"><a href="#cb24-91" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb24-92"><a href="#cb24-92" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb24-93"><a href="#cb24-93" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb24-94"><a href="#cb24-94" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb24-95"><a href="#cb24-95" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>all_effs_sex_ix_small_lowh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb25-54"><a href="#cb25-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb25-55"><a href="#cb25-55" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb25-56"><a href="#cb25-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb25-57"><a href="#cb25-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb25-58"><a href="#cb25-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb25-59"><a href="#cb25-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb25-60"><a href="#cb25-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb25-61"><a href="#cb25-61" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb25-62"><a href="#cb25-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb25-63"><a href="#cb25-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb25-64"><a href="#cb25-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb25-65"><a href="#cb25-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb25-66"><a href="#cb25-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb25-67"><a href="#cb25-67" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb25-68"><a href="#cb25-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb25-69"><a href="#cb25-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb25-70"><a href="#cb25-70" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb25-71"><a href="#cb25-71" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb25-72"><a href="#cb25-72" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb25-73"><a href="#cb25-73" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb25-74"><a href="#cb25-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb25-75"><a href="#cb25-75" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb25-76"><a href="#cb25-76" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb25-77"><a href="#cb25-77" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb25-78"><a href="#cb25-78" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb25-79"><a href="#cb25-79" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-80"><a href="#cb25-80" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-81"><a href="#cb25-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-82"><a href="#cb25-82" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_small_lowh <span class="ot">&lt;-</span> all_effs_sex_ix_small_lowh <span class="sc">%&gt;%</span></span>
<span id="cb25-83"><a href="#cb25-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-84"><a href="#cb25-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, ix_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb25-85"><a href="#cb25-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb25-86"><a href="#cb25-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"small"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb25-87"><a href="#cb25-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"low"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb25-88"><a href="#cb25-88" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"small"</span>))</span>
<span id="cb25-89"><a href="#cb25-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-90"><a href="#cb25-90" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_small_lowh <span class="sc">%&gt;%</span></span>
<span id="cb25-91"><a href="#cb25-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb25-92"><a href="#cb25-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb25-93"><a href="#cb25-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb25-94"><a href="#cb25-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb25-95"><a href="#cb25-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>all_effs_sex_ix_large_lowh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb26-48"><a href="#cb26-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb26-49"><a href="#cb26-49" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb26-50"><a href="#cb26-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb26-51"><a href="#cb26-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb26-52"><a href="#cb26-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb26-53"><a href="#cb26-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb26-54"><a href="#cb26-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb26-55"><a href="#cb26-55" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb26-56"><a href="#cb26-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb26-57"><a href="#cb26-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb26-58"><a href="#cb26-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb26-59"><a href="#cb26-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb26-60"><a href="#cb26-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb26-61"><a href="#cb26-61" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb26-62"><a href="#cb26-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb26-63"><a href="#cb26-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb26-64"><a href="#cb26-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb26-65"><a href="#cb26-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb26-66"><a href="#cb26-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb26-67"><a href="#cb26-67" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb26-68"><a href="#cb26-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb26-69"><a href="#cb26-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb26-70"><a href="#cb26-70" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb26-71"><a href="#cb26-71" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb26-72"><a href="#cb26-72" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb26-73"><a href="#cb26-73" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb26-74"><a href="#cb26-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb26-75"><a href="#cb26-75" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb26-76"><a href="#cb26-76" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb26-77"><a href="#cb26-77" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb26-78"><a href="#cb26-78" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb26-79"><a href="#cb26-79" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb26-80"><a href="#cb26-80" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-81"><a href="#cb26-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-82"><a href="#cb26-82" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_large_lowh <span class="ot">&lt;-</span> all_effs_sex_ix_large_lowh <span class="sc">%&gt;%</span></span>
<span id="cb26-83"><a href="#cb26-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-84"><a href="#cb26-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, ix_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb26-85"><a href="#cb26-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb26-86"><a href="#cb26-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"small"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb26-87"><a href="#cb26-87" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"low"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb26-88"><a href="#cb26-88" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>))</span>
<span id="cb26-89"><a href="#cb26-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-90"><a href="#cb26-90" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_large_lowh <span class="sc">%&gt;%</span></span>
<span id="cb26-91"><a href="#cb26-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb26-92"><a href="#cb26-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb26-93"><a href="#cb26-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb26-94"><a href="#cb26-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb26-95"><a href="#cb26-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<p><strong>Large heteroscedasticity</strong></p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true" href="">Small sex eff, no ix</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false" href="">Small sex eff, small ix</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false" href="">Small sex eff, large ix</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>all_effs_sex_ix_none_largeh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb28-46"><a href="#cb28-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb28-47"><a href="#cb28-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb28-48"><a href="#cb28-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb28-49"><a href="#cb28-49" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb28-50"><a href="#cb28-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb28-51"><a href="#cb28-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb28-52"><a href="#cb28-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb28-53"><a href="#cb28-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb28-54"><a href="#cb28-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb28-55"><a href="#cb28-55" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb28-56"><a href="#cb28-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb28-57"><a href="#cb28-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb28-58"><a href="#cb28-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb28-59"><a href="#cb28-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb28-60"><a href="#cb28-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb28-61"><a href="#cb28-61" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb28-62"><a href="#cb28-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb28-63"><a href="#cb28-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb28-64"><a href="#cb28-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb28-65"><a href="#cb28-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb28-66"><a href="#cb28-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb28-67"><a href="#cb28-67" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb28-68"><a href="#cb28-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb28-69"><a href="#cb28-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb28-70"><a href="#cb28-70" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb28-71"><a href="#cb28-71" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb28-72"><a href="#cb28-72" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb28-73"><a href="#cb28-73" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb28-74"><a href="#cb28-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb28-75"><a href="#cb28-75" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb28-76"><a href="#cb28-76" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb28-77"><a href="#cb28-77" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb28-78"><a href="#cb28-78" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb28-79"><a href="#cb28-79" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb28-80"><a href="#cb28-80" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-81"><a href="#cb28-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-82"><a href="#cb28-82" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_none_largeh <span class="ot">&lt;-</span> all_effs_sex_ix_none_largeh <span class="sc">%&gt;%</span></span>
<span id="cb28-83"><a href="#cb28-83" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-84"><a href="#cb28-84" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, ix_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb28-85"><a href="#cb28-85" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb28-86"><a href="#cb28-86" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"small"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb28-87"><a href="#cb28-87" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb28-88"><a href="#cb28-88" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"none"</span>))</span>
<span id="cb28-89"><a href="#cb28-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-90"><a href="#cb28-90" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_none_largeh <span class="sc">%&gt;%</span></span>
<span id="cb28-91"><a href="#cb28-91" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb28-92"><a href="#cb28-92" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb28-93"><a href="#cb28-93" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb28-94"><a href="#cb28-94" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb28-95"><a href="#cb28-95" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>all_effs_sex_ix_small_largeh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb29-47"><a href="#cb29-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb29-48"><a href="#cb29-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb29-49"><a href="#cb29-49" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb29-50"><a href="#cb29-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb29-51"><a href="#cb29-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb29-52"><a href="#cb29-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb29-53"><a href="#cb29-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb29-54"><a href="#cb29-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb29-55"><a href="#cb29-55" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb29-56"><a href="#cb29-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb29-57"><a href="#cb29-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb29-58"><a href="#cb29-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb29-59"><a href="#cb29-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb29-60"><a href="#cb29-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb29-61"><a href="#cb29-61" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb29-62"><a href="#cb29-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb29-63"><a href="#cb29-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb29-64"><a href="#cb29-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb29-65"><a href="#cb29-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb29-66"><a href="#cb29-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb29-67"><a href="#cb29-67" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb29-68"><a href="#cb29-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb29-69"><a href="#cb29-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb29-70"><a href="#cb29-70" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb29-71"><a href="#cb29-71" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb29-72"><a href="#cb29-72" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb29-73"><a href="#cb29-73" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb29-74"><a href="#cb29-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb29-75"><a href="#cb29-75" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb29-76"><a href="#cb29-76" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb29-77"><a href="#cb29-77" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb29-78"><a href="#cb29-78" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb29-79"><a href="#cb29-79" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb29-80"><a href="#cb29-80" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-81"><a href="#cb29-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-82"><a href="#cb29-82" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_small_largeh <span class="ot">&lt;-</span> all_effs_sex_ix_small_largeh <span class="sc">%&gt;%</span></span>
<span id="cb29-83"><a href="#cb29-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-84"><a href="#cb29-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, ix_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb29-85"><a href="#cb29-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb29-86"><a href="#cb29-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"small"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb29-87"><a href="#cb29-87" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb29-88"><a href="#cb29-88" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"small"</span>))</span>
<span id="cb29-89"><a href="#cb29-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-90"><a href="#cb29-90" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_small_largeh <span class="sc">%&gt;%</span></span>
<span id="cb29-91"><a href="#cb29-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb29-92"><a href="#cb29-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb29-93"><a href="#cb29-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb29-94"><a href="#cb29-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb29-95"><a href="#cb29-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>all_effs_sex_ix_large_largeh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb30-42"><a href="#cb30-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb30-43"><a href="#cb30-43" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb30-44"><a href="#cb30-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb30-45"><a href="#cb30-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb30-46"><a href="#cb30-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb30-47"><a href="#cb30-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb30-48"><a href="#cb30-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb30-49"><a href="#cb30-49" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb30-50"><a href="#cb30-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb30-51"><a href="#cb30-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb30-52"><a href="#cb30-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb30-53"><a href="#cb30-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb30-54"><a href="#cb30-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb30-55"><a href="#cb30-55" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb30-56"><a href="#cb30-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb30-57"><a href="#cb30-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb30-58"><a href="#cb30-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb30-59"><a href="#cb30-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb30-60"><a href="#cb30-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb30-61"><a href="#cb30-61" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb30-62"><a href="#cb30-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb30-63"><a href="#cb30-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb30-64"><a href="#cb30-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb30-65"><a href="#cb30-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb30-66"><a href="#cb30-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb30-67"><a href="#cb30-67" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb30-68"><a href="#cb30-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb30-69"><a href="#cb30-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb30-70"><a href="#cb30-70" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb30-71"><a href="#cb30-71" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb30-72"><a href="#cb30-72" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb30-73"><a href="#cb30-73" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb30-74"><a href="#cb30-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb30-75"><a href="#cb30-75" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb30-76"><a href="#cb30-76" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb30-77"><a href="#cb30-77" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb30-78"><a href="#cb30-78" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb30-79"><a href="#cb30-79" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb30-80"><a href="#cb30-80" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-81"><a href="#cb30-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-82"><a href="#cb30-82" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_large_largeh <span class="ot">&lt;-</span> all_effs_sex_ix_large_largeh <span class="sc">%&gt;%</span></span>
<span id="cb30-83"><a href="#cb30-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-84"><a href="#cb30-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, ix_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb30-85"><a href="#cb30-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb30-86"><a href="#cb30-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb30-87"><a href="#cb30-87" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb30-88"><a href="#cb30-88" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>))</span>
<span id="cb30-89"><a href="#cb30-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-90"><a href="#cb30-90" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_large_largeh <span class="sc">%&gt;%</span></span>
<span id="cb30-91"><a href="#cb30-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb30-92"><a href="#cb30-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb30-93"><a href="#cb30-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb30-94"><a href="#cb30-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb30-95"><a href="#cb30-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<p>Power consequences of heteroscedasticities with varying (magnitude-only) interaction.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="ot">&lt;-</span> <span class="fu">rbind</span>(calc_power_sex_ix_small,</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>                               calc_power_sex_ix_large,</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>                               calc_power_sex_ix_small_lowh,</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>                               calc_power_sex_ix_large_lowh,</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>                               calc_power_sex_ix_small_largeh,</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>                               calc_power_sex_ix_large_largeh)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">lapply</span>(all_sex_effs_sex_only, unlist))</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="sc">%&gt;%</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Effect <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Treatment"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">factor</span>(ix_eff_size,</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"small"</span>, <span class="st">"large"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">recode</span>(method,</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"ANOVA"</span> <span class="ot">=</span> <span class="st">"Factorial"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">factor</span>(heterosc,</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"large"</span>, <span class="st">"low"</span>, <span class="st">"none"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> ix_eff_size,</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> <span class="fu">interaction</span>(ix_eff_size, heterosc))) <span class="sc">+</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> heterosc)) <span class="sc">+</span></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Statistical power"</span>) <span class="sc">+</span></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Main treatment effect"</span>) <span class="sc">+</span></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">name =</span> <span class="st">"Ix effect size"</span>, <span class="at">values =</span> cbb_palette) <span class="sc">+</span></span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_discrete</span>(<span class="at">name =</span> <span class="st">"Heteroscedasticity"</span>)  <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>plotB <span class="ot">&lt;-</span> all_sex_effs_sex_only <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ix_eff_size <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sex_eff_size = factor(sex_eff_size,</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("none", "small", "large"))) %&gt;%</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">factor</span>(heterosc,</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"large"</span>, <span class="st">"low"</span>, <span class="st">"none"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> heterosc)) <span class="sc">+</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Statistical power"</span>) <span class="sc">+</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Main treatment effect"</span>) <span class="sc">+</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">name =</span> <span class="st">"Effect"</span>, <span class="at">values =</span> cbb_palette) <span class="sc">+</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_discrete</span>(<span class="at">name =</span> <span class="st">"Heteroscedasticity"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>plotB</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-28-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="scenarios-from-fig.-5---interaction-of-direction" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Scenarios from Fig. 5 - interaction of direction</h1>
<section id="from-original-paper-2" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="from-original-paper-2"><span class="header-section-number">3.1</span> From original paper</h2>
<p>Below simulations were only slightly modified. We assumed a strong (-1) overall effect of sex and a varying interaction resulting of crossing of sex effects on the treatment effect (0, -1, -2).</p>
<p><strong>Assuming homoscedasticity of sex variances</strong></p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true" href="">No sex eff, no ix</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false" href="">Small sex eff, no ix</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false" href="">Large sex eff, no ix</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span><span class="dv">0</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>all_effs_sex_ix_none <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb33-43"><a href="#cb33-43" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb33-44"><a href="#cb33-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb33-45"><a href="#cb33-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb33-46"><a href="#cb33-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb33-47"><a href="#cb33-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb33-48"><a href="#cb33-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb33-49"><a href="#cb33-49" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb33-50"><a href="#cb33-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb33-51"><a href="#cb33-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb33-52"><a href="#cb33-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb33-53"><a href="#cb33-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb33-54"><a href="#cb33-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb33-55"><a href="#cb33-55" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb33-56"><a href="#cb33-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb33-57"><a href="#cb33-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb33-58"><a href="#cb33-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb33-59"><a href="#cb33-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb33-60"><a href="#cb33-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb33-61"><a href="#cb33-61" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb33-62"><a href="#cb33-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb33-63"><a href="#cb33-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb33-64"><a href="#cb33-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb33-65"><a href="#cb33-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb33-66"><a href="#cb33-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb33-67"><a href="#cb33-67" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb33-68"><a href="#cb33-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb33-69"><a href="#cb33-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb33-70"><a href="#cb33-70" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb33-71"><a href="#cb33-71" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb33-72"><a href="#cb33-72" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb33-73"><a href="#cb33-73" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb33-74"><a href="#cb33-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb33-75"><a href="#cb33-75" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb33-76"><a href="#cb33-76" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb33-77"><a href="#cb33-77" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb33-78"><a href="#cb33-78" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb33-79"><a href="#cb33-79" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb33-80"><a href="#cb33-80" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-81"><a href="#cb33-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-82"><a href="#cb33-82" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_none <span class="ot">&lt;-</span> all_effs_sex_ix_none <span class="sc">%&gt;%</span></span>
<span id="cb33-83"><a href="#cb33-83" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-84"><a href="#cb33-84" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, ix_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb33-85"><a href="#cb33-85" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb33-86"><a href="#cb33-86" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"small"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb33-87"><a href="#cb33-87" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"none"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb33-88"><a href="#cb33-88" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"none"</span>))</span>
<span id="cb33-89"><a href="#cb33-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-90"><a href="#cb33-90" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_none <span class="sc">%&gt;%</span></span>
<span id="cb33-91"><a href="#cb33-91" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb33-92"><a href="#cb33-92" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb33-93"><a href="#cb33-93" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb33-94"><a href="#cb33-94" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb33-95"><a href="#cb33-95" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>all_effs_sex_ix_small <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb34-43"><a href="#cb34-43" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb34-44"><a href="#cb34-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb34-45"><a href="#cb34-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb34-46"><a href="#cb34-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb34-47"><a href="#cb34-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb34-48"><a href="#cb34-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb34-49"><a href="#cb34-49" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb34-50"><a href="#cb34-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb34-51"><a href="#cb34-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb34-52"><a href="#cb34-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb34-53"><a href="#cb34-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb34-54"><a href="#cb34-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb34-55"><a href="#cb34-55" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb34-56"><a href="#cb34-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb34-57"><a href="#cb34-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb34-58"><a href="#cb34-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb34-59"><a href="#cb34-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb34-60"><a href="#cb34-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb34-61"><a href="#cb34-61" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb34-62"><a href="#cb34-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb34-63"><a href="#cb34-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb34-64"><a href="#cb34-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb34-65"><a href="#cb34-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb34-66"><a href="#cb34-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb34-67"><a href="#cb34-67" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb34-68"><a href="#cb34-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb34-69"><a href="#cb34-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb34-70"><a href="#cb34-70" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb34-71"><a href="#cb34-71" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb34-72"><a href="#cb34-72" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb34-73"><a href="#cb34-73" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb34-74"><a href="#cb34-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb34-75"><a href="#cb34-75" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb34-76"><a href="#cb34-76" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb34-77"><a href="#cb34-77" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb34-78"><a href="#cb34-78" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb34-79"><a href="#cb34-79" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb34-80"><a href="#cb34-80" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-81"><a href="#cb34-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-82"><a href="#cb34-82" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_small <span class="ot">&lt;-</span> all_effs_sex_ix_small <span class="sc">%&gt;%</span></span>
<span id="cb34-83"><a href="#cb34-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-84"><a href="#cb34-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, ix_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb34-85"><a href="#cb34-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb34-86"><a href="#cb34-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"small"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb34-87"><a href="#cb34-87" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"none"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb34-88"><a href="#cb34-88" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"small"</span>))</span>
<span id="cb34-89"><a href="#cb34-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-90"><a href="#cb34-90" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_small <span class="sc">%&gt;%</span></span>
<span id="cb34-91"><a href="#cb34-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb34-92"><a href="#cb34-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb34-93"><a href="#cb34-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb34-94"><a href="#cb34-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb34-95"><a href="#cb34-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>all_effs_sex_ix_large <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb35-45"><a href="#cb35-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb35-46"><a href="#cb35-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb35-47"><a href="#cb35-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb35-48"><a href="#cb35-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb35-49"><a href="#cb35-49" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb35-50"><a href="#cb35-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb35-51"><a href="#cb35-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb35-52"><a href="#cb35-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb35-53"><a href="#cb35-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb35-54"><a href="#cb35-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb35-55"><a href="#cb35-55" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb35-56"><a href="#cb35-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb35-57"><a href="#cb35-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb35-58"><a href="#cb35-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb35-59"><a href="#cb35-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb35-60"><a href="#cb35-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb35-61"><a href="#cb35-61" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb35-62"><a href="#cb35-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb35-63"><a href="#cb35-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb35-64"><a href="#cb35-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb35-65"><a href="#cb35-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb35-66"><a href="#cb35-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb35-67"><a href="#cb35-67" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb35-68"><a href="#cb35-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb35-69"><a href="#cb35-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb35-70"><a href="#cb35-70" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb35-71"><a href="#cb35-71" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb35-72"><a href="#cb35-72" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb35-73"><a href="#cb35-73" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb35-74"><a href="#cb35-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb35-75"><a href="#cb35-75" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb35-76"><a href="#cb35-76" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb35-77"><a href="#cb35-77" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb35-78"><a href="#cb35-78" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb35-79"><a href="#cb35-79" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb35-80"><a href="#cb35-80" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-81"><a href="#cb35-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-82"><a href="#cb35-82" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_large <span class="ot">&lt;-</span> all_effs_sex_ix_large <span class="sc">%&gt;%</span></span>
<span id="cb35-83"><a href="#cb35-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-84"><a href="#cb35-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, ix_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb35-85"><a href="#cb35-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb35-86"><a href="#cb35-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb35-87"><a href="#cb35-87" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"none"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb35-88"><a href="#cb35-88" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>))</span>
<span id="cb35-89"><a href="#cb35-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-90"><a href="#cb35-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-91"><a href="#cb35-91" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_large <span class="sc">%&gt;%</span></span>
<span id="cb35-92"><a href="#cb35-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb35-93"><a href="#cb35-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb35-94"><a href="#cb35-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb35-95"><a href="#cb35-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb35-96"><a href="#cb35-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<p>Plots combining all scenarios from Fig. 1</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="ot">&lt;-</span> <span class="fu">rbind</span>(calc_power_sex_ix_none, calc_power_sex_ix_small,</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>                               calc_power_sex_ix_large)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">lapply</span>(all_sex_effs_sex_only, unlist))</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="sc">%&gt;%</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Effect <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Treatment"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">factor</span>(ix_eff_size,</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"none"</span>, <span class="st">"small"</span>, <span class="st">"large"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">recode</span>(method,</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"ANOVA"</span> <span class="ot">=</span> <span class="st">"Factorial"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> ix_eff_size,</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> <span class="fu">interaction</span>(ix_eff_size, method))) <span class="sc">+</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> method)) <span class="sc">+</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Statistical power"</span>) <span class="sc">+</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Main treatment effect"</span>) <span class="sc">+</span></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">name =</span> <span class="st">"Ix effect size"</span>, <span class="at">values =</span> cbb_palette) <span class="sc">+</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_discrete</span>(<span class="at">name =</span> <span class="st">"Stat method"</span>)  <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="sc">%&gt;%</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(!Effect %in% c("T-Test Treatment Eff")) %&gt;%</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">factor</span>(ix_eff_size,</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"none"</span>, <span class="st">"small"</span>, <span class="st">"large"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect,</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> <span class="fu">interaction</span>(ix_eff_size, Effect))) <span class="sc">+</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> ix_eff_size)) <span class="sc">+</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Statistical power"</span>) <span class="sc">+</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Main treatment effect"</span>) <span class="sc">+</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">name =</span> <span class="st">"Effect"</span>, <span class="at">values =</span> cbb_palette) <span class="sc">+</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_discrete</span>(<span class="at">name =</span> <span class="st">"Ix effect size"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-32-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="heteroscedastic-sex-variances-1" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="heteroscedastic-sex-variances-1"><span class="header-section-number">3.2</span> Heteroscedastic sex variances</h2>
<p>We assume several scenarios with <span class="math inline">\(\alpha\)</span> equal to 0 (the above scenarios), 1 and 2, which relates to 100% or 200% increase in male variance, in relation to female variance (or ~44% and ~73% increase in male SD). The direction of sex bias is arbitrary.</p>
<p><strong>Low heteroscedasticity</strong></p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true" href="">Small sex eff, no ix</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false" href="">Small sex eff, small ix</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-3" role="tab" aria-controls="tabset-8-3" aria-selected="false" href="">Small sex eff, large ix</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>all_effs_sex_ix_none_lowh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb39-42"><a href="#cb39-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb39-43"><a href="#cb39-43" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb39-44"><a href="#cb39-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb39-45"><a href="#cb39-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb39-46"><a href="#cb39-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb39-47"><a href="#cb39-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb39-48"><a href="#cb39-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb39-49"><a href="#cb39-49" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb39-50"><a href="#cb39-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb39-51"><a href="#cb39-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb39-52"><a href="#cb39-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb39-53"><a href="#cb39-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb39-54"><a href="#cb39-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb39-55"><a href="#cb39-55" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb39-56"><a href="#cb39-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb39-57"><a href="#cb39-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb39-58"><a href="#cb39-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb39-59"><a href="#cb39-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb39-60"><a href="#cb39-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb39-61"><a href="#cb39-61" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb39-62"><a href="#cb39-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb39-63"><a href="#cb39-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb39-64"><a href="#cb39-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb39-65"><a href="#cb39-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb39-66"><a href="#cb39-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb39-67"><a href="#cb39-67" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb39-68"><a href="#cb39-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb39-69"><a href="#cb39-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb39-70"><a href="#cb39-70" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb39-71"><a href="#cb39-71" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb39-72"><a href="#cb39-72" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb39-73"><a href="#cb39-73" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb39-74"><a href="#cb39-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb39-75"><a href="#cb39-75" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb39-76"><a href="#cb39-76" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb39-77"><a href="#cb39-77" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb39-78"><a href="#cb39-78" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb39-79"><a href="#cb39-79" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb39-80"><a href="#cb39-80" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-81"><a href="#cb39-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-82"><a href="#cb39-82" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_none_lowh <span class="ot">&lt;-</span> all_effs_sex_ix_none_lowh <span class="sc">%&gt;%</span></span>
<span id="cb39-83"><a href="#cb39-83" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-84"><a href="#cb39-84" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, ix_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb39-85"><a href="#cb39-85" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb39-86"><a href="#cb39-86" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"small"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb39-87"><a href="#cb39-87" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"low"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb39-88"><a href="#cb39-88" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"none"</span>))</span>
<span id="cb39-89"><a href="#cb39-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-90"><a href="#cb39-90" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_none_lowh <span class="sc">%&gt;%</span></span>
<span id="cb39-91"><a href="#cb39-91" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb39-92"><a href="#cb39-92" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb39-93"><a href="#cb39-93" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb39-94"><a href="#cb39-94" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb39-95"><a href="#cb39-95" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>all_effs_sex_ix_small_lowh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb40-36"><a href="#cb40-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb40-37"><a href="#cb40-37" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb40-38"><a href="#cb40-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb40-39"><a href="#cb40-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb40-40"><a href="#cb40-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb40-41"><a href="#cb40-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb40-42"><a href="#cb40-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb40-43"><a href="#cb40-43" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb40-44"><a href="#cb40-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb40-45"><a href="#cb40-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb40-46"><a href="#cb40-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb40-47"><a href="#cb40-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb40-48"><a href="#cb40-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb40-49"><a href="#cb40-49" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb40-50"><a href="#cb40-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb40-51"><a href="#cb40-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb40-52"><a href="#cb40-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb40-53"><a href="#cb40-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb40-54"><a href="#cb40-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb40-55"><a href="#cb40-55" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb40-56"><a href="#cb40-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb40-57"><a href="#cb40-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb40-58"><a href="#cb40-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb40-59"><a href="#cb40-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb40-60"><a href="#cb40-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb40-61"><a href="#cb40-61" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb40-62"><a href="#cb40-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb40-63"><a href="#cb40-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb40-64"><a href="#cb40-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb40-65"><a href="#cb40-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb40-66"><a href="#cb40-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb40-67"><a href="#cb40-67" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb40-68"><a href="#cb40-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb40-69"><a href="#cb40-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb40-70"><a href="#cb40-70" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb40-71"><a href="#cb40-71" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb40-72"><a href="#cb40-72" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb40-73"><a href="#cb40-73" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb40-74"><a href="#cb40-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb40-75"><a href="#cb40-75" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb40-76"><a href="#cb40-76" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb40-77"><a href="#cb40-77" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb40-78"><a href="#cb40-78" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb40-79"><a href="#cb40-79" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb40-80"><a href="#cb40-80" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-81"><a href="#cb40-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-82"><a href="#cb40-82" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_small_lowh <span class="ot">&lt;-</span> all_effs_sex_ix_small_lowh <span class="sc">%&gt;%</span></span>
<span id="cb40-83"><a href="#cb40-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-84"><a href="#cb40-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, ix_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb40-85"><a href="#cb40-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb40-86"><a href="#cb40-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"small"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb40-87"><a href="#cb40-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"low"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb40-88"><a href="#cb40-88" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"small"</span>))</span>
<span id="cb40-89"><a href="#cb40-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-90"><a href="#cb40-90" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_small_lowh <span class="sc">%&gt;%</span></span>
<span id="cb40-91"><a href="#cb40-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb40-92"><a href="#cb40-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb40-93"><a href="#cb40-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb40-94"><a href="#cb40-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb40-95"><a href="#cb40-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-8-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-3-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>all_effs_sex_ix_large_lowh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb41-37"><a href="#cb41-37" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb41-38"><a href="#cb41-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb41-39"><a href="#cb41-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb41-40"><a href="#cb41-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb41-41"><a href="#cb41-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb41-42"><a href="#cb41-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb41-43"><a href="#cb41-43" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb41-44"><a href="#cb41-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb41-45"><a href="#cb41-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb41-46"><a href="#cb41-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb41-47"><a href="#cb41-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb41-48"><a href="#cb41-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb41-49"><a href="#cb41-49" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb41-50"><a href="#cb41-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb41-51"><a href="#cb41-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb41-52"><a href="#cb41-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb41-53"><a href="#cb41-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb41-54"><a href="#cb41-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb41-55"><a href="#cb41-55" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb41-56"><a href="#cb41-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb41-57"><a href="#cb41-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb41-58"><a href="#cb41-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb41-59"><a href="#cb41-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb41-60"><a href="#cb41-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb41-61"><a href="#cb41-61" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb41-62"><a href="#cb41-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb41-63"><a href="#cb41-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb41-64"><a href="#cb41-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb41-65"><a href="#cb41-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb41-66"><a href="#cb41-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb41-67"><a href="#cb41-67" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb41-68"><a href="#cb41-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb41-69"><a href="#cb41-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb41-70"><a href="#cb41-70" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb41-71"><a href="#cb41-71" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb41-72"><a href="#cb41-72" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb41-73"><a href="#cb41-73" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb41-74"><a href="#cb41-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb41-75"><a href="#cb41-75" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb41-76"><a href="#cb41-76" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb41-77"><a href="#cb41-77" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb41-78"><a href="#cb41-78" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb41-79"><a href="#cb41-79" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb41-80"><a href="#cb41-80" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-81"><a href="#cb41-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-82"><a href="#cb41-82" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_large_lowh <span class="ot">&lt;-</span> all_effs_sex_ix_large_lowh <span class="sc">%&gt;%</span></span>
<span id="cb41-83"><a href="#cb41-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-84"><a href="#cb41-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, ix_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb41-85"><a href="#cb41-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb41-86"><a href="#cb41-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"small"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb41-87"><a href="#cb41-87" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"low"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb41-88"><a href="#cb41-88" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>))</span>
<span id="cb41-89"><a href="#cb41-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-90"><a href="#cb41-90" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_large_lowh <span class="sc">%&gt;%</span></span>
<span id="cb41-91"><a href="#cb41-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb41-92"><a href="#cb41-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb41-93"><a href="#cb41-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb41-94"><a href="#cb41-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb41-95"><a href="#cb41-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<p><strong>Large heteroscedasticity</strong></p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true" href="">Small sex eff, no ix</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false" href="">Small sex eff, small ix</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-3" role="tab" aria-controls="tabset-9-3" aria-selected="false" href="">Small sex eff, large ix</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>all_effs_sex_ix_none_largeh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb43-35"><a href="#cb43-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb43-36"><a href="#cb43-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb43-37"><a href="#cb43-37" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb43-38"><a href="#cb43-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb43-39"><a href="#cb43-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb43-40"><a href="#cb43-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb43-41"><a href="#cb43-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb43-42"><a href="#cb43-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb43-43"><a href="#cb43-43" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb43-44"><a href="#cb43-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb43-45"><a href="#cb43-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb43-46"><a href="#cb43-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb43-47"><a href="#cb43-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb43-48"><a href="#cb43-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb43-49"><a href="#cb43-49" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb43-50"><a href="#cb43-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb43-51"><a href="#cb43-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb43-52"><a href="#cb43-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb43-53"><a href="#cb43-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb43-54"><a href="#cb43-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb43-55"><a href="#cb43-55" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb43-56"><a href="#cb43-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb43-57"><a href="#cb43-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb43-58"><a href="#cb43-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb43-59"><a href="#cb43-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb43-60"><a href="#cb43-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb43-61"><a href="#cb43-61" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb43-62"><a href="#cb43-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb43-63"><a href="#cb43-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb43-64"><a href="#cb43-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb43-65"><a href="#cb43-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb43-66"><a href="#cb43-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb43-67"><a href="#cb43-67" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb43-68"><a href="#cb43-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb43-69"><a href="#cb43-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb43-70"><a href="#cb43-70" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb43-71"><a href="#cb43-71" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb43-72"><a href="#cb43-72" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb43-73"><a href="#cb43-73" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb43-74"><a href="#cb43-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb43-75"><a href="#cb43-75" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb43-76"><a href="#cb43-76" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb43-77"><a href="#cb43-77" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb43-78"><a href="#cb43-78" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb43-79"><a href="#cb43-79" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb43-80"><a href="#cb43-80" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-81"><a href="#cb43-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-82"><a href="#cb43-82" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_none_largeh <span class="ot">&lt;-</span> all_effs_sex_ix_none_largeh <span class="sc">%&gt;%</span></span>
<span id="cb43-83"><a href="#cb43-83" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-84"><a href="#cb43-84" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, ix_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb43-85"><a href="#cb43-85" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb43-86"><a href="#cb43-86" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"small"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb43-87"><a href="#cb43-87" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb43-88"><a href="#cb43-88" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"none"</span>))</span>
<span id="cb43-89"><a href="#cb43-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-90"><a href="#cb43-90" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_none_largeh <span class="sc">%&gt;%</span></span>
<span id="cb43-91"><a href="#cb43-91" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb43-92"><a href="#cb43-92" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb43-93"><a href="#cb43-93" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb43-94"><a href="#cb43-94" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb43-95"><a href="#cb43-95" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>all_effs_sex_ix_small_largeh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb44-39"><a href="#cb44-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb44-40"><a href="#cb44-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb44-41"><a href="#cb44-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb44-42"><a href="#cb44-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb44-43"><a href="#cb44-43" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb44-44"><a href="#cb44-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb44-45"><a href="#cb44-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb44-46"><a href="#cb44-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb44-47"><a href="#cb44-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb44-48"><a href="#cb44-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb44-49"><a href="#cb44-49" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb44-50"><a href="#cb44-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb44-51"><a href="#cb44-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb44-52"><a href="#cb44-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb44-53"><a href="#cb44-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb44-54"><a href="#cb44-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb44-55"><a href="#cb44-55" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb44-56"><a href="#cb44-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb44-57"><a href="#cb44-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb44-58"><a href="#cb44-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb44-59"><a href="#cb44-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb44-60"><a href="#cb44-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb44-61"><a href="#cb44-61" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb44-62"><a href="#cb44-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb44-63"><a href="#cb44-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb44-64"><a href="#cb44-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb44-65"><a href="#cb44-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb44-66"><a href="#cb44-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb44-67"><a href="#cb44-67" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb44-68"><a href="#cb44-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb44-69"><a href="#cb44-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb44-70"><a href="#cb44-70" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb44-71"><a href="#cb44-71" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb44-72"><a href="#cb44-72" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb44-73"><a href="#cb44-73" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb44-74"><a href="#cb44-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb44-75"><a href="#cb44-75" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb44-76"><a href="#cb44-76" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb44-77"><a href="#cb44-77" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb44-78"><a href="#cb44-78" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb44-79"><a href="#cb44-79" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb44-80"><a href="#cb44-80" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-81"><a href="#cb44-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-82"><a href="#cb44-82" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_small_largeh <span class="ot">&lt;-</span> all_effs_sex_ix_small_largeh <span class="sc">%&gt;%</span></span>
<span id="cb44-83"><a href="#cb44-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-84"><a href="#cb44-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, ix_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb44-85"><a href="#cb44-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb44-86"><a href="#cb44-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"small"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb44-87"><a href="#cb44-87" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb44-88"><a href="#cb44-88" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"small"</span>))</span>
<span id="cb44-89"><a href="#cb44-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-90"><a href="#cb44-90" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_small_largeh <span class="sc">%&gt;%</span></span>
<span id="cb44-91"><a href="#cb44-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb44-92"><a href="#cb44-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb44-93"><a href="#cb44-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb44-94"><a href="#cb44-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb44-95"><a href="#cb44-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-9-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-3-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>all_effs_sex_ix_large_largeh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb45-45"><a href="#cb45-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb45-46"><a href="#cb45-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb45-47"><a href="#cb45-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb45-48"><a href="#cb45-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb45-49"><a href="#cb45-49" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb45-50"><a href="#cb45-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb45-51"><a href="#cb45-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb45-52"><a href="#cb45-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb45-53"><a href="#cb45-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb45-54"><a href="#cb45-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb45-55"><a href="#cb45-55" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb45-56"><a href="#cb45-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb45-57"><a href="#cb45-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb45-58"><a href="#cb45-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb45-59"><a href="#cb45-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb45-60"><a href="#cb45-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb45-61"><a href="#cb45-61" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb45-62"><a href="#cb45-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb45-63"><a href="#cb45-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb45-64"><a href="#cb45-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb45-65"><a href="#cb45-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb45-66"><a href="#cb45-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb45-67"><a href="#cb45-67" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb45-68"><a href="#cb45-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb45-69"><a href="#cb45-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb45-70"><a href="#cb45-70" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb45-71"><a href="#cb45-71" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb45-72"><a href="#cb45-72" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb45-73"><a href="#cb45-73" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb45-74"><a href="#cb45-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb45-75"><a href="#cb45-75" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb45-76"><a href="#cb45-76" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb45-77"><a href="#cb45-77" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb45-78"><a href="#cb45-78" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb45-79"><a href="#cb45-79" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb45-80"><a href="#cb45-80" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb45-81"><a href="#cb45-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-82"><a href="#cb45-82" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_large_largeh <span class="ot">&lt;-</span> all_effs_sex_ix_large_largeh <span class="sc">%&gt;%</span></span>
<span id="cb45-83"><a href="#cb45-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-84"><a href="#cb45-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, ix_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb45-85"><a href="#cb45-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb45-86"><a href="#cb45-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb45-87"><a href="#cb45-87" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb45-88"><a href="#cb45-88" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>))</span>
<span id="cb45-89"><a href="#cb45-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-90"><a href="#cb45-90" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_large_largeh <span class="sc">%&gt;%</span></span>
<span id="cb45-91"><a href="#cb45-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb45-92"><a href="#cb45-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb45-93"><a href="#cb45-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb45-94"><a href="#cb45-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb45-95"><a href="#cb45-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<p>Power consequences of heteroscedasticities with varying (direction-only) interaction. Power anomalies indicate pretty low inferential abilities of such models at low sample sizes.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="ot">&lt;-</span> <span class="fu">rbind</span>(calc_power_sex_ix_small,</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>                               calc_power_sex_ix_large,</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>                               calc_power_sex_ix_small_lowh,</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>                               calc_power_sex_ix_large_lowh,</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>                               calc_power_sex_ix_small_largeh,</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>                               calc_power_sex_ix_large_largeh)</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">lapply</span>(all_sex_effs_sex_only, unlist))</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="sc">%&gt;%</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Effect <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Treatment"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">factor</span>(ix_eff_size,</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"small"</span>, <span class="st">"large"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">recode</span>(method,</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"ANOVA"</span> <span class="ot">=</span> <span class="st">"Factorial"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">factor</span>(heterosc,</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"large"</span>, <span class="st">"low"</span>, <span class="st">"none"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> ix_eff_size,</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> <span class="fu">interaction</span>(ix_eff_size, heterosc))) <span class="sc">+</span></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> heterosc)) <span class="sc">+</span></span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Statistical power"</span>) <span class="sc">+</span></span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Main treatment effect"</span>) <span class="sc">+</span></span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">name =</span> <span class="st">"Ix effect size"</span>, <span class="at">values =</span> cbb_palette) <span class="sc">+</span></span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_discrete</span>(<span class="at">name =</span> <span class="st">"Heteroscedasticity"</span>)  <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="sc">%&gt;%</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ix_eff_size <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sex_eff_size = factor(sex_eff_size,</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("none", "small", "large"))) %&gt;%</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">factor</span>(heterosc,</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"large"</span>, <span class="st">"low"</span>, <span class="st">"none"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> heterosc)) <span class="sc">+</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Statistical power"</span>) <span class="sc">+</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Main treatment effect"</span>) <span class="sc">+</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">name =</span> <span class="st">"Effect"</span>, <span class="at">values =</span> cbb_palette) <span class="sc">+</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_discrete</span>(<span class="at">name =</span> <span class="st">"Heteroscedasticity"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-41-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="impact-of-sample-size-on-power" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Impact of sample size on power</h1>
<section id="large-sex-eff-no-ix-5" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="large-sex-eff-no-ix-5"><span class="header-section-number">4.1</span> Large sex eff, no ix</h2>
<p>Below simulation code generates power estimates for the following sample size scenarios: 5M+5F in each treatment group (original scenario, totql sample 20 individuals), 10M+10F (N = 40), 50M+50F (N = 200).</p>
<p>First - low heteroscedasticity:</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true" href="">5M+5F</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false" href="">10M+10F</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-3" role="tab" aria-controls="tabset-10-3" aria-selected="false" href="">50M+50F</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>all_effs_sex_large_lowh_5 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb48-36"><a href="#cb48-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb48-37"><a href="#cb48-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb48-38"><a href="#cb48-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb48-39"><a href="#cb48-39" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-40"><a href="#cb48-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb48-41"><a href="#cb48-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb48-42"><a href="#cb48-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb48-43"><a href="#cb48-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb48-44"><a href="#cb48-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb48-45"><a href="#cb48-45" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-46"><a href="#cb48-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb48-47"><a href="#cb48-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb48-48"><a href="#cb48-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb48-49"><a href="#cb48-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb48-50"><a href="#cb48-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb48-51"><a href="#cb48-51" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-52"><a href="#cb48-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb48-53"><a href="#cb48-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb48-54"><a href="#cb48-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb48-55"><a href="#cb48-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb48-56"><a href="#cb48-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb48-57"><a href="#cb48-57" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-58"><a href="#cb48-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb48-59"><a href="#cb48-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb48-60"><a href="#cb48-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb48-61"><a href="#cb48-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb48-62"><a href="#cb48-62" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb48-63"><a href="#cb48-63" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-64"><a href="#cb48-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb48-65"><a href="#cb48-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb48-66"><a href="#cb48-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb48-67"><a href="#cb48-67" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb48-68"><a href="#cb48-68" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb48-69"><a href="#cb48-69" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-70"><a href="#cb48-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb48-71"><a href="#cb48-71" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb48-72"><a href="#cb48-72" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb48-73"><a href="#cb48-73" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb48-74"><a href="#cb48-74" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb48-75"><a href="#cb48-75" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-76"><a href="#cb48-76" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb48-77"><a href="#cb48-77" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb48-78"><a href="#cb48-78" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb48-79"><a href="#cb48-79" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb48-80"><a href="#cb48-80" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb48-81"><a href="#cb48-81" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb48-82"><a href="#cb48-82" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-83"><a href="#cb48-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-84"><a href="#cb48-84" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large_lowh_5 <span class="ot">&lt;-</span> all_effs_sex_large_lowh_5 <span class="sc">%&gt;%</span></span>
<span id="cb48-85"><a href="#cb48-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-86"><a href="#cb48-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb48-87"><a href="#cb48-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb48-88"><a href="#cb48-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-89"><a href="#cb48-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"none"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-90"><a href="#cb48-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sample_size =</span> <span class="fu">rep</span>(<span class="st">"5M+5F"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-91"><a href="#cb48-91" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"low"</span>))</span>
<span id="cb48-92"><a href="#cb48-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-93"><a href="#cb48-93" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large_lowh_5 <span class="sc">%&gt;%</span></span>
<span id="cb48-94"><a href="#cb48-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb48-95"><a href="#cb48-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb48-96"><a href="#cb48-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb48-97"><a href="#cb48-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb48-98"><a href="#cb48-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>all_effs_sex_large_lowh_10 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb49-30"><a href="#cb49-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb49-31"><a href="#cb49-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb49-32"><a href="#cb49-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb49-33"><a href="#cb49-33" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb49-34"><a href="#cb49-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb49-35"><a href="#cb49-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb49-36"><a href="#cb49-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb49-37"><a href="#cb49-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb49-38"><a href="#cb49-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb49-39"><a href="#cb49-39" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb49-40"><a href="#cb49-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb49-41"><a href="#cb49-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb49-42"><a href="#cb49-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb49-43"><a href="#cb49-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb49-44"><a href="#cb49-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb49-45"><a href="#cb49-45" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb49-46"><a href="#cb49-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb49-47"><a href="#cb49-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb49-48"><a href="#cb49-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb49-49"><a href="#cb49-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb49-50"><a href="#cb49-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb49-51"><a href="#cb49-51" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb49-52"><a href="#cb49-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb49-53"><a href="#cb49-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb49-54"><a href="#cb49-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb49-55"><a href="#cb49-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb49-56"><a href="#cb49-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb49-57"><a href="#cb49-57" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb49-58"><a href="#cb49-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb49-59"><a href="#cb49-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb49-60"><a href="#cb49-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb49-61"><a href="#cb49-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb49-62"><a href="#cb49-62" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb49-63"><a href="#cb49-63" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb49-64"><a href="#cb49-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb49-65"><a href="#cb49-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb49-66"><a href="#cb49-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb49-67"><a href="#cb49-67" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb49-68"><a href="#cb49-68" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb49-69"><a href="#cb49-69" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb49-70"><a href="#cb49-70" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb49-71"><a href="#cb49-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-72"><a href="#cb49-72" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large_lowh_10 <span class="ot">&lt;-</span> all_effs_sex_large_lowh_10 <span class="sc">%&gt;%</span></span>
<span id="cb49-73"><a href="#cb49-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-74"><a href="#cb49-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb49-75"><a href="#cb49-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb49-76"><a href="#cb49-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb49-77"><a href="#cb49-77" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"none"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb49-78"><a href="#cb49-78" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sample_size =</span> <span class="fu">rep</span>(<span class="st">"10M+10F"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb49-79"><a href="#cb49-79" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"low"</span>))</span>
<span id="cb49-80"><a href="#cb49-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-81"><a href="#cb49-81" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large_lowh_10 <span class="sc">%&gt;%</span></span>
<span id="cb49-82"><a href="#cb49-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb49-83"><a href="#cb49-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb49-84"><a href="#cb49-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb49-85"><a href="#cb49-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb49-86"><a href="#cb49-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-10-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-3-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>all_effs_sex_large_lowh_50 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb50-30"><a href="#cb50-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb50-31"><a href="#cb50-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb50-32"><a href="#cb50-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb50-33"><a href="#cb50-33" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb50-34"><a href="#cb50-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb50-35"><a href="#cb50-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb50-36"><a href="#cb50-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb50-37"><a href="#cb50-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb50-38"><a href="#cb50-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb50-39"><a href="#cb50-39" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb50-40"><a href="#cb50-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb50-41"><a href="#cb50-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb50-42"><a href="#cb50-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb50-43"><a href="#cb50-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb50-44"><a href="#cb50-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb50-45"><a href="#cb50-45" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb50-46"><a href="#cb50-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb50-47"><a href="#cb50-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb50-48"><a href="#cb50-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb50-49"><a href="#cb50-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb50-50"><a href="#cb50-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb50-51"><a href="#cb50-51" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb50-52"><a href="#cb50-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb50-53"><a href="#cb50-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb50-54"><a href="#cb50-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb50-55"><a href="#cb50-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb50-56"><a href="#cb50-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb50-57"><a href="#cb50-57" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb50-58"><a href="#cb50-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb50-59"><a href="#cb50-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb50-60"><a href="#cb50-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb50-61"><a href="#cb50-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb50-62"><a href="#cb50-62" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb50-63"><a href="#cb50-63" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb50-64"><a href="#cb50-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb50-65"><a href="#cb50-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb50-66"><a href="#cb50-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb50-67"><a href="#cb50-67" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb50-68"><a href="#cb50-68" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb50-69"><a href="#cb50-69" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb50-70"><a href="#cb50-70" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb50-71"><a href="#cb50-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-72"><a href="#cb50-72" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large_lowh_50 <span class="ot">&lt;-</span> all_effs_sex_large_lowh_50 <span class="sc">%&gt;%</span></span>
<span id="cb50-73"><a href="#cb50-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-74"><a href="#cb50-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb50-75"><a href="#cb50-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb50-76"><a href="#cb50-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb50-77"><a href="#cb50-77" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"none"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb50-78"><a href="#cb50-78" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sample_size =</span> <span class="fu">rep</span>(<span class="st">"50M+50F"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb50-79"><a href="#cb50-79" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"low"</span>))</span>
<span id="cb50-80"><a href="#cb50-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-81"><a href="#cb50-81" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large_lowh_50 <span class="sc">%&gt;%</span></span>
<span id="cb50-82"><a href="#cb50-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb50-83"><a href="#cb50-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb50-84"><a href="#cb50-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb50-85"><a href="#cb50-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb50-86"><a href="#cb50-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<p>Large heteroscedasticity:</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true" href="">5M+5F</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false" href="">10M+10F</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-3" role="tab" aria-controls="tabset-11-3" aria-selected="false" href="">50M+50F</a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>all_effs_sex_large_largeh_5 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb51-35"><a href="#cb51-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb51-36"><a href="#cb51-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb51-37"><a href="#cb51-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb51-38"><a href="#cb51-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb51-39"><a href="#cb51-39" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb51-40"><a href="#cb51-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb51-41"><a href="#cb51-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb51-42"><a href="#cb51-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb51-43"><a href="#cb51-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb51-44"><a href="#cb51-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb51-45"><a href="#cb51-45" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb51-46"><a href="#cb51-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb51-47"><a href="#cb51-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb51-48"><a href="#cb51-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb51-49"><a href="#cb51-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb51-50"><a href="#cb51-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb51-51"><a href="#cb51-51" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb51-52"><a href="#cb51-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb51-53"><a href="#cb51-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb51-54"><a href="#cb51-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb51-55"><a href="#cb51-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb51-56"><a href="#cb51-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb51-57"><a href="#cb51-57" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb51-58"><a href="#cb51-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb51-59"><a href="#cb51-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb51-60"><a href="#cb51-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb51-61"><a href="#cb51-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb51-62"><a href="#cb51-62" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb51-63"><a href="#cb51-63" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb51-64"><a href="#cb51-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb51-65"><a href="#cb51-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb51-66"><a href="#cb51-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb51-67"><a href="#cb51-67" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb51-68"><a href="#cb51-68" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb51-69"><a href="#cb51-69" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb51-70"><a href="#cb51-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb51-71"><a href="#cb51-71" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb51-72"><a href="#cb51-72" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb51-73"><a href="#cb51-73" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb51-74"><a href="#cb51-74" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb51-75"><a href="#cb51-75" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb51-76"><a href="#cb51-76" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb51-77"><a href="#cb51-77" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb51-78"><a href="#cb51-78" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb51-79"><a href="#cb51-79" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb51-80"><a href="#cb51-80" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb51-81"><a href="#cb51-81" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb51-82"><a href="#cb51-82" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb51-83"><a href="#cb51-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-84"><a href="#cb51-84" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large_largeh_5 <span class="ot">&lt;-</span> all_effs_sex_large_largeh_5 <span class="sc">%&gt;%</span></span>
<span id="cb51-85"><a href="#cb51-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb51-86"><a href="#cb51-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb51-87"><a href="#cb51-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb51-88"><a href="#cb51-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb51-89"><a href="#cb51-89" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"none"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb51-90"><a href="#cb51-90" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sample_size =</span> <span class="fu">rep</span>(<span class="st">"5M+5F"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb51-91"><a href="#cb51-91" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"large"</span>))</span>
<span id="cb51-92"><a href="#cb51-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-93"><a href="#cb51-93" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large_largeh_5 <span class="sc">%&gt;%</span></span>
<span id="cb51-94"><a href="#cb51-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb51-95"><a href="#cb51-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb51-96"><a href="#cb51-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb51-97"><a href="#cb51-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb51-98"><a href="#cb51-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>all_effs_sex_large_largeh_10 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb52-29"><a href="#cb52-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb52-30"><a href="#cb52-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb52-31"><a href="#cb52-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb52-32"><a href="#cb52-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb52-33"><a href="#cb52-33" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb52-34"><a href="#cb52-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb52-35"><a href="#cb52-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb52-36"><a href="#cb52-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb52-37"><a href="#cb52-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb52-38"><a href="#cb52-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb52-39"><a href="#cb52-39" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb52-40"><a href="#cb52-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb52-41"><a href="#cb52-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb52-42"><a href="#cb52-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb52-43"><a href="#cb52-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb52-44"><a href="#cb52-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb52-45"><a href="#cb52-45" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb52-46"><a href="#cb52-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb52-47"><a href="#cb52-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb52-48"><a href="#cb52-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb52-49"><a href="#cb52-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb52-50"><a href="#cb52-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb52-51"><a href="#cb52-51" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb52-52"><a href="#cb52-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb52-53"><a href="#cb52-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb52-54"><a href="#cb52-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb52-55"><a href="#cb52-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb52-56"><a href="#cb52-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb52-57"><a href="#cb52-57" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb52-58"><a href="#cb52-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb52-59"><a href="#cb52-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb52-60"><a href="#cb52-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb52-61"><a href="#cb52-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb52-62"><a href="#cb52-62" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb52-63"><a href="#cb52-63" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb52-64"><a href="#cb52-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb52-65"><a href="#cb52-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb52-66"><a href="#cb52-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb52-67"><a href="#cb52-67" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb52-68"><a href="#cb52-68" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb52-69"><a href="#cb52-69" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb52-70"><a href="#cb52-70" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb52-71"><a href="#cb52-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-72"><a href="#cb52-72" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large_largeh_10 <span class="ot">&lt;-</span> all_effs_sex_large_largeh_10 <span class="sc">%&gt;%</span></span>
<span id="cb52-73"><a href="#cb52-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-74"><a href="#cb52-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb52-75"><a href="#cb52-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb52-76"><a href="#cb52-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb52-77"><a href="#cb52-77" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"none"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb52-78"><a href="#cb52-78" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sample_size =</span> <span class="fu">rep</span>(<span class="st">"10M+10F"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb52-79"><a href="#cb52-79" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"large"</span>))</span>
<span id="cb52-80"><a href="#cb52-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-81"><a href="#cb52-81" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large_largeh_10 <span class="sc">%&gt;%</span></span>
<span id="cb52-82"><a href="#cb52-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb52-83"><a href="#cb52-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb52-84"><a href="#cb52-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb52-85"><a href="#cb52-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb52-86"><a href="#cb52-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-11-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-3-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>all_effs_sex_large_largeh_50 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb53-33"><a href="#cb53-33" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb53-34"><a href="#cb53-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb53-35"><a href="#cb53-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb53-36"><a href="#cb53-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb53-37"><a href="#cb53-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb53-38"><a href="#cb53-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb53-39"><a href="#cb53-39" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb53-40"><a href="#cb53-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb53-41"><a href="#cb53-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb53-42"><a href="#cb53-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb53-43"><a href="#cb53-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb53-44"><a href="#cb53-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb53-45"><a href="#cb53-45" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb53-46"><a href="#cb53-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb53-47"><a href="#cb53-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb53-48"><a href="#cb53-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb53-49"><a href="#cb53-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb53-50"><a href="#cb53-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb53-51"><a href="#cb53-51" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb53-52"><a href="#cb53-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb53-53"><a href="#cb53-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb53-54"><a href="#cb53-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb53-55"><a href="#cb53-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb53-56"><a href="#cb53-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb53-57"><a href="#cb53-57" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb53-58"><a href="#cb53-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb53-59"><a href="#cb53-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb53-60"><a href="#cb53-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb53-61"><a href="#cb53-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb53-62"><a href="#cb53-62" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb53-63"><a href="#cb53-63" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb53-64"><a href="#cb53-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb53-65"><a href="#cb53-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb53-66"><a href="#cb53-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb53-67"><a href="#cb53-67" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb53-68"><a href="#cb53-68" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb53-69"><a href="#cb53-69" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb53-70"><a href="#cb53-70" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb53-71"><a href="#cb53-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-72"><a href="#cb53-72" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large_largeh_50 <span class="ot">&lt;-</span> all_effs_sex_large_largeh_50 <span class="sc">%&gt;%</span></span>
<span id="cb53-73"><a href="#cb53-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-74"><a href="#cb53-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb53-75"><a href="#cb53-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb53-76"><a href="#cb53-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-77"><a href="#cb53-77" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"none"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-78"><a href="#cb53-78" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sample_size =</span> <span class="fu">rep</span>(<span class="st">"50M+50F"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-79"><a href="#cb53-79" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"large"</span>))</span>
<span id="cb53-80"><a href="#cb53-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-81"><a href="#cb53-81" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large_largeh_50 <span class="sc">%&gt;%</span></span>
<span id="cb53-82"><a href="#cb53-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb53-83"><a href="#cb53-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb53-84"><a href="#cb53-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb53-85"><a href="#cb53-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb53-86"><a href="#cb53-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="large-sex-effect-crossed-reaction-norms-interaction" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="large-sex-effect-crossed-reaction-norms-interaction"><span class="header-section-number">4.2</span> Large sex effect, crossed reaction norms (interaction)</h2>
<p>Identical sample size scenarios.</p>
<p>First - <strong>low heteroscedasticity</strong></p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true" href="">5M+5F</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false" href="">10M+10F</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-3" role="tab" aria-controls="tabset-12-3" aria-selected="false" href="">50M+50F</a></li></ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>all_effs_sex_ix_large_lowh_5 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb54-32"><a href="#cb54-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb54-33"><a href="#cb54-33" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb54-34"><a href="#cb54-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb54-35"><a href="#cb54-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb54-36"><a href="#cb54-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb54-37"><a href="#cb54-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb54-38"><a href="#cb54-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb54-39"><a href="#cb54-39" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb54-40"><a href="#cb54-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb54-41"><a href="#cb54-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb54-42"><a href="#cb54-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb54-43"><a href="#cb54-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb54-44"><a href="#cb54-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb54-45"><a href="#cb54-45" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb54-46"><a href="#cb54-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb54-47"><a href="#cb54-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb54-48"><a href="#cb54-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb54-49"><a href="#cb54-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb54-50"><a href="#cb54-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb54-51"><a href="#cb54-51" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb54-52"><a href="#cb54-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb54-53"><a href="#cb54-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb54-54"><a href="#cb54-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb54-55"><a href="#cb54-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb54-56"><a href="#cb54-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb54-57"><a href="#cb54-57" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb54-58"><a href="#cb54-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb54-59"><a href="#cb54-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb54-60"><a href="#cb54-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb54-61"><a href="#cb54-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb54-62"><a href="#cb54-62" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb54-63"><a href="#cb54-63" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb54-64"><a href="#cb54-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb54-65"><a href="#cb54-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb54-66"><a href="#cb54-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb54-67"><a href="#cb54-67" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb54-68"><a href="#cb54-68" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb54-69"><a href="#cb54-69" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb54-70"><a href="#cb54-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb54-71"><a href="#cb54-71" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb54-72"><a href="#cb54-72" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb54-73"><a href="#cb54-73" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb54-74"><a href="#cb54-74" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb54-75"><a href="#cb54-75" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb54-76"><a href="#cb54-76" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb54-77"><a href="#cb54-77" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb54-78"><a href="#cb54-78" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb54-79"><a href="#cb54-79" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb54-80"><a href="#cb54-80" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb54-81"><a href="#cb54-81" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb54-82"><a href="#cb54-82" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-83"><a href="#cb54-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-84"><a href="#cb54-84" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_large_lowh_5 <span class="ot">&lt;-</span> all_effs_sex_ix_large_lowh_5 <span class="sc">%&gt;%</span></span>
<span id="cb54-85"><a href="#cb54-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-86"><a href="#cb54-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb54-87"><a href="#cb54-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb54-88"><a href="#cb54-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb54-89"><a href="#cb54-89" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb54-90"><a href="#cb54-90" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sample_size =</span> <span class="fu">rep</span>(<span class="st">"5M+5F"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb54-91"><a href="#cb54-91" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"low"</span>))</span>
<span id="cb54-92"><a href="#cb54-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-93"><a href="#cb54-93" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_large_lowh_5 <span class="sc">%&gt;%</span></span>
<span id="cb54-94"><a href="#cb54-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb54-95"><a href="#cb54-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb54-96"><a href="#cb54-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb54-97"><a href="#cb54-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb54-98"><a href="#cb54-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>all_effs_sex_ix_large_lowh_10 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb55-29"><a href="#cb55-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb55-30"><a href="#cb55-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb55-31"><a href="#cb55-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb55-32"><a href="#cb55-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb55-33"><a href="#cb55-33" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb55-34"><a href="#cb55-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb55-35"><a href="#cb55-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb55-36"><a href="#cb55-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb55-37"><a href="#cb55-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb55-38"><a href="#cb55-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb55-39"><a href="#cb55-39" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb55-40"><a href="#cb55-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb55-41"><a href="#cb55-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb55-42"><a href="#cb55-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb55-43"><a href="#cb55-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb55-44"><a href="#cb55-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb55-45"><a href="#cb55-45" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb55-46"><a href="#cb55-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb55-47"><a href="#cb55-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb55-48"><a href="#cb55-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb55-49"><a href="#cb55-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb55-50"><a href="#cb55-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb55-51"><a href="#cb55-51" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb55-52"><a href="#cb55-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb55-53"><a href="#cb55-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb55-54"><a href="#cb55-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb55-55"><a href="#cb55-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb55-56"><a href="#cb55-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb55-57"><a href="#cb55-57" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb55-58"><a href="#cb55-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb55-59"><a href="#cb55-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb55-60"><a href="#cb55-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb55-61"><a href="#cb55-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb55-62"><a href="#cb55-62" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb55-63"><a href="#cb55-63" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb55-64"><a href="#cb55-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb55-65"><a href="#cb55-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb55-66"><a href="#cb55-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb55-67"><a href="#cb55-67" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb55-68"><a href="#cb55-68" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb55-69"><a href="#cb55-69" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb55-70"><a href="#cb55-70" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb55-71"><a href="#cb55-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-72"><a href="#cb55-72" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_large_lowh_10 <span class="ot">&lt;-</span> all_effs_sex_ix_large_lowh_10 <span class="sc">%&gt;%</span></span>
<span id="cb55-73"><a href="#cb55-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-74"><a href="#cb55-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb55-75"><a href="#cb55-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb55-76"><a href="#cb55-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb55-77"><a href="#cb55-77" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb55-78"><a href="#cb55-78" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sample_size =</span> <span class="fu">rep</span>(<span class="st">"10M+10F"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb55-79"><a href="#cb55-79" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"low"</span>))</span>
<span id="cb55-80"><a href="#cb55-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-81"><a href="#cb55-81" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_large_lowh_10 <span class="sc">%&gt;%</span></span>
<span id="cb55-82"><a href="#cb55-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb55-83"><a href="#cb55-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb55-84"><a href="#cb55-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb55-85"><a href="#cb55-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb55-86"><a href="#cb55-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-12-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-3-tab">
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>all_effs_sex_ix_large_lowh_50 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb56-30"><a href="#cb56-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb56-31"><a href="#cb56-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb56-32"><a href="#cb56-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb56-33"><a href="#cb56-33" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb56-34"><a href="#cb56-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb56-35"><a href="#cb56-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb56-36"><a href="#cb56-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb56-37"><a href="#cb56-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb56-38"><a href="#cb56-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb56-39"><a href="#cb56-39" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb56-40"><a href="#cb56-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb56-41"><a href="#cb56-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb56-42"><a href="#cb56-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb56-43"><a href="#cb56-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb56-44"><a href="#cb56-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb56-45"><a href="#cb56-45" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb56-46"><a href="#cb56-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb56-47"><a href="#cb56-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb56-48"><a href="#cb56-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb56-49"><a href="#cb56-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb56-50"><a href="#cb56-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb56-51"><a href="#cb56-51" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb56-52"><a href="#cb56-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb56-53"><a href="#cb56-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb56-54"><a href="#cb56-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb56-55"><a href="#cb56-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb56-56"><a href="#cb56-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb56-57"><a href="#cb56-57" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb56-58"><a href="#cb56-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb56-59"><a href="#cb56-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb56-60"><a href="#cb56-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb56-61"><a href="#cb56-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb56-62"><a href="#cb56-62" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb56-63"><a href="#cb56-63" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb56-64"><a href="#cb56-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb56-65"><a href="#cb56-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb56-66"><a href="#cb56-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb56-67"><a href="#cb56-67" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb56-68"><a href="#cb56-68" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb56-69"><a href="#cb56-69" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb56-70"><a href="#cb56-70" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-71"><a href="#cb56-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-72"><a href="#cb56-72" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_large_lowh_50 <span class="ot">&lt;-</span> all_effs_sex_ix_large_lowh_50 <span class="sc">%&gt;%</span></span>
<span id="cb56-73"><a href="#cb56-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-74"><a href="#cb56-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb56-75"><a href="#cb56-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb56-76"><a href="#cb56-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb56-77"><a href="#cb56-77" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb56-78"><a href="#cb56-78" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sample_size =</span> <span class="fu">rep</span>(<span class="st">"50M+50F"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb56-79"><a href="#cb56-79" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"low"</span>))</span>
<span id="cb56-80"><a href="#cb56-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-81"><a href="#cb56-81" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_large_lowh_50 <span class="sc">%&gt;%</span></span>
<span id="cb56-82"><a href="#cb56-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb56-83"><a href="#cb56-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb56-84"><a href="#cb56-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb56-85"><a href="#cb56-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb56-86"><a href="#cb56-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<p><strong>Large heteroscedasticity</strong></p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true" href="">5M+5F</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false" href="">10M+10F</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-3" role="tab" aria-controls="tabset-13-3" aria-selected="false" href="">50M+50F</a></li></ul>
<div class="tab-content">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span></span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>all_effs_sex_ix_large_largeh_5 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb57-28"><a href="#cb57-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb57-29"><a href="#cb57-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb57-30"><a href="#cb57-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb57-31"><a href="#cb57-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb57-32"><a href="#cb57-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb57-33"><a href="#cb57-33" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb57-34"><a href="#cb57-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb57-35"><a href="#cb57-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb57-36"><a href="#cb57-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb57-37"><a href="#cb57-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb57-38"><a href="#cb57-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb57-39"><a href="#cb57-39" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb57-40"><a href="#cb57-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb57-41"><a href="#cb57-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb57-42"><a href="#cb57-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb57-43"><a href="#cb57-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb57-44"><a href="#cb57-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb57-45"><a href="#cb57-45" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb57-46"><a href="#cb57-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb57-47"><a href="#cb57-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb57-48"><a href="#cb57-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb57-49"><a href="#cb57-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb57-50"><a href="#cb57-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb57-51"><a href="#cb57-51" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb57-52"><a href="#cb57-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb57-53"><a href="#cb57-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb57-54"><a href="#cb57-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb57-55"><a href="#cb57-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb57-56"><a href="#cb57-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb57-57"><a href="#cb57-57" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb57-58"><a href="#cb57-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb57-59"><a href="#cb57-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb57-60"><a href="#cb57-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb57-61"><a href="#cb57-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb57-62"><a href="#cb57-62" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb57-63"><a href="#cb57-63" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb57-64"><a href="#cb57-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb57-65"><a href="#cb57-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb57-66"><a href="#cb57-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb57-67"><a href="#cb57-67" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb57-68"><a href="#cb57-68" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb57-69"><a href="#cb57-69" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb57-70"><a href="#cb57-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb57-71"><a href="#cb57-71" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb57-72"><a href="#cb57-72" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb57-73"><a href="#cb57-73" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb57-74"><a href="#cb57-74" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb57-75"><a href="#cb57-75" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb57-76"><a href="#cb57-76" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb57-77"><a href="#cb57-77" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb57-78"><a href="#cb57-78" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb57-79"><a href="#cb57-79" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb57-80"><a href="#cb57-80" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb57-81"><a href="#cb57-81" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb57-82"><a href="#cb57-82" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb57-83"><a href="#cb57-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-84"><a href="#cb57-84" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_large_largeh_5 <span class="ot">&lt;-</span> all_effs_sex_ix_large_largeh_5 <span class="sc">%&gt;%</span></span>
<span id="cb57-85"><a href="#cb57-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb57-86"><a href="#cb57-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb57-87"><a href="#cb57-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb57-88"><a href="#cb57-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb57-89"><a href="#cb57-89" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb57-90"><a href="#cb57-90" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sample_size =</span> <span class="fu">rep</span>(<span class="st">"5M+5F"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb57-91"><a href="#cb57-91" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"large"</span>))</span>
<span id="cb57-92"><a href="#cb57-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-93"><a href="#cb57-93" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_large_largeh_5 <span class="sc">%&gt;%</span></span>
<span id="cb57-94"><a href="#cb57-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb57-95"><a href="#cb57-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb57-96"><a href="#cb57-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb57-97"><a href="#cb57-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb57-98"><a href="#cb57-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>all_effs_sex_ix_large_largeh_10 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb58-27"><a href="#cb58-27" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb58-28"><a href="#cb58-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb58-29"><a href="#cb58-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb58-30"><a href="#cb58-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb58-31"><a href="#cb58-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb58-32"><a href="#cb58-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb58-33"><a href="#cb58-33" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb58-34"><a href="#cb58-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb58-35"><a href="#cb58-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb58-36"><a href="#cb58-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb58-37"><a href="#cb58-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb58-38"><a href="#cb58-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb58-39"><a href="#cb58-39" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb58-40"><a href="#cb58-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb58-41"><a href="#cb58-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb58-42"><a href="#cb58-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb58-43"><a href="#cb58-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb58-44"><a href="#cb58-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb58-45"><a href="#cb58-45" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb58-46"><a href="#cb58-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb58-47"><a href="#cb58-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb58-48"><a href="#cb58-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb58-49"><a href="#cb58-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb58-50"><a href="#cb58-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb58-51"><a href="#cb58-51" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb58-52"><a href="#cb58-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb58-53"><a href="#cb58-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb58-54"><a href="#cb58-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb58-55"><a href="#cb58-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb58-56"><a href="#cb58-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb58-57"><a href="#cb58-57" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb58-58"><a href="#cb58-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb58-59"><a href="#cb58-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb58-60"><a href="#cb58-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb58-61"><a href="#cb58-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb58-62"><a href="#cb58-62" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb58-63"><a href="#cb58-63" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb58-64"><a href="#cb58-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb58-65"><a href="#cb58-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb58-66"><a href="#cb58-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb58-67"><a href="#cb58-67" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb58-68"><a href="#cb58-68" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb58-69"><a href="#cb58-69" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb58-70"><a href="#cb58-70" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb58-71"><a href="#cb58-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-72"><a href="#cb58-72" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_large_largeh_10 <span class="ot">&lt;-</span> all_effs_sex_ix_large_largeh_10 <span class="sc">%&gt;%</span></span>
<span id="cb58-73"><a href="#cb58-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-74"><a href="#cb58-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb58-75"><a href="#cb58-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb58-76"><a href="#cb58-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb58-77"><a href="#cb58-77" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb58-78"><a href="#cb58-78" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sample_size =</span> <span class="fu">rep</span>(<span class="st">"10M+10F"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb58-79"><a href="#cb58-79" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"large"</span>))</span>
<span id="cb58-80"><a href="#cb58-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-81"><a href="#cb58-81" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_large_largeh_10 <span class="sc">%&gt;%</span></span>
<span id="cb58-82"><a href="#cb58-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb58-83"><a href="#cb58-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb58-84"><a href="#cb58-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb58-85"><a href="#cb58-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb58-86"><a href="#cb58-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-13-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-3-tab">
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>all_effs_sex_ix_large_largeh_50 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb59-30"><a href="#cb59-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb59-31"><a href="#cb59-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb59-32"><a href="#cb59-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb59-33"><a href="#cb59-33" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb59-34"><a href="#cb59-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb59-35"><a href="#cb59-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb59-36"><a href="#cb59-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb59-37"><a href="#cb59-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb59-38"><a href="#cb59-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb59-39"><a href="#cb59-39" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb59-40"><a href="#cb59-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb59-41"><a href="#cb59-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb59-42"><a href="#cb59-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb59-43"><a href="#cb59-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb59-44"><a href="#cb59-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb59-45"><a href="#cb59-45" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb59-46"><a href="#cb59-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb59-47"><a href="#cb59-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb59-48"><a href="#cb59-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb59-49"><a href="#cb59-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb59-50"><a href="#cb59-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb59-51"><a href="#cb59-51" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb59-52"><a href="#cb59-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb59-53"><a href="#cb59-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb59-54"><a href="#cb59-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb59-55"><a href="#cb59-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb59-56"><a href="#cb59-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb59-57"><a href="#cb59-57" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb59-58"><a href="#cb59-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb59-59"><a href="#cb59-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb59-60"><a href="#cb59-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb59-61"><a href="#cb59-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb59-62"><a href="#cb59-62" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb59-63"><a href="#cb59-63" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb59-64"><a href="#cb59-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb59-65"><a href="#cb59-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb59-66"><a href="#cb59-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb59-67"><a href="#cb59-67" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb59-68"><a href="#cb59-68" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb59-69"><a href="#cb59-69" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb59-70"><a href="#cb59-70" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb59-71"><a href="#cb59-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-72"><a href="#cb59-72" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_large_largeh_50 <span class="ot">&lt;-</span> all_effs_sex_ix_large_largeh_50 <span class="sc">%&gt;%</span></span>
<span id="cb59-73"><a href="#cb59-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb59-74"><a href="#cb59-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb59-75"><a href="#cb59-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb59-76"><a href="#cb59-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb59-77"><a href="#cb59-77" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb59-78"><a href="#cb59-78" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sample_size =</span> <span class="fu">rep</span>(<span class="st">"50M+50F"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb59-79"><a href="#cb59-79" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"large"</span>))</span>
<span id="cb59-80"><a href="#cb59-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-81"><a href="#cb59-81" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_large_largeh_50 <span class="sc">%&gt;%</span></span>
<span id="cb59-82"><a href="#cb59-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb59-83"><a href="#cb59-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb59-84"><a href="#cb59-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb59-85"><a href="#cb59-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb59-86"><a href="#cb59-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="summaries-of-sample-size-scenarios" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="summaries-of-sample-size-scenarios"><span class="header-section-number">4.3</span> Summaries of sample size scenarios</h2>
<p>No interaction, low (left) and large (right) heteroscedasticity:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>    calc_power_sex_large_lowh_5,</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>    calc_power_sex_large_lowh_10,</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>    calc_power_sex_large_lowh_50,</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>    calc_power_sex_large_largeh_5,</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>    calc_power_sex_large_largeh_10,</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>    calc_power_sex_large_largeh_50</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">lapply</span>(all_sex_effs_sex_only, unlist))</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a><span class="co"># plot1 &lt;- all_sex_effs_sex_only %&gt;%</span></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(Effect %in% c("Treatment")) %&gt;%</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(heterosc %in% c("low")) %&gt;%</span></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sample_size = factor(sample_size,</span></span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("5M+5F", "10M+10F", "50M+50F"))) %&gt;%</span></span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(method = recode(method,</span></span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a><span class="co">#                          "ANOVA" = "Factorial")) %&gt;%</span></span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x = treat_es2, y = p_value, colour = sample_size)) +</span></span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_hline(yintercept = 0.8, linetype = 1, colour = "red") +</span></span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_line() +</span></span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_bw() +</span></span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylab("Statistical power") +</span></span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a><span class="co">#   xlab("Main treatment effect") +</span></span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_colour_manual(name = "Sample size", values = cbb_palette) +</span></span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a><span class="co">#   # scale_linetype_discrete(name = "Heteroscedasticity")  +</span></span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylim(0, 1)</span></span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-29"><a href="#cb60-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-30"><a href="#cb60-30" aria-hidden="true" tabindex="-1"></a><span class="co"># plot2 &lt;- all_sex_effs_sex_only %&gt;%</span></span>
<span id="cb60-31"><a href="#cb60-31" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(Effect %in% c("Treatment")) %&gt;%</span></span>
<span id="cb60-32"><a href="#cb60-32" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(heterosc %in% c("large")) %&gt;%</span></span>
<span id="cb60-33"><a href="#cb60-33" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sample_size = factor(sample_size,</span></span>
<span id="cb60-34"><a href="#cb60-34" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("5M+5F", "10M+10F", "50M+50F"))) %&gt;%</span></span>
<span id="cb60-35"><a href="#cb60-35" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(method = recode(method,</span></span>
<span id="cb60-36"><a href="#cb60-36" aria-hidden="true" tabindex="-1"></a><span class="co">#                          "ANOVA" = "Factorial")) %&gt;%</span></span>
<span id="cb60-37"><a href="#cb60-37" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x = treat_es2, y = p_value, colour = sample_size)) +</span></span>
<span id="cb60-38"><a href="#cb60-38" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_hline(yintercept = 0.8, linetype = 1, colour = "red") +</span></span>
<span id="cb60-39"><a href="#cb60-39" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_line() +</span></span>
<span id="cb60-40"><a href="#cb60-40" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_bw() +</span></span>
<span id="cb60-41"><a href="#cb60-41" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylab("Statistical power") +</span></span>
<span id="cb60-42"><a href="#cb60-42" aria-hidden="true" tabindex="-1"></a><span class="co">#   xlab("Main treatment effect") +</span></span>
<span id="cb60-43"><a href="#cb60-43" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_colour_manual(name = "Sample size", values = cbb_palette) +</span></span>
<span id="cb60-44"><a href="#cb60-44" aria-hidden="true" tabindex="-1"></a><span class="co">#   # scale_linetype_discrete(name = "Heteroscedasticity")  +</span></span>
<span id="cb60-45"><a href="#cb60-45" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylim(0, 1)</span></span>
<span id="cb60-46"><a href="#cb60-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-47"><a href="#cb60-47" aria-hidden="true" tabindex="-1"></a><span class="co"># ggarrange(plot1, plot2, ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")</span></span>
<span id="cb60-48"><a href="#cb60-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-49"><a href="#cb60-49" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> all_sex_effs_sex_only <span class="sc">%&gt;%</span></span>
<span id="cb60-50"><a href="#cb60-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(heterosc <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"low"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb60-51"><a href="#cb60-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sample_size =</span> <span class="fu">factor</span>(sample_size,</span>
<span id="cb60-52"><a href="#cb60-52" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"5M+5F"</span>, <span class="st">"10M+10F"</span>, <span class="st">"50M+50F"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb60-53"><a href="#cb60-53" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sex_eff_size = factor(sex_eff_size,</span></span>
<span id="cb60-54"><a href="#cb60-54" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("none", "small", "large"))) %&gt;%</span></span>
<span id="cb60-55"><a href="#cb60-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb60-56"><a href="#cb60-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb60-57"><a href="#cb60-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> sample_size)) <span class="sc">+</span></span>
<span id="cb60-58"><a href="#cb60-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb60-59"><a href="#cb60-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Statistical power"</span>) <span class="sc">+</span></span>
<span id="cb60-60"><a href="#cb60-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Main treatment effect"</span>) <span class="sc">+</span></span>
<span id="cb60-61"><a href="#cb60-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">name =</span> <span class="st">"Effect"</span>, <span class="at">values =</span> cbb_palette) <span class="sc">+</span></span>
<span id="cb60-62"><a href="#cb60-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_discrete</span>(<span class="at">name =</span> <span class="st">"Sample size"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb60-63"><a href="#cb60-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-64"><a href="#cb60-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-65"><a href="#cb60-65" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> all_sex_effs_sex_only <span class="sc">%&gt;%</span></span>
<span id="cb60-66"><a href="#cb60-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(heterosc <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb60-67"><a href="#cb60-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sample_size =</span> <span class="fu">factor</span>(sample_size,</span>
<span id="cb60-68"><a href="#cb60-68" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"5M+5F"</span>, <span class="st">"10M+10F"</span>, <span class="st">"50M+50F"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb60-69"><a href="#cb60-69" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sex_eff_size = factor(sex_eff_size,</span></span>
<span id="cb60-70"><a href="#cb60-70" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("none", "small", "large"))) %&gt;%</span></span>
<span id="cb60-71"><a href="#cb60-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb60-72"><a href="#cb60-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb60-73"><a href="#cb60-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> sample_size)) <span class="sc">+</span></span>
<span id="cb60-74"><a href="#cb60-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb60-75"><a href="#cb60-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Statistical power"</span>) <span class="sc">+</span></span>
<span id="cb60-76"><a href="#cb60-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Main treatment effect"</span>) <span class="sc">+</span></span>
<span id="cb60-77"><a href="#cb60-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">name =</span> <span class="st">"Effect"</span>, <span class="at">values =</span> cbb_palette) <span class="sc">+</span></span>
<span id="cb60-78"><a href="#cb60-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_discrete</span>(<span class="at">name =</span> <span class="st">"Sample size"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb60-79"><a href="#cb60-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-80"><a href="#cb60-80" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(plot1, plot2, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">common.legend =</span> <span class="cn">TRUE</span>, <span class="at">legend =</span> <span class="st">"right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Interaction of effect direction present, low (left) and high (right) heteroscedasticity:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>    calc_power_sex_ix_large_lowh_5,</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>    calc_power_sex_ix_large_lowh_10,</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>    calc_power_sex_ix_large_lowh_50,</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>    calc_power_sex_ix_large_largeh_5,</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>    calc_power_sex_ix_large_largeh_10,</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>    calc_power_sex_ix_large_largeh_50</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">lapply</span>(all_sex_effs_sex_only, unlist))</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a><span class="co"># plot1 &lt;- all_sex_effs_sex_only %&gt;%</span></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(Effect %in% c("Treatment")) %&gt;%</span></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(heterosc %in% c("low")) %&gt;%</span></span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sample_size = factor(sample_size,</span></span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("5M+5F", "10M+10F", "50M+50F"))) %&gt;%</span></span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(method = recode(method,</span></span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a><span class="co">#                          "ANOVA" = "Factorial")) %&gt;%</span></span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x = treat_es2, y = p_value, colour = sample_size)) +</span></span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_hline(yintercept = 0.8, linetype = 1, colour = "red") +</span></span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_line() +</span></span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_bw() +</span></span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylab("Statistical power") +</span></span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a><span class="co">#   xlab("Main treatment effect") +</span></span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_colour_manual(name = "Sample size", values = cbb_palette) +</span></span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a><span class="co">#   # scale_linetype_discrete(name = "Heteroscedasticity")  +</span></span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylim(0, 1)</span></span>
<span id="cb61-28"><a href="#cb61-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-29"><a href="#cb61-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-30"><a href="#cb61-30" aria-hidden="true" tabindex="-1"></a><span class="co"># plot2 &lt;- all_sex_effs_sex_only %&gt;%</span></span>
<span id="cb61-31"><a href="#cb61-31" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(Effect %in% c("Treatment")) %&gt;%</span></span>
<span id="cb61-32"><a href="#cb61-32" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(heterosc %in% c("large")) %&gt;%</span></span>
<span id="cb61-33"><a href="#cb61-33" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sample_size = factor(sample_size,</span></span>
<span id="cb61-34"><a href="#cb61-34" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("5M+5F", "10M+10F", "50M+50F"))) %&gt;%</span></span>
<span id="cb61-35"><a href="#cb61-35" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(method = recode(method,</span></span>
<span id="cb61-36"><a href="#cb61-36" aria-hidden="true" tabindex="-1"></a><span class="co">#                          "ANOVA" = "Factorial")) %&gt;%</span></span>
<span id="cb61-37"><a href="#cb61-37" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x = treat_es2, y = p_value, colour = sample_size)) +</span></span>
<span id="cb61-38"><a href="#cb61-38" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_hline(yintercept = 0.8, linetype = 1, colour = "red") +</span></span>
<span id="cb61-39"><a href="#cb61-39" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_line() +</span></span>
<span id="cb61-40"><a href="#cb61-40" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_bw() +</span></span>
<span id="cb61-41"><a href="#cb61-41" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylab("Statistical power") +</span></span>
<span id="cb61-42"><a href="#cb61-42" aria-hidden="true" tabindex="-1"></a><span class="co">#   xlab("Main treatment effect") +</span></span>
<span id="cb61-43"><a href="#cb61-43" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_colour_manual(name = "Sample size", values = cbb_palette) +</span></span>
<span id="cb61-44"><a href="#cb61-44" aria-hidden="true" tabindex="-1"></a><span class="co">#   # scale_linetype_discrete(name = "Heteroscedasticity")  +</span></span>
<span id="cb61-45"><a href="#cb61-45" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylim(0, 1)</span></span>
<span id="cb61-46"><a href="#cb61-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-47"><a href="#cb61-47" aria-hidden="true" tabindex="-1"></a><span class="co"># ggarrange(plot1, plot2, ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")</span></span>
<span id="cb61-48"><a href="#cb61-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-49"><a href="#cb61-49" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> all_sex_effs_sex_only <span class="sc">%&gt;%</span></span>
<span id="cb61-50"><a href="#cb61-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(heterosc <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"low"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb61-51"><a href="#cb61-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sample_size =</span> <span class="fu">factor</span>(sample_size,</span>
<span id="cb61-52"><a href="#cb61-52" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"5M+5F"</span>, <span class="st">"10M+10F"</span>, <span class="st">"50M+50F"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb61-53"><a href="#cb61-53" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sex_eff_size = factor(sex_eff_size,</span></span>
<span id="cb61-54"><a href="#cb61-54" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("none", "small", "large"))) %&gt;%</span></span>
<span id="cb61-55"><a href="#cb61-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb61-56"><a href="#cb61-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb61-57"><a href="#cb61-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> sample_size)) <span class="sc">+</span></span>
<span id="cb61-58"><a href="#cb61-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb61-59"><a href="#cb61-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Statistical power"</span>) <span class="sc">+</span></span>
<span id="cb61-60"><a href="#cb61-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Main treatment effect"</span>) <span class="sc">+</span></span>
<span id="cb61-61"><a href="#cb61-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">name =</span> <span class="st">"Effect"</span>, <span class="at">values =</span> cbb_palette) <span class="sc">+</span></span>
<span id="cb61-62"><a href="#cb61-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_discrete</span>(<span class="at">name =</span> <span class="st">"Sample size"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb61-63"><a href="#cb61-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-64"><a href="#cb61-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-65"><a href="#cb61-65" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> all_sex_effs_sex_only <span class="sc">%&gt;%</span></span>
<span id="cb61-66"><a href="#cb61-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(heterosc <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb61-67"><a href="#cb61-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sample_size =</span> <span class="fu">factor</span>(sample_size,</span>
<span id="cb61-68"><a href="#cb61-68" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"5M+5F"</span>, <span class="st">"10M+10F"</span>, <span class="st">"50M+50F"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb61-69"><a href="#cb61-69" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sex_eff_size = factor(sex_eff_size,</span></span>
<span id="cb61-70"><a href="#cb61-70" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("none", "small", "large"))) %&gt;%</span></span>
<span id="cb61-71"><a href="#cb61-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb61-72"><a href="#cb61-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb61-73"><a href="#cb61-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> sample_size)) <span class="sc">+</span></span>
<span id="cb61-74"><a href="#cb61-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb61-75"><a href="#cb61-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Statistical power"</span>) <span class="sc">+</span></span>
<span id="cb61-76"><a href="#cb61-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Main treatment effect"</span>) <span class="sc">+</span></span>
<span id="cb61-77"><a href="#cb61-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">name =</span> <span class="st">"Effect"</span>, <span class="at">values =</span> cbb_palette) <span class="sc">+</span></span>
<span id="cb61-78"><a href="#cb61-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_discrete</span>(<span class="at">name =</span> <span class="st">"Sample size"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb61-79"><a href="#cb61-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-80"><a href="#cb61-80" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(plot1, plot2, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">common.legend =</span> <span class="cn">TRUE</span>, <span class="at">legend =</span> <span class="st">"right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="simulating-sample-size" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Simulating sample size</h1>
<section id="simulations-assuming-target-power-80" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="simulations-assuming-target-power-80"><span class="header-section-number">5.1</span> Simulations assuming target power = 80%</h2>
<p>Scenario 1: strong sex effect, none to large heteroscedasticity. Assumed power 80% for treatment effect.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>all_effs_sex_large_noh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb62-30"><a href="#cb62-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb62-31"><a href="#cb62-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb62-32"><a href="#cb62-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb62-33"><a href="#cb62-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb62-34"><a href="#cb62-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb62-35"><a href="#cb62-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb62-36"><a href="#cb62-36" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb62-37"><a href="#cb62-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb62-38"><a href="#cb62-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb62-39"><a href="#cb62-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb62-40"><a href="#cb62-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb62-41"><a href="#cb62-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb62-42"><a href="#cb62-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb62-43"><a href="#cb62-43" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb62-44"><a href="#cb62-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb62-45"><a href="#cb62-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb62-46"><a href="#cb62-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb62-47"><a href="#cb62-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb62-48"><a href="#cb62-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb62-49"><a href="#cb62-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb62-50"><a href="#cb62-50" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb62-51"><a href="#cb62-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb62-52"><a href="#cb62-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb62-53"><a href="#cb62-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb62-54"><a href="#cb62-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb62-55"><a href="#cb62-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb62-56"><a href="#cb62-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb62-57"><a href="#cb62-57" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb62-58"><a href="#cb62-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb62-59"><a href="#cb62-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb62-60"><a href="#cb62-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb62-61"><a href="#cb62-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb62-62"><a href="#cb62-62" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb62-63"><a href="#cb62-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb62-64"><a href="#cb62-64" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb62-65"><a href="#cb62-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb62-66"><a href="#cb62-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb62-67"><a href="#cb62-67" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb62-68"><a href="#cb62-68" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb62-69"><a href="#cb62-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb62-70"><a href="#cb62-70" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb62-71"><a href="#cb62-71" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb62-72"><a href="#cb62-72" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb62-73"><a href="#cb62-73" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb62-74"><a href="#cb62-74" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb62-75"><a href="#cb62-75" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb62-76"><a href="#cb62-76" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb62-77"><a href="#cb62-77" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb62-78"><a href="#cb62-78" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb62-79"><a href="#cb62-79" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-80"><a href="#cb62-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-81"><a href="#cb62-81" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large_noh <span class="ot">&lt;-</span> all_effs_sex_large_noh <span class="sc">%&gt;%</span></span>
<span id="cb62-82"><a href="#cb62-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-83"><a href="#cb62-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc, ssize, power) <span class="sc">%&gt;%</span></span>
<span id="cb62-84"><a href="#cb62-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb62-85"><a href="#cb62-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb62-86"><a href="#cb62-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"none"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb62-87"><a href="#cb62-87" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"none"</span>))</span>
<span id="cb62-88"><a href="#cb62-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-89"><a href="#cb62-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-90"><a href="#cb62-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-91"><a href="#cb62-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-92"><a href="#cb62-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-93"><a href="#cb62-93" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb62-94"><a href="#cb62-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-95"><a href="#cb62-95" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb62-96"><a href="#cb62-96" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb62-97"><a href="#cb62-97" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb62-98"><a href="#cb62-98" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb62-99"><a href="#cb62-99" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb62-100"><a href="#cb62-100" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb62-101"><a href="#cb62-101" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb62-102"><a href="#cb62-102" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb62-103"><a href="#cb62-103" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb62-104"><a href="#cb62-104" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb62-105"><a href="#cb62-105" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb62-106"><a href="#cb62-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-107"><a href="#cb62-107" aria-hidden="true" tabindex="-1"></a>all_effs_sex_large_lowh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb62-108"><a href="#cb62-108" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb62-109"><a href="#cb62-109" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb62-110"><a href="#cb62-110" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb62-111"><a href="#cb62-111" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb62-112"><a href="#cb62-112" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb62-113"><a href="#cb62-113" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb62-114"><a href="#cb62-114" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb62-115"><a href="#cb62-115" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb62-116"><a href="#cb62-116" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb62-117"><a href="#cb62-117" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb62-118"><a href="#cb62-118" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb62-119"><a href="#cb62-119" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb62-120"><a href="#cb62-120" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb62-121"><a href="#cb62-121" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb62-122"><a href="#cb62-122" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb62-123"><a href="#cb62-123" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb62-124"><a href="#cb62-124" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb62-125"><a href="#cb62-125" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb62-126"><a href="#cb62-126" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb62-127"><a href="#cb62-127" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb62-128"><a href="#cb62-128" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb62-129"><a href="#cb62-129" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb62-130"><a href="#cb62-130" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb62-131"><a href="#cb62-131" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb62-132"><a href="#cb62-132" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb62-133"><a href="#cb62-133" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb62-134"><a href="#cb62-134" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb62-135"><a href="#cb62-135" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb62-136"><a href="#cb62-136" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb62-137"><a href="#cb62-137" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb62-138"><a href="#cb62-138" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb62-139"><a href="#cb62-139" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb62-140"><a href="#cb62-140" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb62-141"><a href="#cb62-141" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb62-142"><a href="#cb62-142" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb62-143"><a href="#cb62-143" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb62-144"><a href="#cb62-144" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb62-145"><a href="#cb62-145" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb62-146"><a href="#cb62-146" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb62-147"><a href="#cb62-147" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb62-148"><a href="#cb62-148" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb62-149"><a href="#cb62-149" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb62-150"><a href="#cb62-150" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb62-151"><a href="#cb62-151" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb62-152"><a href="#cb62-152" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb62-153"><a href="#cb62-153" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb62-154"><a href="#cb62-154" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb62-155"><a href="#cb62-155" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb62-156"><a href="#cb62-156" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb62-157"><a href="#cb62-157" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb62-158"><a href="#cb62-158" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb62-159"><a href="#cb62-159" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb62-160"><a href="#cb62-160" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb62-161"><a href="#cb62-161" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb62-162"><a href="#cb62-162" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb62-163"><a href="#cb62-163" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb62-164"><a href="#cb62-164" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb62-165"><a href="#cb62-165" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb62-166"><a href="#cb62-166" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb62-167"><a href="#cb62-167" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb62-168"><a href="#cb62-168" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb62-169"><a href="#cb62-169" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb62-170"><a href="#cb62-170" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb62-171"><a href="#cb62-171" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-172"><a href="#cb62-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-173"><a href="#cb62-173" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large_lowh <span class="ot">&lt;-</span> all_effs_sex_large_lowh <span class="sc">%&gt;%</span></span>
<span id="cb62-174"><a href="#cb62-174" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-175"><a href="#cb62-175" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc, ssize, power) <span class="sc">%&gt;%</span></span>
<span id="cb62-176"><a href="#cb62-176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb62-177"><a href="#cb62-177" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb62-178"><a href="#cb62-178" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"none"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb62-179"><a href="#cb62-179" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"low"</span>))</span>
<span id="cb62-180"><a href="#cb62-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-181"><a href="#cb62-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-182"><a href="#cb62-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-183"><a href="#cb62-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-184"><a href="#cb62-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-185"><a href="#cb62-185" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb62-186"><a href="#cb62-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-187"><a href="#cb62-187" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb62-188"><a href="#cb62-188" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb62-189"><a href="#cb62-189" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb62-190"><a href="#cb62-190" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb62-191"><a href="#cb62-191" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb62-192"><a href="#cb62-192" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb62-193"><a href="#cb62-193" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb62-194"><a href="#cb62-194" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb62-195"><a href="#cb62-195" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb62-196"><a href="#cb62-196" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb62-197"><a href="#cb62-197" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb62-198"><a href="#cb62-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-199"><a href="#cb62-199" aria-hidden="true" tabindex="-1"></a>all_effs_sex_large_largeh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb62-200"><a href="#cb62-200" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb62-201"><a href="#cb62-201" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb62-202"><a href="#cb62-202" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb62-203"><a href="#cb62-203" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb62-204"><a href="#cb62-204" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb62-205"><a href="#cb62-205" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb62-206"><a href="#cb62-206" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb62-207"><a href="#cb62-207" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb62-208"><a href="#cb62-208" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb62-209"><a href="#cb62-209" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb62-210"><a href="#cb62-210" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb62-211"><a href="#cb62-211" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb62-212"><a href="#cb62-212" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb62-213"><a href="#cb62-213" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb62-214"><a href="#cb62-214" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb62-215"><a href="#cb62-215" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb62-216"><a href="#cb62-216" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb62-217"><a href="#cb62-217" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb62-218"><a href="#cb62-218" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb62-219"><a href="#cb62-219" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb62-220"><a href="#cb62-220" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb62-221"><a href="#cb62-221" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb62-222"><a href="#cb62-222" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb62-223"><a href="#cb62-223" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb62-224"><a href="#cb62-224" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb62-225"><a href="#cb62-225" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb62-226"><a href="#cb62-226" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb62-227"><a href="#cb62-227" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb62-228"><a href="#cb62-228" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb62-229"><a href="#cb62-229" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb62-230"><a href="#cb62-230" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb62-231"><a href="#cb62-231" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb62-232"><a href="#cb62-232" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb62-233"><a href="#cb62-233" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb62-234"><a href="#cb62-234" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb62-235"><a href="#cb62-235" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb62-236"><a href="#cb62-236" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb62-237"><a href="#cb62-237" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb62-238"><a href="#cb62-238" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb62-239"><a href="#cb62-239" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb62-240"><a href="#cb62-240" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb62-241"><a href="#cb62-241" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb62-242"><a href="#cb62-242" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb62-243"><a href="#cb62-243" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb62-244"><a href="#cb62-244" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb62-245"><a href="#cb62-245" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb62-246"><a href="#cb62-246" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb62-247"><a href="#cb62-247" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb62-248"><a href="#cb62-248" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb62-249"><a href="#cb62-249" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb62-250"><a href="#cb62-250" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb62-251"><a href="#cb62-251" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb62-252"><a href="#cb62-252" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb62-253"><a href="#cb62-253" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb62-254"><a href="#cb62-254" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb62-255"><a href="#cb62-255" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb62-256"><a href="#cb62-256" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb62-257"><a href="#cb62-257" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb62-258"><a href="#cb62-258" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb62-259"><a href="#cb62-259" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb62-260"><a href="#cb62-260" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb62-261"><a href="#cb62-261" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb62-262"><a href="#cb62-262" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb62-263"><a href="#cb62-263" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-264"><a href="#cb62-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-265"><a href="#cb62-265" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large_largeh <span class="ot">&lt;-</span> all_effs_sex_large_largeh <span class="sc">%&gt;%</span></span>
<span id="cb62-266"><a href="#cb62-266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-267"><a href="#cb62-267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc, ssize, power) <span class="sc">%&gt;%</span></span>
<span id="cb62-268"><a href="#cb62-268" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb62-269"><a href="#cb62-269" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb62-270"><a href="#cb62-270" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"none"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb62-271"><a href="#cb62-271" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"large"</span>))</span>
<span id="cb62-272"><a href="#cb62-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-273"><a href="#cb62-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-274"><a href="#cb62-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-275"><a href="#cb62-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-276"><a href="#cb62-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-277"><a href="#cb62-277" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb62-278"><a href="#cb62-278" aria-hidden="true" tabindex="-1"></a>    calc_power_sex_large_noh,</span>
<span id="cb62-279"><a href="#cb62-279" aria-hidden="true" tabindex="-1"></a>    calc_power_sex_large_lowh,</span>
<span id="cb62-280"><a href="#cb62-280" aria-hidden="true" tabindex="-1"></a>    calc_power_sex_large_largeh</span>
<span id="cb62-281"><a href="#cb62-281" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-282"><a href="#cb62-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-283"><a href="#cb62-283" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">lapply</span>(all_sex_effs_sex_only, unlist))</span>
<span id="cb62-284"><a href="#cb62-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-285"><a href="#cb62-285" aria-hidden="true" tabindex="-1"></a><span class="co"># plot1 &lt;- all_sex_effs_sex_only %&gt;%</span></span>
<span id="cb62-286"><a href="#cb62-286" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(Effect %in% c("Treatment")) %&gt;%</span></span>
<span id="cb62-287"><a href="#cb62-287" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(heterosc %in% c("low")) %&gt;%</span></span>
<span id="cb62-288"><a href="#cb62-288" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sample_size = factor(sample_size,</span></span>
<span id="cb62-289"><a href="#cb62-289" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("5M+5F", "10M+10F", "50M+50F"))) %&gt;%</span></span>
<span id="cb62-290"><a href="#cb62-290" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(method = recode(method,</span></span>
<span id="cb62-291"><a href="#cb62-291" aria-hidden="true" tabindex="-1"></a><span class="co">#                          "ANOVA" = "Factorial")) %&gt;%</span></span>
<span id="cb62-292"><a href="#cb62-292" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x = treat_es2, y = p_value, colour = sample_size)) +</span></span>
<span id="cb62-293"><a href="#cb62-293" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_hline(yintercept = 0.8, linetype = 1, colour = "red") +</span></span>
<span id="cb62-294"><a href="#cb62-294" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_line() +</span></span>
<span id="cb62-295"><a href="#cb62-295" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_bw() +</span></span>
<span id="cb62-296"><a href="#cb62-296" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylab("Statistical power") +</span></span>
<span id="cb62-297"><a href="#cb62-297" aria-hidden="true" tabindex="-1"></a><span class="co">#   xlab("Main treatment effect") +</span></span>
<span id="cb62-298"><a href="#cb62-298" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_colour_manual(name = "Sample size", values = cbb_palette) +</span></span>
<span id="cb62-299"><a href="#cb62-299" aria-hidden="true" tabindex="-1"></a><span class="co">#   # scale_linetype_discrete(name = "Heteroscedasticity")  +</span></span>
<span id="cb62-300"><a href="#cb62-300" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylim(0, 1)</span></span>
<span id="cb62-301"><a href="#cb62-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-302"><a href="#cb62-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-303"><a href="#cb62-303" aria-hidden="true" tabindex="-1"></a><span class="co"># plot2 &lt;- all_sex_effs_sex_only %&gt;%</span></span>
<span id="cb62-304"><a href="#cb62-304" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(Effect %in% c("Treatment")) %&gt;%</span></span>
<span id="cb62-305"><a href="#cb62-305" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(heterosc %in% c("large")) %&gt;%</span></span>
<span id="cb62-306"><a href="#cb62-306" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sample_size = factor(sample_size,</span></span>
<span id="cb62-307"><a href="#cb62-307" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("5M+5F", "10M+10F", "50M+50F"))) %&gt;%</span></span>
<span id="cb62-308"><a href="#cb62-308" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(method = recode(method,</span></span>
<span id="cb62-309"><a href="#cb62-309" aria-hidden="true" tabindex="-1"></a><span class="co">#                          "ANOVA" = "Factorial")) %&gt;%</span></span>
<span id="cb62-310"><a href="#cb62-310" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x = treat_es2, y = p_value, colour = sample_size)) +</span></span>
<span id="cb62-311"><a href="#cb62-311" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_hline(yintercept = 0.8, linetype = 1, colour = "red") +</span></span>
<span id="cb62-312"><a href="#cb62-312" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_line() +</span></span>
<span id="cb62-313"><a href="#cb62-313" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_bw() +</span></span>
<span id="cb62-314"><a href="#cb62-314" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylab("Statistical power") +</span></span>
<span id="cb62-315"><a href="#cb62-315" aria-hidden="true" tabindex="-1"></a><span class="co">#   xlab("Main treatment effect") +</span></span>
<span id="cb62-316"><a href="#cb62-316" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_colour_manual(name = "Sample size", values = cbb_palette) +</span></span>
<span id="cb62-317"><a href="#cb62-317" aria-hidden="true" tabindex="-1"></a><span class="co">#   # scale_linetype_discrete(name = "Heteroscedasticity")  +</span></span>
<span id="cb62-318"><a href="#cb62-318" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylim(0, 1)</span></span>
<span id="cb62-319"><a href="#cb62-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-320"><a href="#cb62-320" aria-hidden="true" tabindex="-1"></a><span class="co"># ggarrange(plot1, plot2, ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")</span></span>
<span id="cb62-321"><a href="#cb62-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-322"><a href="#cb62-322" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> all_sex_effs_sex_only <span class="sc">%&gt;%</span></span>
<span id="cb62-323"><a href="#cb62-323" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(heterosc %in% c("low")) %&gt;%</span></span>
<span id="cb62-324"><a href="#cb62-324" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sample_size = factor(sample_size,</span></span>
<span id="cb62-325"><a href="#cb62-325" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("5M+5F", "10M+10F", "50M+50F"))) %&gt;%</span></span>
<span id="cb62-326"><a href="#cb62-326" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sex_eff_size = factor(sex_eff_size,</span></span>
<span id="cb62-327"><a href="#cb62-327" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("none", "small", "large"))) %&gt;%</span></span>
<span id="cb62-328"><a href="#cb62-328" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> ssize, <span class="at">colour =</span> heterosc)) <span class="sc">+</span></span>
<span id="cb62-329"><a href="#cb62-329" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_hline(yintercept = 0.8, linetype = 1, colour = "red") +</span></span>
<span id="cb62-330"><a href="#cb62-330" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb62-331"><a href="#cb62-331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb62-332"><a href="#cb62-332" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Sample size"</span>) <span class="sc">+</span></span>
<span id="cb62-333"><a href="#cb62-333" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Main treatment effect"</span>) <span class="sc">+</span></span>
<span id="cb62-334"><a href="#cb62-334" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">name =</span> <span class="st">"Heteroscedasticity"</span>, <span class="at">values =</span> cbb_palette) <span class="sc">+</span> <span class="fu">coord_trans</span>(<span class="at">y =</span> <span class="st">"log10"</span>) <span class="sc">+</span></span>
<span id="cb62-335"><a href="#cb62-335" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">15</span>))</span>
<span id="cb62-336"><a href="#cb62-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-337"><a href="#cb62-337" aria-hidden="true" tabindex="-1"></a><span class="co"># plot1</span></span>
<span id="cb62-338"><a href="#cb62-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-339"><a href="#cb62-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-340"><a href="#cb62-340" aria-hidden="true" tabindex="-1"></a>plot1<span class="fl">.1</span> <span class="ot">&lt;-</span> all_sex_effs_sex_only <span class="sc">%&gt;%</span></span>
<span id="cb62-341"><a href="#cb62-341" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(heterosc %in% c("low")) %&gt;%</span></span>
<span id="cb62-342"><a href="#cb62-342" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sample_size = factor(sample_size,</span></span>
<span id="cb62-343"><a href="#cb62-343" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("5M+5F", "10M+10F", "50M+50F"))) %&gt;%</span></span>
<span id="cb62-344"><a href="#cb62-344" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sex_eff_size = factor(sex_eff_size,</span></span>
<span id="cb62-345"><a href="#cb62-345" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("none", "small", "large"))) %&gt;%</span></span>
<span id="cb62-346"><a href="#cb62-346" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> ssize, <span class="at">linetype =</span> heterosc)) <span class="sc">+</span></span>
<span id="cb62-347"><a href="#cb62-347" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_hline(yintercept = 0.8, linetype = 1, colour = "red") +</span></span>
<span id="cb62-348"><a href="#cb62-348" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb62-349"><a href="#cb62-349" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb62-350"><a href="#cb62-350" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Sample size"</span>) <span class="sc">+</span></span>
<span id="cb62-351"><a href="#cb62-351" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Main treatment effect"</span>) <span class="sc">+</span></span>
<span id="cb62-352"><a href="#cb62-352" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">linetype =</span> <span class="st">"Heteroscedasticity"</span>) <span class="sc">+</span></span>
<span id="cb62-353"><a href="#cb62-353" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_colour_manual(name = "Heteroscedasticity", values = cbb_palette) +</span></span>
<span id="cb62-354"><a href="#cb62-354" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fl">0.3</span>, <span class="fl">0.7</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">5</span>, <span class="dv">70</span>)</span>
<span id="cb62-355"><a href="#cb62-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-356"><a href="#cb62-356" aria-hidden="true" tabindex="-1"></a><span class="co"># plot1.1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Scenario 2: same but interaction of magnitude with more variable sex responding more strongly to the treatment.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>all_effs_sex_large_noh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb63-32"><a href="#cb63-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb63-33"><a href="#cb63-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb63-34"><a href="#cb63-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb63-35"><a href="#cb63-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb63-36"><a href="#cb63-36" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb63-37"><a href="#cb63-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb63-38"><a href="#cb63-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb63-39"><a href="#cb63-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb63-40"><a href="#cb63-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb63-41"><a href="#cb63-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb63-42"><a href="#cb63-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb63-43"><a href="#cb63-43" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb63-44"><a href="#cb63-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb63-45"><a href="#cb63-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb63-46"><a href="#cb63-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb63-47"><a href="#cb63-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb63-48"><a href="#cb63-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb63-49"><a href="#cb63-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb63-50"><a href="#cb63-50" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb63-51"><a href="#cb63-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb63-52"><a href="#cb63-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb63-53"><a href="#cb63-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb63-54"><a href="#cb63-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb63-55"><a href="#cb63-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb63-56"><a href="#cb63-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb63-57"><a href="#cb63-57" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb63-58"><a href="#cb63-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb63-59"><a href="#cb63-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb63-60"><a href="#cb63-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb63-61"><a href="#cb63-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb63-62"><a href="#cb63-62" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb63-63"><a href="#cb63-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb63-64"><a href="#cb63-64" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb63-65"><a href="#cb63-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb63-66"><a href="#cb63-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb63-67"><a href="#cb63-67" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb63-68"><a href="#cb63-68" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb63-69"><a href="#cb63-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb63-70"><a href="#cb63-70" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb63-71"><a href="#cb63-71" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb63-72"><a href="#cb63-72" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb63-73"><a href="#cb63-73" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb63-74"><a href="#cb63-74" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb63-75"><a href="#cb63-75" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb63-76"><a href="#cb63-76" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb63-77"><a href="#cb63-77" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb63-78"><a href="#cb63-78" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb63-79"><a href="#cb63-79" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb63-80"><a href="#cb63-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-81"><a href="#cb63-81" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large_noh <span class="ot">&lt;-</span> all_effs_sex_large_noh <span class="sc">%&gt;%</span></span>
<span id="cb63-82"><a href="#cb63-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-83"><a href="#cb63-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc, ssize, power) <span class="sc">%&gt;%</span></span>
<span id="cb63-84"><a href="#cb63-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb63-85"><a href="#cb63-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb63-86"><a href="#cb63-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"none"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb63-87"><a href="#cb63-87" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"none"</span>))</span>
<span id="cb63-88"><a href="#cb63-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-89"><a href="#cb63-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-90"><a href="#cb63-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-91"><a href="#cb63-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-92"><a href="#cb63-92" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb63-93"><a href="#cb63-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-94"><a href="#cb63-94" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb63-95"><a href="#cb63-95" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb63-96"><a href="#cb63-96" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb63-97"><a href="#cb63-97" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb63-98"><a href="#cb63-98" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb63-99"><a href="#cb63-99" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb63-100"><a href="#cb63-100" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb63-101"><a href="#cb63-101" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb63-102"><a href="#cb63-102" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb63-103"><a href="#cb63-103" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb63-104"><a href="#cb63-104" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb63-105"><a href="#cb63-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-106"><a href="#cb63-106" aria-hidden="true" tabindex="-1"></a>all_effs_sex_large_lowh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb63-107"><a href="#cb63-107" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb63-108"><a href="#cb63-108" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb63-109"><a href="#cb63-109" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb63-110"><a href="#cb63-110" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb63-111"><a href="#cb63-111" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb63-112"><a href="#cb63-112" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb63-113"><a href="#cb63-113" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb63-114"><a href="#cb63-114" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb63-115"><a href="#cb63-115" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb63-116"><a href="#cb63-116" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb63-117"><a href="#cb63-117" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb63-118"><a href="#cb63-118" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb63-119"><a href="#cb63-119" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb63-120"><a href="#cb63-120" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb63-121"><a href="#cb63-121" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb63-122"><a href="#cb63-122" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb63-123"><a href="#cb63-123" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb63-124"><a href="#cb63-124" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb63-125"><a href="#cb63-125" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb63-126"><a href="#cb63-126" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb63-127"><a href="#cb63-127" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb63-128"><a href="#cb63-128" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb63-129"><a href="#cb63-129" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb63-130"><a href="#cb63-130" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb63-131"><a href="#cb63-131" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb63-132"><a href="#cb63-132" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb63-133"><a href="#cb63-133" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb63-134"><a href="#cb63-134" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb63-135"><a href="#cb63-135" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb63-136"><a href="#cb63-136" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb63-137"><a href="#cb63-137" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb63-138"><a href="#cb63-138" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb63-139"><a href="#cb63-139" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb63-140"><a href="#cb63-140" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb63-141"><a href="#cb63-141" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb63-142"><a href="#cb63-142" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb63-143"><a href="#cb63-143" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb63-144"><a href="#cb63-144" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb63-145"><a href="#cb63-145" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb63-146"><a href="#cb63-146" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb63-147"><a href="#cb63-147" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb63-148"><a href="#cb63-148" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb63-149"><a href="#cb63-149" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb63-150"><a href="#cb63-150" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb63-151"><a href="#cb63-151" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb63-152"><a href="#cb63-152" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb63-153"><a href="#cb63-153" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb63-154"><a href="#cb63-154" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb63-155"><a href="#cb63-155" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb63-156"><a href="#cb63-156" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb63-157"><a href="#cb63-157" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb63-158"><a href="#cb63-158" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb63-159"><a href="#cb63-159" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb63-160"><a href="#cb63-160" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb63-161"><a href="#cb63-161" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb63-162"><a href="#cb63-162" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb63-163"><a href="#cb63-163" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb63-164"><a href="#cb63-164" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb63-165"><a href="#cb63-165" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb63-166"><a href="#cb63-166" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb63-167"><a href="#cb63-167" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb63-168"><a href="#cb63-168" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb63-169"><a href="#cb63-169" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb63-170"><a href="#cb63-170" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb63-171"><a href="#cb63-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-172"><a href="#cb63-172" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large_lowh <span class="ot">&lt;-</span> all_effs_sex_large_lowh <span class="sc">%&gt;%</span></span>
<span id="cb63-173"><a href="#cb63-173" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-174"><a href="#cb63-174" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc, ssize, power) <span class="sc">%&gt;%</span></span>
<span id="cb63-175"><a href="#cb63-175" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb63-176"><a href="#cb63-176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb63-177"><a href="#cb63-177" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"none"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb63-178"><a href="#cb63-178" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"low"</span>))</span>
<span id="cb63-179"><a href="#cb63-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-180"><a href="#cb63-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-181"><a href="#cb63-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-182"><a href="#cb63-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-183"><a href="#cb63-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-184"><a href="#cb63-184" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb63-185"><a href="#cb63-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-186"><a href="#cb63-186" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb63-187"><a href="#cb63-187" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb63-188"><a href="#cb63-188" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb63-189"><a href="#cb63-189" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb63-190"><a href="#cb63-190" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb63-191"><a href="#cb63-191" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb63-192"><a href="#cb63-192" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb63-193"><a href="#cb63-193" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb63-194"><a href="#cb63-194" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb63-195"><a href="#cb63-195" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb63-196"><a href="#cb63-196" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb63-197"><a href="#cb63-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-198"><a href="#cb63-198" aria-hidden="true" tabindex="-1"></a>all_effs_sex_large_largeh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb63-199"><a href="#cb63-199" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb63-200"><a href="#cb63-200" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb63-201"><a href="#cb63-201" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb63-202"><a href="#cb63-202" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb63-203"><a href="#cb63-203" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb63-204"><a href="#cb63-204" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb63-205"><a href="#cb63-205" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb63-206"><a href="#cb63-206" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb63-207"><a href="#cb63-207" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb63-208"><a href="#cb63-208" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb63-209"><a href="#cb63-209" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb63-210"><a href="#cb63-210" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb63-211"><a href="#cb63-211" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb63-212"><a href="#cb63-212" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb63-213"><a href="#cb63-213" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb63-214"><a href="#cb63-214" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb63-215"><a href="#cb63-215" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb63-216"><a href="#cb63-216" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb63-217"><a href="#cb63-217" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb63-218"><a href="#cb63-218" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb63-219"><a href="#cb63-219" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb63-220"><a href="#cb63-220" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb63-221"><a href="#cb63-221" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb63-222"><a href="#cb63-222" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb63-223"><a href="#cb63-223" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb63-224"><a href="#cb63-224" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb63-225"><a href="#cb63-225" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb63-226"><a href="#cb63-226" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb63-227"><a href="#cb63-227" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb63-228"><a href="#cb63-228" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb63-229"><a href="#cb63-229" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb63-230"><a href="#cb63-230" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb63-231"><a href="#cb63-231" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb63-232"><a href="#cb63-232" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb63-233"><a href="#cb63-233" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb63-234"><a href="#cb63-234" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb63-235"><a href="#cb63-235" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb63-236"><a href="#cb63-236" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb63-237"><a href="#cb63-237" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb63-238"><a href="#cb63-238" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb63-239"><a href="#cb63-239" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb63-240"><a href="#cb63-240" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb63-241"><a href="#cb63-241" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb63-242"><a href="#cb63-242" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb63-243"><a href="#cb63-243" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb63-244"><a href="#cb63-244" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb63-245"><a href="#cb63-245" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb63-246"><a href="#cb63-246" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb63-247"><a href="#cb63-247" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb63-248"><a href="#cb63-248" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb63-249"><a href="#cb63-249" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb63-250"><a href="#cb63-250" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb63-251"><a href="#cb63-251" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb63-252"><a href="#cb63-252" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb63-253"><a href="#cb63-253" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb63-254"><a href="#cb63-254" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb63-255"><a href="#cb63-255" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb63-256"><a href="#cb63-256" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb63-257"><a href="#cb63-257" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb63-258"><a href="#cb63-258" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb63-259"><a href="#cb63-259" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb63-260"><a href="#cb63-260" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb63-261"><a href="#cb63-261" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb63-262"><a href="#cb63-262" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb63-263"><a href="#cb63-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-264"><a href="#cb63-264" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large_largeh <span class="ot">&lt;-</span> all_effs_sex_large_largeh <span class="sc">%&gt;%</span></span>
<span id="cb63-265"><a href="#cb63-265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-266"><a href="#cb63-266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc, ssize, power) <span class="sc">%&gt;%</span></span>
<span id="cb63-267"><a href="#cb63-267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb63-268"><a href="#cb63-268" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb63-269"><a href="#cb63-269" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"none"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb63-270"><a href="#cb63-270" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"large"</span>))</span>
<span id="cb63-271"><a href="#cb63-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-272"><a href="#cb63-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-273"><a href="#cb63-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-274"><a href="#cb63-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-275"><a href="#cb63-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-276"><a href="#cb63-276" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb63-277"><a href="#cb63-277" aria-hidden="true" tabindex="-1"></a>    calc_power_sex_large_noh,</span>
<span id="cb63-278"><a href="#cb63-278" aria-hidden="true" tabindex="-1"></a>    calc_power_sex_large_lowh,</span>
<span id="cb63-279"><a href="#cb63-279" aria-hidden="true" tabindex="-1"></a>    calc_power_sex_large_largeh</span>
<span id="cb63-280"><a href="#cb63-280" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb63-281"><a href="#cb63-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-282"><a href="#cb63-282" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">lapply</span>(all_sex_effs_sex_only, unlist))</span>
<span id="cb63-283"><a href="#cb63-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-284"><a href="#cb63-284" aria-hidden="true" tabindex="-1"></a><span class="co"># plot1 &lt;- all_sex_effs_sex_only %&gt;%</span></span>
<span id="cb63-285"><a href="#cb63-285" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(Effect %in% c("Treatment")) %&gt;%</span></span>
<span id="cb63-286"><a href="#cb63-286" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(heterosc %in% c("low")) %&gt;%</span></span>
<span id="cb63-287"><a href="#cb63-287" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sample_size = factor(sample_size,</span></span>
<span id="cb63-288"><a href="#cb63-288" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("5M+5F", "10M+10F", "50M+50F"))) %&gt;%</span></span>
<span id="cb63-289"><a href="#cb63-289" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(method = recode(method,</span></span>
<span id="cb63-290"><a href="#cb63-290" aria-hidden="true" tabindex="-1"></a><span class="co">#                          "ANOVA" = "Factorial")) %&gt;%</span></span>
<span id="cb63-291"><a href="#cb63-291" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x = treat_es2, y = p_value, colour = sample_size)) +</span></span>
<span id="cb63-292"><a href="#cb63-292" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_hline(yintercept = 0.8, linetype = 1, colour = "red") +</span></span>
<span id="cb63-293"><a href="#cb63-293" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_line() +</span></span>
<span id="cb63-294"><a href="#cb63-294" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_bw() +</span></span>
<span id="cb63-295"><a href="#cb63-295" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylab("Statistical power") +</span></span>
<span id="cb63-296"><a href="#cb63-296" aria-hidden="true" tabindex="-1"></a><span class="co">#   xlab("Main treatment effect") +</span></span>
<span id="cb63-297"><a href="#cb63-297" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_colour_manual(name = "Sample size", values = cbb_palette) +</span></span>
<span id="cb63-298"><a href="#cb63-298" aria-hidden="true" tabindex="-1"></a><span class="co">#   # scale_linetype_discrete(name = "Heteroscedasticity")  +</span></span>
<span id="cb63-299"><a href="#cb63-299" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylim(0, 1)</span></span>
<span id="cb63-300"><a href="#cb63-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-301"><a href="#cb63-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-302"><a href="#cb63-302" aria-hidden="true" tabindex="-1"></a><span class="co"># plot2 &lt;- all_sex_effs_sex_only %&gt;%</span></span>
<span id="cb63-303"><a href="#cb63-303" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(Effect %in% c("Treatment")) %&gt;%</span></span>
<span id="cb63-304"><a href="#cb63-304" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(heterosc %in% c("large")) %&gt;%</span></span>
<span id="cb63-305"><a href="#cb63-305" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sample_size = factor(sample_size,</span></span>
<span id="cb63-306"><a href="#cb63-306" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("5M+5F", "10M+10F", "50M+50F"))) %&gt;%</span></span>
<span id="cb63-307"><a href="#cb63-307" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(method = recode(method,</span></span>
<span id="cb63-308"><a href="#cb63-308" aria-hidden="true" tabindex="-1"></a><span class="co">#                          "ANOVA" = "Factorial")) %&gt;%</span></span>
<span id="cb63-309"><a href="#cb63-309" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x = treat_es2, y = p_value, colour = sample_size)) +</span></span>
<span id="cb63-310"><a href="#cb63-310" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_hline(yintercept = 0.8, linetype = 1, colour = "red") +</span></span>
<span id="cb63-311"><a href="#cb63-311" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_line() +</span></span>
<span id="cb63-312"><a href="#cb63-312" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_bw() +</span></span>
<span id="cb63-313"><a href="#cb63-313" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylab("Statistical power") +</span></span>
<span id="cb63-314"><a href="#cb63-314" aria-hidden="true" tabindex="-1"></a><span class="co">#   xlab("Main treatment effect") +</span></span>
<span id="cb63-315"><a href="#cb63-315" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_colour_manual(name = "Sample size", values = cbb_palette) +</span></span>
<span id="cb63-316"><a href="#cb63-316" aria-hidden="true" tabindex="-1"></a><span class="co">#   # scale_linetype_discrete(name = "Heteroscedasticity")  +</span></span>
<span id="cb63-317"><a href="#cb63-317" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylim(0, 1)</span></span>
<span id="cb63-318"><a href="#cb63-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-319"><a href="#cb63-319" aria-hidden="true" tabindex="-1"></a><span class="co"># ggarrange(plot1, plot2, ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")</span></span>
<span id="cb63-320"><a href="#cb63-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-321"><a href="#cb63-321" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> all_sex_effs_sex_only <span class="sc">%&gt;%</span></span>
<span id="cb63-322"><a href="#cb63-322" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(heterosc %in% c("low")) %&gt;%</span></span>
<span id="cb63-323"><a href="#cb63-323" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sample_size = factor(sample_size,</span></span>
<span id="cb63-324"><a href="#cb63-324" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("5M+5F", "10M+10F", "50M+50F"))) %&gt;%</span></span>
<span id="cb63-325"><a href="#cb63-325" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sex_eff_size = factor(sex_eff_size,</span></span>
<span id="cb63-326"><a href="#cb63-326" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("none", "small", "large"))) %&gt;%</span></span>
<span id="cb63-327"><a href="#cb63-327" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> ssize, <span class="at">colour =</span> heterosc)) <span class="sc">+</span></span>
<span id="cb63-328"><a href="#cb63-328" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_hline(yintercept = 0.8, linetype = 1, colour = "red") +</span></span>
<span id="cb63-329"><a href="#cb63-329" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb63-330"><a href="#cb63-330" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb63-331"><a href="#cb63-331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Sample size"</span>) <span class="sc">+</span></span>
<span id="cb63-332"><a href="#cb63-332" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Main treatment effect"</span>) <span class="sc">+</span></span>
<span id="cb63-333"><a href="#cb63-333" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">name =</span> <span class="st">"Effect"</span>, <span class="at">values =</span> cbb_palette) <span class="sc">+</span> <span class="fu">coord_trans</span>(<span class="at">y =</span> <span class="st">"log10"</span>) <span class="sc">+</span></span>
<span id="cb63-334"><a href="#cb63-334" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">15</span>))</span>
<span id="cb63-335"><a href="#cb63-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-336"><a href="#cb63-336" aria-hidden="true" tabindex="-1"></a><span class="co"># plot2</span></span>
<span id="cb63-337"><a href="#cb63-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-338"><a href="#cb63-338" aria-hidden="true" tabindex="-1"></a>plot2<span class="fl">.1</span> <span class="ot">&lt;-</span> all_sex_effs_sex_only <span class="sc">%&gt;%</span></span>
<span id="cb63-339"><a href="#cb63-339" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(heterosc %in% c("low")) %&gt;%</span></span>
<span id="cb63-340"><a href="#cb63-340" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sample_size = factor(sample_size,</span></span>
<span id="cb63-341"><a href="#cb63-341" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("5M+5F", "10M+10F", "50M+50F"))) %&gt;%</span></span>
<span id="cb63-342"><a href="#cb63-342" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sex_eff_size = factor(sex_eff_size,</span></span>
<span id="cb63-343"><a href="#cb63-343" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("none", "small", "large"))) %&gt;%</span></span>
<span id="cb63-344"><a href="#cb63-344" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> ssize, <span class="at">linetype =</span> heterosc)) <span class="sc">+</span></span>
<span id="cb63-345"><a href="#cb63-345" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_hline(yintercept = 0.8, linetype = 1, colour = "red") +</span></span>
<span id="cb63-346"><a href="#cb63-346" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb63-347"><a href="#cb63-347" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb63-348"><a href="#cb63-348" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Sample size"</span>) <span class="sc">+</span></span>
<span id="cb63-349"><a href="#cb63-349" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Main treatment effect"</span>) <span class="sc">+</span></span>
<span id="cb63-350"><a href="#cb63-350" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">linetype =</span> <span class="st">"Heteroscedasticity"</span>) <span class="sc">+</span></span>
<span id="cb63-351"><a href="#cb63-351" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_colour_manual(name = "Heteroscedasticity", values = cbb_palette) +</span></span>
<span id="cb63-352"><a href="#cb63-352" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fl">0.3</span>, <span class="fl">0.7</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">5</span>, <span class="dv">25</span>)</span>
<span id="cb63-353"><a href="#cb63-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-354"><a href="#cb63-354" aria-hidden="true" tabindex="-1"></a><span class="co"># plot2.1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Scenario 3: same as no. 1 but with interaction of magnitude present, with the less variable group responding more strongly to the treatment.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.5</span></span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>all_effs_sex_large_noh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb64-25"><a href="#cb64-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb64-26"><a href="#cb64-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb64-27"><a href="#cb64-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb64-28"><a href="#cb64-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb64-29"><a href="#cb64-29" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb64-30"><a href="#cb64-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb64-31"><a href="#cb64-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb64-32"><a href="#cb64-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb64-33"><a href="#cb64-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb64-34"><a href="#cb64-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb64-35"><a href="#cb64-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb64-36"><a href="#cb64-36" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb64-37"><a href="#cb64-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb64-38"><a href="#cb64-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb64-39"><a href="#cb64-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb64-40"><a href="#cb64-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb64-41"><a href="#cb64-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb64-42"><a href="#cb64-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb64-43"><a href="#cb64-43" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb64-44"><a href="#cb64-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb64-45"><a href="#cb64-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb64-46"><a href="#cb64-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb64-47"><a href="#cb64-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb64-48"><a href="#cb64-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb64-49"><a href="#cb64-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb64-50"><a href="#cb64-50" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb64-51"><a href="#cb64-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb64-52"><a href="#cb64-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb64-53"><a href="#cb64-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb64-54"><a href="#cb64-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb64-55"><a href="#cb64-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb64-56"><a href="#cb64-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb64-57"><a href="#cb64-57" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb64-58"><a href="#cb64-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb64-59"><a href="#cb64-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb64-60"><a href="#cb64-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb64-61"><a href="#cb64-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb64-62"><a href="#cb64-62" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb64-63"><a href="#cb64-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb64-64"><a href="#cb64-64" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb64-65"><a href="#cb64-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb64-66"><a href="#cb64-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb64-67"><a href="#cb64-67" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb64-68"><a href="#cb64-68" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb64-69"><a href="#cb64-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb64-70"><a href="#cb64-70" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb64-71"><a href="#cb64-71" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb64-72"><a href="#cb64-72" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb64-73"><a href="#cb64-73" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb64-74"><a href="#cb64-74" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb64-75"><a href="#cb64-75" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb64-76"><a href="#cb64-76" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb64-77"><a href="#cb64-77" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb64-78"><a href="#cb64-78" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb64-79"><a href="#cb64-79" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb64-80"><a href="#cb64-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-81"><a href="#cb64-81" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large_noh <span class="ot">&lt;-</span> all_effs_sex_large_noh <span class="sc">%&gt;%</span></span>
<span id="cb64-82"><a href="#cb64-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-83"><a href="#cb64-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc, ssize, power) <span class="sc">%&gt;%</span></span>
<span id="cb64-84"><a href="#cb64-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb64-85"><a href="#cb64-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb64-86"><a href="#cb64-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"none"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb64-87"><a href="#cb64-87" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"none"</span>))</span>
<span id="cb64-88"><a href="#cb64-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-89"><a href="#cb64-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-90"><a href="#cb64-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-91"><a href="#cb64-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-92"><a href="#cb64-92" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb64-93"><a href="#cb64-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-94"><a href="#cb64-94" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb64-95"><a href="#cb64-95" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb64-96"><a href="#cb64-96" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb64-97"><a href="#cb64-97" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb64-98"><a href="#cb64-98" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb64-99"><a href="#cb64-99" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb64-100"><a href="#cb64-100" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb64-101"><a href="#cb64-101" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb64-102"><a href="#cb64-102" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb64-103"><a href="#cb64-103" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.5</span></span>
<span id="cb64-104"><a href="#cb64-104" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb64-105"><a href="#cb64-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-106"><a href="#cb64-106" aria-hidden="true" tabindex="-1"></a>all_effs_sex_large_lowh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb64-107"><a href="#cb64-107" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb64-108"><a href="#cb64-108" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb64-109"><a href="#cb64-109" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb64-110"><a href="#cb64-110" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb64-111"><a href="#cb64-111" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb64-112"><a href="#cb64-112" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb64-113"><a href="#cb64-113" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb64-114"><a href="#cb64-114" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb64-115"><a href="#cb64-115" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb64-116"><a href="#cb64-116" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb64-117"><a href="#cb64-117" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb64-118"><a href="#cb64-118" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb64-119"><a href="#cb64-119" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb64-120"><a href="#cb64-120" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb64-121"><a href="#cb64-121" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb64-122"><a href="#cb64-122" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb64-123"><a href="#cb64-123" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb64-124"><a href="#cb64-124" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb64-125"><a href="#cb64-125" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb64-126"><a href="#cb64-126" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb64-127"><a href="#cb64-127" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb64-128"><a href="#cb64-128" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb64-129"><a href="#cb64-129" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb64-130"><a href="#cb64-130" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb64-131"><a href="#cb64-131" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb64-132"><a href="#cb64-132" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb64-133"><a href="#cb64-133" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb64-134"><a href="#cb64-134" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb64-135"><a href="#cb64-135" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb64-136"><a href="#cb64-136" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb64-137"><a href="#cb64-137" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb64-138"><a href="#cb64-138" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb64-139"><a href="#cb64-139" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb64-140"><a href="#cb64-140" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb64-141"><a href="#cb64-141" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb64-142"><a href="#cb64-142" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb64-143"><a href="#cb64-143" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb64-144"><a href="#cb64-144" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb64-145"><a href="#cb64-145" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb64-146"><a href="#cb64-146" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb64-147"><a href="#cb64-147" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb64-148"><a href="#cb64-148" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb64-149"><a href="#cb64-149" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb64-150"><a href="#cb64-150" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb64-151"><a href="#cb64-151" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb64-152"><a href="#cb64-152" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb64-153"><a href="#cb64-153" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb64-154"><a href="#cb64-154" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb64-155"><a href="#cb64-155" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb64-156"><a href="#cb64-156" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb64-157"><a href="#cb64-157" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb64-158"><a href="#cb64-158" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb64-159"><a href="#cb64-159" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb64-160"><a href="#cb64-160" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb64-161"><a href="#cb64-161" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb64-162"><a href="#cb64-162" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb64-163"><a href="#cb64-163" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb64-164"><a href="#cb64-164" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb64-165"><a href="#cb64-165" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb64-166"><a href="#cb64-166" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb64-167"><a href="#cb64-167" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb64-168"><a href="#cb64-168" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb64-169"><a href="#cb64-169" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb64-170"><a href="#cb64-170" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb64-171"><a href="#cb64-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-172"><a href="#cb64-172" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large_lowh <span class="ot">&lt;-</span> all_effs_sex_large_lowh <span class="sc">%&gt;%</span></span>
<span id="cb64-173"><a href="#cb64-173" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-174"><a href="#cb64-174" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc, ssize, power) <span class="sc">%&gt;%</span></span>
<span id="cb64-175"><a href="#cb64-175" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb64-176"><a href="#cb64-176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb64-177"><a href="#cb64-177" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"none"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb64-178"><a href="#cb64-178" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"low"</span>))</span>
<span id="cb64-179"><a href="#cb64-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-180"><a href="#cb64-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-181"><a href="#cb64-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-182"><a href="#cb64-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-183"><a href="#cb64-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-184"><a href="#cb64-184" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb64-185"><a href="#cb64-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-186"><a href="#cb64-186" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb64-187"><a href="#cb64-187" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb64-188"><a href="#cb64-188" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb64-189"><a href="#cb64-189" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb64-190"><a href="#cb64-190" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb64-191"><a href="#cb64-191" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb64-192"><a href="#cb64-192" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb64-193"><a href="#cb64-193" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb64-194"><a href="#cb64-194" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb64-195"><a href="#cb64-195" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.5</span></span>
<span id="cb64-196"><a href="#cb64-196" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb64-197"><a href="#cb64-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-198"><a href="#cb64-198" aria-hidden="true" tabindex="-1"></a>all_effs_sex_large_largeh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb64-199"><a href="#cb64-199" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb64-200"><a href="#cb64-200" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb64-201"><a href="#cb64-201" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb64-202"><a href="#cb64-202" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb64-203"><a href="#cb64-203" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb64-204"><a href="#cb64-204" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb64-205"><a href="#cb64-205" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb64-206"><a href="#cb64-206" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb64-207"><a href="#cb64-207" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb64-208"><a href="#cb64-208" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb64-209"><a href="#cb64-209" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb64-210"><a href="#cb64-210" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb64-211"><a href="#cb64-211" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb64-212"><a href="#cb64-212" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb64-213"><a href="#cb64-213" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb64-214"><a href="#cb64-214" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb64-215"><a href="#cb64-215" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb64-216"><a href="#cb64-216" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb64-217"><a href="#cb64-217" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb64-218"><a href="#cb64-218" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb64-219"><a href="#cb64-219" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb64-220"><a href="#cb64-220" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb64-221"><a href="#cb64-221" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb64-222"><a href="#cb64-222" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb64-223"><a href="#cb64-223" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb64-224"><a href="#cb64-224" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb64-225"><a href="#cb64-225" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb64-226"><a href="#cb64-226" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb64-227"><a href="#cb64-227" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb64-228"><a href="#cb64-228" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb64-229"><a href="#cb64-229" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb64-230"><a href="#cb64-230" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb64-231"><a href="#cb64-231" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb64-232"><a href="#cb64-232" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb64-233"><a href="#cb64-233" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb64-234"><a href="#cb64-234" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb64-235"><a href="#cb64-235" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb64-236"><a href="#cb64-236" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb64-237"><a href="#cb64-237" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb64-238"><a href="#cb64-238" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb64-239"><a href="#cb64-239" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb64-240"><a href="#cb64-240" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb64-241"><a href="#cb64-241" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb64-242"><a href="#cb64-242" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb64-243"><a href="#cb64-243" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb64-244"><a href="#cb64-244" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb64-245"><a href="#cb64-245" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb64-246"><a href="#cb64-246" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb64-247"><a href="#cb64-247" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb64-248"><a href="#cb64-248" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb64-249"><a href="#cb64-249" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb64-250"><a href="#cb64-250" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb64-251"><a href="#cb64-251" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb64-252"><a href="#cb64-252" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb64-253"><a href="#cb64-253" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb64-254"><a href="#cb64-254" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb64-255"><a href="#cb64-255" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb64-256"><a href="#cb64-256" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb64-257"><a href="#cb64-257" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb64-258"><a href="#cb64-258" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb64-259"><a href="#cb64-259" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb64-260"><a href="#cb64-260" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb64-261"><a href="#cb64-261" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb64-262"><a href="#cb64-262" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb64-263"><a href="#cb64-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-264"><a href="#cb64-264" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large_largeh <span class="ot">&lt;-</span> all_effs_sex_large_largeh <span class="sc">%&gt;%</span></span>
<span id="cb64-265"><a href="#cb64-265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-266"><a href="#cb64-266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc, ssize, power) <span class="sc">%&gt;%</span></span>
<span id="cb64-267"><a href="#cb64-267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb64-268"><a href="#cb64-268" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb64-269"><a href="#cb64-269" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"none"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb64-270"><a href="#cb64-270" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"large"</span>))</span>
<span id="cb64-271"><a href="#cb64-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-272"><a href="#cb64-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-273"><a href="#cb64-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-274"><a href="#cb64-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-275"><a href="#cb64-275" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb64-276"><a href="#cb64-276" aria-hidden="true" tabindex="-1"></a>    calc_power_sex_large_noh,</span>
<span id="cb64-277"><a href="#cb64-277" aria-hidden="true" tabindex="-1"></a>    calc_power_sex_large_lowh,</span>
<span id="cb64-278"><a href="#cb64-278" aria-hidden="true" tabindex="-1"></a>    calc_power_sex_large_largeh</span>
<span id="cb64-279"><a href="#cb64-279" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb64-280"><a href="#cb64-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-281"><a href="#cb64-281" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">lapply</span>(all_sex_effs_sex_only, unlist))</span>
<span id="cb64-282"><a href="#cb64-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-283"><a href="#cb64-283" aria-hidden="true" tabindex="-1"></a><span class="co"># plot1 &lt;- all_sex_effs_sex_only %&gt;%</span></span>
<span id="cb64-284"><a href="#cb64-284" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(Effect %in% c("Treatment")) %&gt;%</span></span>
<span id="cb64-285"><a href="#cb64-285" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(heterosc %in% c("low")) %&gt;%</span></span>
<span id="cb64-286"><a href="#cb64-286" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sample_size = factor(sample_size,</span></span>
<span id="cb64-287"><a href="#cb64-287" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("5M+5F", "10M+10F", "50M+50F"))) %&gt;%</span></span>
<span id="cb64-288"><a href="#cb64-288" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(method = recode(method,</span></span>
<span id="cb64-289"><a href="#cb64-289" aria-hidden="true" tabindex="-1"></a><span class="co">#                          "ANOVA" = "Factorial")) %&gt;%</span></span>
<span id="cb64-290"><a href="#cb64-290" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x = treat_es2, y = p_value, colour = sample_size)) +</span></span>
<span id="cb64-291"><a href="#cb64-291" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_hline(yintercept = 0.8, linetype = 1, colour = "red") +</span></span>
<span id="cb64-292"><a href="#cb64-292" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_line() +</span></span>
<span id="cb64-293"><a href="#cb64-293" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_bw() +</span></span>
<span id="cb64-294"><a href="#cb64-294" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylab("Statistical power") +</span></span>
<span id="cb64-295"><a href="#cb64-295" aria-hidden="true" tabindex="-1"></a><span class="co">#   xlab("Main treatment effect") +</span></span>
<span id="cb64-296"><a href="#cb64-296" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_colour_manual(name = "Sample size", values = cbb_palette) +</span></span>
<span id="cb64-297"><a href="#cb64-297" aria-hidden="true" tabindex="-1"></a><span class="co">#   # scale_linetype_discrete(name = "Heteroscedasticity")  +</span></span>
<span id="cb64-298"><a href="#cb64-298" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylim(0, 1)</span></span>
<span id="cb64-299"><a href="#cb64-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-300"><a href="#cb64-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-301"><a href="#cb64-301" aria-hidden="true" tabindex="-1"></a><span class="co"># plot2 &lt;- all_sex_effs_sex_only %&gt;%</span></span>
<span id="cb64-302"><a href="#cb64-302" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(Effect %in% c("Treatment")) %&gt;%</span></span>
<span id="cb64-303"><a href="#cb64-303" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(heterosc %in% c("large")) %&gt;%</span></span>
<span id="cb64-304"><a href="#cb64-304" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sample_size = factor(sample_size,</span></span>
<span id="cb64-305"><a href="#cb64-305" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("5M+5F", "10M+10F", "50M+50F"))) %&gt;%</span></span>
<span id="cb64-306"><a href="#cb64-306" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(method = recode(method,</span></span>
<span id="cb64-307"><a href="#cb64-307" aria-hidden="true" tabindex="-1"></a><span class="co">#                          "ANOVA" = "Factorial")) %&gt;%</span></span>
<span id="cb64-308"><a href="#cb64-308" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x = treat_es2, y = p_value, colour = sample_size)) +</span></span>
<span id="cb64-309"><a href="#cb64-309" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_hline(yintercept = 0.8, linetype = 1, colour = "red") +</span></span>
<span id="cb64-310"><a href="#cb64-310" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_line() +</span></span>
<span id="cb64-311"><a href="#cb64-311" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_bw() +</span></span>
<span id="cb64-312"><a href="#cb64-312" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylab("Statistical power") +</span></span>
<span id="cb64-313"><a href="#cb64-313" aria-hidden="true" tabindex="-1"></a><span class="co">#   xlab("Main treatment effect") +</span></span>
<span id="cb64-314"><a href="#cb64-314" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_colour_manual(name = "Sample size", values = cbb_palette) +</span></span>
<span id="cb64-315"><a href="#cb64-315" aria-hidden="true" tabindex="-1"></a><span class="co">#   # scale_linetype_discrete(name = "Heteroscedasticity")  +</span></span>
<span id="cb64-316"><a href="#cb64-316" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylim(0, 1)</span></span>
<span id="cb64-317"><a href="#cb64-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-318"><a href="#cb64-318" aria-hidden="true" tabindex="-1"></a><span class="co"># ggarrange(plot1, plot2, ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")</span></span>
<span id="cb64-319"><a href="#cb64-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-320"><a href="#cb64-320" aria-hidden="true" tabindex="-1"></a>plot3 <span class="ot">&lt;-</span> all_sex_effs_sex_only <span class="sc">%&gt;%</span></span>
<span id="cb64-321"><a href="#cb64-321" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(heterosc %in% c("low")) %&gt;%</span></span>
<span id="cb64-322"><a href="#cb64-322" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sample_size = factor(sample_size,</span></span>
<span id="cb64-323"><a href="#cb64-323" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("5M+5F", "10M+10F", "50M+50F"))) %&gt;%</span></span>
<span id="cb64-324"><a href="#cb64-324" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sex_eff_size = factor(sex_eff_size,</span></span>
<span id="cb64-325"><a href="#cb64-325" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("none", "small", "large"))) %&gt;%</span></span>
<span id="cb64-326"><a href="#cb64-326" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> ssize, <span class="at">colour =</span> heterosc)) <span class="sc">+</span></span>
<span id="cb64-327"><a href="#cb64-327" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_hline(yintercept = 0.8, linetype = 1, colour = "red") +</span></span>
<span id="cb64-328"><a href="#cb64-328" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb64-329"><a href="#cb64-329" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb64-330"><a href="#cb64-330" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Sample size"</span>) <span class="sc">+</span></span>
<span id="cb64-331"><a href="#cb64-331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Main treatment effect"</span>) <span class="sc">+</span></span>
<span id="cb64-332"><a href="#cb64-332" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">name =</span> <span class="st">"Effect"</span>, <span class="at">values =</span> cbb_palette) <span class="sc">+</span> <span class="fu">coord_trans</span>(<span class="at">y =</span> <span class="st">"log10"</span>) <span class="sc">+</span></span>
<span id="cb64-333"><a href="#cb64-333" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">15</span>))</span>
<span id="cb64-334"><a href="#cb64-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-335"><a href="#cb64-335" aria-hidden="true" tabindex="-1"></a><span class="co"># plot3</span></span>
<span id="cb64-336"><a href="#cb64-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-337"><a href="#cb64-337" aria-hidden="true" tabindex="-1"></a>plot3<span class="fl">.1</span> <span class="ot">&lt;-</span> all_sex_effs_sex_only <span class="sc">%&gt;%</span></span>
<span id="cb64-338"><a href="#cb64-338" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(heterosc %in% c("low")) %&gt;%</span></span>
<span id="cb64-339"><a href="#cb64-339" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sample_size = factor(sample_size,</span></span>
<span id="cb64-340"><a href="#cb64-340" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("5M+5F", "10M+10F", "50M+50F"))) %&gt;%</span></span>
<span id="cb64-341"><a href="#cb64-341" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sex_eff_size = factor(sex_eff_size,</span></span>
<span id="cb64-342"><a href="#cb64-342" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("none", "small", "large"))) %&gt;%</span></span>
<span id="cb64-343"><a href="#cb64-343" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> ssize, <span class="at">linetype =</span> heterosc)) <span class="sc">+</span></span>
<span id="cb64-344"><a href="#cb64-344" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_hline(yintercept = 0.8, linetype = 1, colour = "red") +</span></span>
<span id="cb64-345"><a href="#cb64-345" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb64-346"><a href="#cb64-346" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb64-347"><a href="#cb64-347" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Sample size"</span>) <span class="sc">+</span></span>
<span id="cb64-348"><a href="#cb64-348" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Main treatment effect"</span>) <span class="sc">+</span></span>
<span id="cb64-349"><a href="#cb64-349" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">linetype =</span> <span class="st">"Heteroscedasticity"</span>) <span class="sc">+</span></span>
<span id="cb64-350"><a href="#cb64-350" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_colour_manual(name = "Heteroscedasticity", values = cbb_palette) +</span></span>
<span id="cb64-351"><a href="#cb64-351" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fl">0.3</span>, <span class="fl">0.7</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">5</span>, <span class="dv">2200</span>)</span>
<span id="cb64-352"><a href="#cb64-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-353"><a href="#cb64-353" aria-hidden="true" tabindex="-1"></a><span class="co"># plot3.1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="combined-plots" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="combined-plots"><span class="header-section-number">5.2</span> Combined plots</h2>
<p>(In all below examples the y axis (sample size) indicates the number of individuals per group and sex - hence the total sample size is 4 times the number indicated on the y axis.)</p>
<p>Combined plot for scenarios of no interaction (A), interaction with stronger effect in more variable sex (B) and stronger effect in less variable sex (C) for full range of effect sizes and on log-scale for sample size:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>comb1 <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(plot1, plot2, plot3, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">common.legend =</span> <span class="cn">TRUE</span>, <span class="at">legend =</span> <span class="st">"bottom"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>))</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>comb1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Combined plot for scenarios of no interaction (A), interaction with stronger effect in more variable sex (B) and stronger effect in less variable sex (C) for moderate-sized effect sizes using identity scale for sample size. Capping of some relationships (high sample sizes hitting a ceiling in (C) or low sample sizes hitting a floor in (B) results from simulation limitations - sample sizes were modelled from a minimum of 5 (per sex per group) and were capped at the first value exceeding 2000 individuals, as any such sample would anyway be already impractical).</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>comb2 <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(plot1<span class="fl">.1</span>, plot2<span class="fl">.1</span>, plot3<span class="fl">.1</span>, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">common.legend =</span> <span class="cn">TRUE</span>, <span class="at">legend =</span> <span class="st">"bottom"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>))</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>comb2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Combined plots demonstrating the impact of heteroscedasticity on power (repeated from section <a href="#sec-powerbreakdown">Section&nbsp;1.2</a>) for a no-interaction case (A) and interaction-of-magnitude case (B; stronger effect in the more variable sex):</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>comb3 <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(plotA, plotB, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">common.legend =</span> <span class="cn">TRUE</span>, <span class="at">legend =</span> <span class="st">"bottom"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>))</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>comb3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="source-of-heterogeneity" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Source of heterogeneity</h1>
<p>Below plots show hypothetical scenarios when heterogeneity is a natural outcome of the underlying statistical process. Diagonal lines connect averages belonging to one treatment group (control vs.&nbsp;experimental). Thick vertical lines show SD of each subgroup.</p>
<section id="poisson-distribution" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="poisson-distribution"><span class="header-section-number">6.1</span> Poisson distribution</h2>
<p>Simulation draws from <span class="math inline">\(Pois(\lambda_i)\)</span> assumes sex/treatment specific averages (<span class="math inline">\(\lambda_i\)</span>) - see <code>lambda1...lambda4</code> below.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>lambda1 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>lambda2 <span class="ot">&lt;-</span> <span class="dv">9</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>lambda3 <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>lambda4 <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>toy_poisson <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Treatment =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"Ctrl"</span>, <span class="dv">2</span><span class="sc">*</span>N), <span class="fu">rep</span>(<span class="st">"Exp"</span>, <span class="dv">2</span><span class="sc">*</span>N)),</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sex =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"F"</span>, N), <span class="fu">rep</span>(<span class="st">"M"</span>, N), <span class="fu">rep</span>(<span class="st">"F"</span>, N), <span class="fu">rep</span>(<span class="st">"M"</span>, N)),</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Response =</span> <span class="fu">c</span>(<span class="fu">rpois</span>(N, lambda1), <span class="fu">rpois</span>(N, lambda2), <span class="fu">rpois</span>(N, lambda3), <span class="fu">rpois</span>(N, lambda4))</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>toy_poisson<span class="sc">$</span>Group <span class="ot">&lt;-</span> <span class="fu">interaction</span>(toy_poisson<span class="sc">$</span>Sex, toy_poisson<span class="sc">$</span>Treatment)</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> toy_poisson, <span class="fu">aes</span>(<span class="at">x =</span> Response, <span class="at">y =</span> Group)) <span class="sc">+</span></span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density_ridges</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Sex, <span class="at">scale =</span> <span class="fl">0.8</span>),</span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">stat =</span> <span class="st">"binline"</span>, <span class="at">bins =</span> <span class="dv">15</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">draw_baseline =</span> <span class="cn">FALSE</span></span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_ridges</span>() <span class="sc">+</span></span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">stat =</span> <span class="st">"summary"</span>, <span class="at">fun =</span> <span class="st">"mean"</span>) <span class="sc">+</span></span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_summary</span>(</span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"line"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>,</span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">group =</span> Treatment, <span class="at">linetype =</span> Treatment)</span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_summary</span>(</span>
<span id="cb68-26"><a href="#cb68-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">fun.max =</span> <span class="cf">function</span>(x) <span class="fu">mean</span>(x) <span class="sc">+</span> <span class="fu">sd</span>(x),</span>
<span id="cb68-27"><a href="#cb68-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">fun.min =</span> <span class="cf">function</span>(x) <span class="fu">mean</span>(x) <span class="sc">-</span> <span class="fu">sd</span>(x), <span class="at">geom =</span> <span class="st">"errorbar"</span>,</span>
<span id="cb68-28"><a href="#cb68-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">linewidth =</span> <span class="fl">1.5</span>, <span class="at">width =</span> <span class="dv">0</span></span>
<span id="cb68-29"><a href="#cb68-29" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb68-30"><a href="#cb68-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb68-31"><a href="#cb68-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb68-32"><a href="#cb68-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>))</span>
<span id="cb68-33"><a href="#cb68-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-34"><a href="#cb68-34" aria-hidden="true" tabindex="-1"></a><span class="co"># plot1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="log-normal-distribution" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="log-normal-distribution"><span class="header-section-number">6.2</span> Log-normal distribution</h2>
<p>Simulation samples from <span class="math inline">\(Lognormal(\mu_i, \sigma^2=0.1)\)</span> with sex/treatment specific means (<code>mu1...mu4</code>) below.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>mu2 <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>mu3 <span class="ot">&lt;-</span> <span class="fl">0.4</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>mu4 <span class="ot">&lt;-</span> <span class="fl">0.8</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="fl">0.31</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>toy_lognorm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Treatment =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"Ctrl"</span>, <span class="dv">2</span><span class="sc">*</span>N), <span class="fu">rep</span>(<span class="st">"Exp"</span>, <span class="dv">2</span><span class="sc">*</span>N)),</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sex =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"F"</span>, N), <span class="fu">rep</span>(<span class="st">"M"</span>, N), <span class="fu">rep</span>(<span class="st">"F"</span>, N), <span class="fu">rep</span>(<span class="st">"M"</span>, N)),</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Response =</span> <span class="fu">c</span>(<span class="fu">rlnorm</span>(N, mu1, sd), <span class="fu">rlnorm</span>(N, mu2, sd), <span class="fu">rlnorm</span>(N, mu3, sd), <span class="fu">rlnorm</span>(N, mu4, sd))</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>toy_lognorm<span class="sc">$</span>Group <span class="ot">&lt;-</span> <span class="fu">interaction</span>(toy_poisson<span class="sc">$</span>Sex, toy_poisson<span class="sc">$</span>Treatment)</span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> figure1C <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> toy_lognorm, <span class="fu">aes</span>(<span class="at">x =</span> Response, <span class="at">y =</span> Group)) <span class="sc">+</span></span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density_ridges</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Sex, <span class="at">scale =</span> <span class="fl">0.8</span>),</span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">stat =</span> <span class="st">"binline"</span>, <span class="at">bins =</span> <span class="dv">15</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">draw_baseline =</span> <span class="cn">FALSE</span></span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_ridges</span>() <span class="sc">+</span></span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">stat =</span> <span class="st">"summary"</span>, <span class="at">fun =</span> <span class="st">"mean"</span>) <span class="sc">+</span></span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_summary</span>(</span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"line"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>,</span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">group =</span> Treatment, <span class="at">linetype =</span> Treatment)</span>
<span id="cb69-25"><a href="#cb69-25" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb69-26"><a href="#cb69-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_summary</span>(</span>
<span id="cb69-27"><a href="#cb69-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">fun.max =</span> <span class="cf">function</span>(x) <span class="fu">mean</span>(x) <span class="sc">+</span> <span class="fu">sd</span>(x),</span>
<span id="cb69-28"><a href="#cb69-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">fun.min =</span> <span class="cf">function</span>(x) <span class="fu">mean</span>(x) <span class="sc">-</span> <span class="fu">sd</span>(x), <span class="at">geom =</span> <span class="st">"errorbar"</span>,</span>
<span id="cb69-29"><a href="#cb69-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">linewidth =</span> <span class="fl">1.5</span>, <span class="at">width =</span> <span class="dv">0</span></span>
<span id="cb69-30"><a href="#cb69-30" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb69-31"><a href="#cb69-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb69-32"><a href="#cb69-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb69-33"><a href="#cb69-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>))</span>
<span id="cb69-34"><a href="#cb69-34" aria-hidden="true" tabindex="-1"></a><span class="co"># plot2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="combined-plot" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="combined-plot"><span class="header-section-number">6.3</span> Combined plot</h2>
<div class="cell" data-fig.label="fig:source_hetero1">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(plot1, plot2, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">1</span>,</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="at">common.legend =</span> <span class="cn">TRUE</span>, <span class="at">legend =</span> <span class="st">"bottom"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="code_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Simulated sex-by-treatment data using a Poisson (A) and log-normal (B) distribution. Diagonal lines connect averages belonging to one treatment group (control vs.&nbsp;experimental). Thick vertical lines show SD of each subgroup.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="non-linear-response-in-sexes" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="non-linear-response-in-sexes"><span class="header-section-number">6.4</span> Non-linear response in sexes</h2>
<p>Heterogeneity in variances may also arise if the underlying phenotypic mapping function is non linear and has saturating/desaturating character in a range modified by sex dimorphism and/or experimental treatment.</p>
<p>Here we assume a logistic function:</p>
<p><span class="math display">\[f(x)=\frac{L}{e^{-k(x-x_0)}}\]</span></p>
<p>with parameter values: <code>L = 3.5</code>, <code>k = 1</code>, <code>x0 = 1</code>.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>mapping_logistic <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">L =</span> <span class="fl">3.5</span>, <span class="at">x0 =</span> <span class="dv">1</span>, <span class="at">k =</span> <span class="dv">1</span>) L<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">*</span>k<span class="sc">*</span>(x <span class="sc">-</span> x0)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Using this function, we can generate data assuming some treatment and sex differences:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>SD_N <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>mu_env1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>mu_env2 <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>mu_env3 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>mu_env4 <span class="ot">&lt;-</span> <span class="fl">4.5</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>toy_nonlin <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Treatment =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"Ctrl"</span>, <span class="dv">2</span> <span class="sc">*</span> N), <span class="fu">rep</span>(<span class="st">"Exp"</span>, <span class="dv">2</span> <span class="sc">*</span> N)),</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sex =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"F"</span>, N), <span class="fu">rep</span>(<span class="st">"M"</span>, N), <span class="fu">rep</span>(<span class="st">"F"</span>, N), <span class="fu">rep</span>(<span class="st">"M"</span>, N)),</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Env =</span> <span class="fu">c</span>(</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">rnorm</span>(N, mu_env1, SD_N), <span class="fu">rnorm</span>(N, mu_env2, SD_N),</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">rnorm</span>(N, mu_env3, SD_N), <span class="fu">rnorm</span>(N, mu_env4, SD_N)</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>toy_nonlin<span class="sc">$</span>Response <span class="ot">&lt;-</span> <span class="fu">mapping_logistic</span>(toy_nonlin<span class="sc">$</span>Env)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-fig.label="source_hetero2">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>figure1D <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> toy_nonlin,</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">y =</span> Env, <span class="at">x =</span> Response, <span class="at">colour =</span> Sex),</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">pch =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.8</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="dv">2</span>,</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">8</span>, <span class="fl">0.1</span>), <span class="at">x =</span> <span class="fu">mapping_logistic</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">8</span>, <span class="fl">0.1</span>)))</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density_ridges</span>(</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> toy_nonlin <span class="sc">%&gt;%</span></span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>            <span class="fu">group_by</span>(Sex, Treatment) <span class="sc">%&gt;%</span></span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mutate</span>(<span class="at">meanEnv =</span> <span class="fu">mean</span>(Env)),</span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">x =</span> Response, <span class="at">group =</span> meanEnv, <span class="at">y =</span> meanEnv, <span class="at">fill =</span> Sex),</span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">stat =</span> <span class="st">"binline"</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">draw_baseline =</span> F</span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(</span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> toy_nonlin <span class="sc">%&gt;%</span></span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a>            <span class="fu">group_by</span>(Sex, Treatment) <span class="sc">%&gt;%</span></span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a>            <span class="fu">summarise</span>(<span class="at">meanEnv =</span> <span class="fu">mean</span>(Env), <span class="at">meanResp =</span> <span class="fu">mean</span>(Response)),</span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">x =</span> meanResp, <span class="at">y =</span> meanEnv),</span>
<span id="cb73-23"><a href="#cb73-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="dv">4</span></span>
<span id="cb73-24"><a href="#cb73-24" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb73-25"><a href="#cb73-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(</span>
<span id="cb73-26"><a href="#cb73-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> toy_nonlin <span class="sc">%&gt;%</span></span>
<span id="cb73-27"><a href="#cb73-27" aria-hidden="true" tabindex="-1"></a>            <span class="fu">group_by</span>(Sex, Treatment) <span class="sc">%&gt;%</span></span>
<span id="cb73-28"><a href="#cb73-28" aria-hidden="true" tabindex="-1"></a>            <span class="fu">summarise</span>(<span class="at">meanEnv =</span> <span class="fu">mean</span>(Env), <span class="at">meanResp =</span> <span class="fu">mean</span>(Response)),</span>
<span id="cb73-29"><a href="#cb73-29" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">x =</span> meanResp, <span class="at">y =</span> meanEnv, <span class="at">linetype =</span> Treatment),</span>
<span id="cb73-30"><a href="#cb73-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">linewidth =</span> <span class="dv">1</span></span>
<span id="cb73-31"><a href="#cb73-31" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb73-32"><a href="#cb73-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbarh</span>(</span>
<span id="cb73-33"><a href="#cb73-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> toy_nonlin <span class="sc">%&gt;%</span></span>
<span id="cb73-34"><a href="#cb73-34" aria-hidden="true" tabindex="-1"></a>            <span class="fu">group_by</span>(Sex, Treatment) <span class="sc">%&gt;%</span></span>
<span id="cb73-35"><a href="#cb73-35" aria-hidden="true" tabindex="-1"></a>            <span class="fu">summarise</span>(<span class="at">meanEnv =</span> <span class="fu">mean</span>(Env), <span class="at">meanResp =</span> <span class="fu">mean</span>(Response),</span>
<span id="cb73-36"><a href="#cb73-36" aria-hidden="true" tabindex="-1"></a>            <span class="at">minResp =</span> <span class="fu">mean</span>(Response) <span class="sc">-</span> <span class="fu">sd</span>(Response),</span>
<span id="cb73-37"><a href="#cb73-37" aria-hidden="true" tabindex="-1"></a>            <span class="at">maxResp =</span> <span class="fu">mean</span>(Response) <span class="sc">+</span> <span class="fu">sd</span>(Response)),</span>
<span id="cb73-38"><a href="#cb73-38" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">y =</span> meanEnv, <span class="at">xmin =</span> minResp, <span class="at">xmax =</span> maxResp),</span>
<span id="cb73-39"><a href="#cb73-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">linewidth =</span> <span class="fl">1.5</span>, <span class="at">height =</span> <span class="dv">0</span></span>
<span id="cb73-40"><a href="#cb73-40" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span> <span class="fu">guides</span>(<span class="at">colour =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb73-41"><a href="#cb73-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># stat_summary(data = toy_nonlin %&gt;%</span></span>
<span id="cb73-42"><a href="#cb73-42" aria-hidden="true" tabindex="-1"></a>    <span class="co">#         group_by(Sex, Treatment) %&gt;%</span></span>
<span id="cb73-43"><a href="#cb73-43" aria-hidden="true" tabindex="-1"></a>    <span class="co">#         mutate(meanEnv = mean(Env)),</span></span>
<span id="cb73-44"><a href="#cb73-44" aria-hidden="true" tabindex="-1"></a>    <span class="co">#     fun = "mean", geom = "line", linewidth = 1,</span></span>
<span id="cb73-45"><a href="#cb73-45" aria-hidden="true" tabindex="-1"></a>    <span class="co">#     aes(x = Response, group = meanEnv, y = meanEnv, linetype = Treatment)</span></span>
<span id="cb73-46"><a href="#cb73-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ) +</span></span>
<span id="cb73-47"><a href="#cb73-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Manipulated environmental variable"</span>) <span class="sc">+</span></span>
<span id="cb73-48"><a href="#cb73-48" aria-hidden="true" tabindex="-1"></a>    <span class="co"># theme_ridges() +</span></span>
<span id="cb73-49"><a href="#cb73-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>))</span>
<span id="cb73-50"><a href="#cb73-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-51"><a href="#cb73-51" aria-hidden="true" tabindex="-1"></a>figure1D</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="code_files/figure-html/unnamed-chunk-67-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Heteroscedasticity between sexes (colours) and treatment groups (solid/dashed lines) resulting from a non-linear (here - logistic) mapping of some manipulated environemntal variable into the measured response. Thin dotted line - underlying mapping function. Points - realisations of mapping for simulated environmental data. Histograms relate to observed response measurements.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="taylor-law-in-comparative-data" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Taylor law in comparative data</h1>
<p>Here we use previously published synthetic data to demonstrate the degree and ubiquity of mean-variance relationships typical to the Taylors law.</p>
<p>First lets load the relevant data.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>data_all <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"ALL_TRAITS_20200514.xlsx"</span>), <span class="at">sheet =</span> <span class="st">"main"</span>)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="co"># names(data_all)</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="do">## analyses on adiposity [g] data only:</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>data_all <span class="sc">%&gt;%</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Trait <span class="sc">==</span> <span class="st">"Adiposity"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(Paper_ID)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12  2
   Paper_ID              n
   &lt;chr&gt;             &lt;int&gt;
 1 Adedeji2019           4
 2 Armitage2007          2
 3 Barbosa2020           2
 4 CastroBarbosa2016    16
 5 Ding2014              1
 6 King2013             21
 7 Li2012                1
 8 MartinsTerra2019      4
 9 Masuyama2015          2
10 Sarker2018           12
11 Tait2015              4
12 Winther2019           2</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># offspring ages</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data_all<span class="sc">$</span>Age_at_Measurement_Days[data_all<span class="sc">$</span>Trait <span class="sc">==</span> <span class="st">"Adiposity"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   84.0    84.0    91.0   126.8   180.0   270.0 </code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># species</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">factor</span>(data_all<span class="sc">$</span>Rodent_Type[data_all<span class="sc">$</span>Trait <span class="sc">==</span> <span class="st">"Adiposity"</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Mouse   Rat 
   37    34 </code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># merge control and treatment data (all traits)</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>dataA <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">c</span>(data_all<span class="sc">$</span>Mean_Treatment, data_all<span class="sc">$</span>Mean_Control),</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd =</span> <span class="fu">c</span>(data_all<span class="sc">$</span>SD_Treatment, data_all<span class="sc">$</span>SD_Control),</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fu">c</span>(data_all<span class="sc">$</span>Sample_Size_n_Treatment, data_all<span class="sc">$</span>Sample_Size_n_Control),</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">sex =</span> <span class="fu">c</span>(data_all<span class="sc">$</span>Offspring_Sex, data_all<span class="sc">$</span>Offspring_Sex),</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">trait =</span> <span class="fu">c</span>(data_all<span class="sc">$</span>Trait, data_all<span class="sc">$</span>Trait),</span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">species =</span> <span class="fu">c</span>(data_all<span class="sc">$</span>Rodent_Type, data_all<span class="sc">$</span>Rodent_Type)</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Plotting individual subplots for mice, rats, and both species jointly.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>dataA <span class="sc">%&gt;%</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(trait <span class="sc">==</span> <span class="st">"Adiposity"</span> <span class="sc">&amp;</span> species <span class="sc">==</span> <span class="st">"Mouse"</span>) <span class="sc">%$%</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cor.test</span>(<span class="fu">log</span>(mean), <span class="fu">log</span>(sd)) <span class="ot">-&gt;</span> cor_mice <span class="co"># calculate correlation</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>figA <span class="ot">&lt;-</span> dataA <span class="sc">%&gt;%</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(trait <span class="sc">==</span> <span class="st">"Adiposity"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(species <span class="sc">==</span> <span class="st">"Mouse"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log</span>(mean), <span class="at">y =</span> <span class="fu">log</span>(sd), <span class="at">col =</span> sex)) <span class="sc">+</span></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> size), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># coord_trans(x = "log10", y = "log10") +</span></span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">guides</span>(<span class="at">size =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Mouse adiposity"</span>, <span class="at">x =</span> <span class="st">"ln (mean)"</span>, <span class="at">y =</span> <span class="st">"ln (SD)"</span>,</span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"Sex"</span>) <span class="sc">+</span></span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>), <span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">x =</span> <span class="sc">-</span><span class="fl">5.2</span>, <span class="at">y =</span> <span class="fl">1.5</span>, <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"italic(r) == %.2f"</span>, cor_mice<span class="sc">$</span>estimate)), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">5</span>)</span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a>dataA <span class="sc">%&gt;%</span></span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(trait <span class="sc">==</span> <span class="st">"Adiposity"</span> <span class="sc">&amp;</span> species <span class="sc">==</span> <span class="st">"Rat"</span>) <span class="sc">%$%</span></span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cor.test</span>(<span class="fu">log</span>(mean), <span class="fu">log</span>(sd)) <span class="ot">-&gt;</span> cor_rats <span class="co"># calculate correlation</span></span>
<span id="cb81-20"><a href="#cb81-20" aria-hidden="true" tabindex="-1"></a>figB <span class="ot">&lt;-</span> dataA <span class="sc">%&gt;%</span></span>
<span id="cb81-21"><a href="#cb81-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(trait <span class="sc">==</span> <span class="st">"Adiposity"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb81-22"><a href="#cb81-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(species <span class="sc">==</span> <span class="st">"Rat"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb81-23"><a href="#cb81-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log</span>(mean), <span class="at">y =</span> <span class="fu">log</span>(sd), <span class="at">col =</span> sex)) <span class="sc">+</span></span>
<span id="cb81-24"><a href="#cb81-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> size), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb81-25"><a href="#cb81-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb81-26"><a href="#cb81-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># coord_trans(x = "log10", y = "log10") +</span></span>
<span id="cb81-27"><a href="#cb81-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">guides</span>(<span class="at">size =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb81-28"><a href="#cb81-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Rat adiposity"</span>, <span class="at">x =</span> <span class="st">"ln (mean)"</span>, <span class="at">y =</span> <span class="st">"ln (SD)"</span>,</span>
<span id="cb81-29"><a href="#cb81-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"Sex"</span>) <span class="sc">+</span></span>
<span id="cb81-30"><a href="#cb81-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>), <span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb81-31"><a href="#cb81-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">y =</span> <span class="dv">4</span>, <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"italic(r) == %.2f"</span>, cor_rats<span class="sc">$</span>estimate)), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">5</span>)</span>
<span id="cb81-32"><a href="#cb81-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-33"><a href="#cb81-33" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation - all</span></span>
<span id="cb81-34"><a href="#cb81-34" aria-hidden="true" tabindex="-1"></a>dataA <span class="sc">%&gt;%</span></span>
<span id="cb81-35"><a href="#cb81-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(trait <span class="sc">==</span> <span class="st">"Adiposity"</span>) <span class="sc">%$%</span></span>
<span id="cb81-36"><a href="#cb81-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cor.test</span>(<span class="fu">log</span>(mean), <span class="fu">log</span>(sd)) <span class="ot">-&gt;</span> cor_all</span>
<span id="cb81-37"><a href="#cb81-37" aria-hidden="true" tabindex="-1"></a>figC <span class="ot">&lt;-</span> dataA <span class="sc">%&gt;%</span></span>
<span id="cb81-38"><a href="#cb81-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(trait <span class="sc">==</span> <span class="st">"Adiposity"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb81-39"><a href="#cb81-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log</span>(mean), <span class="at">y =</span> <span class="fu">log</span>(sd), <span class="at">col =</span> sex)) <span class="sc">+</span></span>
<span id="cb81-40"><a href="#cb81-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> size), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb81-41"><a href="#cb81-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb81-42"><a href="#cb81-42" aria-hidden="true" tabindex="-1"></a>    <span class="co"># coord_trans(x = "log10", y = "log10") +</span></span>
<span id="cb81-43"><a href="#cb81-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">guides</span>(<span class="at">size =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb81-44"><a href="#cb81-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Mouse and rat adiposity"</span>, <span class="at">x =</span> <span class="st">"ln (mean)"</span>, <span class="at">y =</span> <span class="st">"ln (SD)"</span>) <span class="sc">+</span></span>
<span id="cb81-45"><a href="#cb81-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>), <span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb81-46"><a href="#cb81-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">y =</span> <span class="dv">4</span>, <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"italic(r) == %.2f"</span>, cor_all<span class="sc">$</span>estimate)), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">5</span>)</span>
<span id="cb81-47"><a href="#cb81-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-48"><a href="#cb81-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-49"><a href="#cb81-49" aria-hidden="true" tabindex="-1"></a><span class="co"># assemble the panels using patchwork package</span></span>
<span id="cb81-50"><a href="#cb81-50" aria-hidden="true" tabindex="-1"></a>figure1 <span class="ot">&lt;-</span> figA <span class="sc">/</span> figB <span class="sc">/</span> figC <span class="sc">+</span></span>
<span id="cb81-51"><a href="#cb81-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">3</span>,</span>
<span id="cb81-52"><a href="#cb81-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">1.1</span>))</span>
<span id="cb81-53"><a href="#cb81-53" aria-hidden="true" tabindex="-1"></a>figure1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="code_files/figure-html/unnamed-chunk-69-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>figure1AB <span class="ot">&lt;-</span> figA <span class="sc">/</span> figB <span class="sc">+</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">guides =</span> <span class="st">"collect"</span>) <span class="sc">+</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"A"</span>) <span class="sc">&amp;</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">

</div>
<!-- -->

</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb83" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Sex &amp; statistical power - simulations"</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Szymek Drobniak"</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "`r Sys.Date()`"</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-location: left</span></span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 2</span></span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: simplex</span></span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a><span class="co">    embed-resources: true</span></span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: show</span></span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a><span class="co">    message: false</span></span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a><span class="co">    warning: false</span></span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a><span class="an">crossref:</span><span class="co"> </span></span>
<span id="cb83-18"><a href="#cb83-18" aria-hidden="true" tabindex="-1"></a><span class="co">  fig-title: Figure     # (default is "Figure")</span></span>
<span id="cb83-19"><a href="#cb83-19" aria-hidden="true" tabindex="-1"></a><span class="co">  tbl-title: Table     # (default is "Table")</span></span>
<span id="cb83-20"><a href="#cb83-20" aria-hidden="true" tabindex="-1"></a><span class="co">  title-delim:      # (default is ":")</span></span>
<span id="cb83-21"><a href="#cb83-21" aria-hidden="true" tabindex="-1"></a><span class="co">  fig-prefix: Fig.   # (default is "Figure")</span></span>
<span id="cb83-22"><a href="#cb83-22" aria-hidden="true" tabindex="-1"></a><span class="co">  tbl-prefix: Tab.    # (default is "Table")</span></span>
<span id="cb83-23"><a href="#cb83-23" aria-hidden="true" tabindex="-1"></a><span class="an">editor_options:</span><span class="co"> </span></span>
<span id="cb83-24"><a href="#cb83-24" aria-hidden="true" tabindex="-1"></a><span class="co">  chunk_output_type: console</span></span>
<span id="cb83-25"><a href="#cb83-25" aria-hidden="true" tabindex="-1"></a><span class="an">evaluate:</span></span>
<span id="cb83-26"><a href="#cb83-26" aria-hidden="true" tabindex="-1"></a><span class="co">  cache: true</span></span>
<span id="cb83-27"><a href="#cb83-27" aria-hidden="true" tabindex="-1"></a><span class="co">  </span></span>
<span id="cb83-28"><a href="#cb83-28" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb83-29"><a href="#cb83-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-32"><a href="#cb83-32" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-33"><a href="#cb83-33" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb83-34"><a href="#cb83-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-35"><a href="#cb83-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-36"><a href="#cb83-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb83-37"><a href="#cb83-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pander)</span>
<span id="cb83-38"><a href="#cb83-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb83-39"><a href="#cb83-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb83-40"><a href="#cb83-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb83-41"><a href="#cb83-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb83-42"><a href="#cb83-42" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggridges)</span>
<span id="cb83-43"><a href="#cb83-43" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb83-44"><a href="#cb83-44" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb83-45"><a href="#cb83-45" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb83-46"><a href="#cb83-46" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb83-47"><a href="#cb83-47" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-48"><a href="#cb83-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-49"><a href="#cb83-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-50"><a href="#cb83-50" aria-hidden="true" tabindex="-1"></a>Analysis preps (colours, options, auxiliary functions)</span>
<span id="cb83-51"><a href="#cb83-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-54"><a href="#cb83-54" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-55"><a href="#cb83-55" aria-hidden="true" tabindex="-1"></a>cbb_palette <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb83-56"><a href="#cb83-56" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#000000"</span>, <span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>, <span class="st">"#009E73"</span>, <span class="st">"#F0E442"</span>,</span>
<span id="cb83-57"><a href="#cb83-57" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#0072B2"</span>, <span class="st">"#D55E00"</span>, <span class="st">"#CC79A7"</span></span>
<span id="cb83-58"><a href="#cb83-58" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-59"><a href="#cb83-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-60"><a href="#cb83-60" aria-hidden="true" tabindex="-1"></a><span class="do">## Avoid table wrapping</span></span>
<span id="cb83-61"><a href="#cb83-61" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">width =</span> <span class="dv">800</span>)</span>
<span id="cb83-62"><a href="#cb83-62" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">999</span>)</span>
<span id="cb83-63"><a href="#cb83-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-64"><a href="#cb83-64" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">"PhillipsKarpEtal_data/funs.r"</span>))</span>
<span id="cb83-65"><a href="#cb83-65" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-66"><a href="#cb83-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-67"><a href="#cb83-67" aria-hidden="true" tabindex="-1"></a>Below results repeat simulations from the paper of *Phillips et al. (2018) PLoS Biol 21(6): e3002129*. Original results simplified by removing the post-hoc and the (pooled) t-test methods of analysing data. Generation of simulated data was modified to use a formal linear model defined as:</span>
<span id="cb83-68"><a href="#cb83-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-69"><a href="#cb83-69" aria-hidden="true" tabindex="-1"></a>$$\mathbf{y} = \mathbf{X}\mathbf{b} + \mathbf{e}$$</span>
<span id="cb83-70"><a href="#cb83-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-71"><a href="#cb83-71" aria-hidden="true" tabindex="-1"></a>with $\mathbf{b}=(\mu,\beta_{Treat},\beta_{Sex},\beta_{Treat:Sex})$ and $\mathbf{e} \sim \mathcal{N}(\mathbf{0}, \mathbf{s})$, with $\mathbf{s}=\sigma\sqrt{\mathbf{1}+\mathbf{X}_{Sex}\cdot\alpha}$ ($\alpha$ quantifies the amount of heteroscedasticity in sex variances, with **SD** $\sigma_{m}=\sigma_{f}\sqrt{1+\alpha}$, or male **variance** being $\alpha\cdot100\%$ greater than female). Regression coefficients ($\mathbf{b}$) are compatible with contrasts (sex/treatment effects) used in Phillips et al. (2023).</span>
<span id="cb83-72"><a href="#cb83-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-73"><a href="#cb83-73" aria-hidden="true" tabindex="-1"></a><span class="fu"># Scenarios from Fig. 3</span></span>
<span id="cb83-74"><a href="#cb83-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-75"><a href="#cb83-75" aria-hidden="true" tabindex="-1"></a><span class="fu">## From original paper</span></span>
<span id="cb83-76"><a href="#cb83-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-77"><a href="#cb83-77" aria-hidden="true" tabindex="-1"></a>**Assuming homoscedasticity of sex variances**</span>
<span id="cb83-78"><a href="#cb83-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-79"><a href="#cb83-79" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb83-80"><a href="#cb83-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-81"><a href="#cb83-81" aria-hidden="true" tabindex="-1"></a><span class="fu">## No sex eff, no ix</span></span>
<span id="cb83-82"><a href="#cb83-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-85"><a href="#cb83-85" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-86"><a href="#cb83-86" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb83-87"><a href="#cb83-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-88"><a href="#cb83-88" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb83-89"><a href="#cb83-89" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-90"><a href="#cb83-90" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-91"><a href="#cb83-91" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-92"><a href="#cb83-92" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-93"><a href="#cb83-93" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-94"><a href="#cb83-94" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-95"><a href="#cb83-95" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb83-96"><a href="#cb83-96" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb83-97"><a href="#cb83-97" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-98"><a href="#cb83-98" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span><span class="dv">0</span></span>
<span id="cb83-99"><a href="#cb83-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-100"><a href="#cb83-100" aria-hidden="true" tabindex="-1"></a>all_effs_sex_none <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-101"><a href="#cb83-101" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-102"><a href="#cb83-102" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-103"><a href="#cb83-103" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-104"><a href="#cb83-104" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-105"><a href="#cb83-105" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-106"><a href="#cb83-106" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-107"><a href="#cb83-107" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-108"><a href="#cb83-108" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-109"><a href="#cb83-109" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-110"><a href="#cb83-110" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-111"><a href="#cb83-111" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-112"><a href="#cb83-112" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-113"><a href="#cb83-113" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-114"><a href="#cb83-114" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-115"><a href="#cb83-115" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-116"><a href="#cb83-116" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-117"><a href="#cb83-117" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-118"><a href="#cb83-118" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-119"><a href="#cb83-119" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-120"><a href="#cb83-120" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-121"><a href="#cb83-121" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-122"><a href="#cb83-122" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-123"><a href="#cb83-123" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-124"><a href="#cb83-124" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-125"><a href="#cb83-125" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-126"><a href="#cb83-126" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-127"><a href="#cb83-127" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-128"><a href="#cb83-128" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-129"><a href="#cb83-129" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-130"><a href="#cb83-130" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-131"><a href="#cb83-131" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-132"><a href="#cb83-132" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-133"><a href="#cb83-133" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-134"><a href="#cb83-134" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-135"><a href="#cb83-135" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-136"><a href="#cb83-136" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-137"><a href="#cb83-137" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-138"><a href="#cb83-138" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-139"><a href="#cb83-139" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-140"><a href="#cb83-140" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-141"><a href="#cb83-141" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-142"><a href="#cb83-142" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-143"><a href="#cb83-143" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-144"><a href="#cb83-144" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-145"><a href="#cb83-145" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-146"><a href="#cb83-146" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-147"><a href="#cb83-147" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-148"><a href="#cb83-148" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-149"><a href="#cb83-149" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-150"><a href="#cb83-150" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-151"><a href="#cb83-151" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-152"><a href="#cb83-152" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-153"><a href="#cb83-153" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-154"><a href="#cb83-154" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-155"><a href="#cb83-155" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-156"><a href="#cb83-156" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-157"><a href="#cb83-157" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-158"><a href="#cb83-158" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-159"><a href="#cb83-159" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-160"><a href="#cb83-160" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-161"><a href="#cb83-161" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-162"><a href="#cb83-162" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-163"><a href="#cb83-163" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-164"><a href="#cb83-164" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-165"><a href="#cb83-165" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-166"><a href="#cb83-166" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-167"><a href="#cb83-167" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-168"><a href="#cb83-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-169"><a href="#cb83-169" aria-hidden="true" tabindex="-1"></a>calc_power_sex_none <span class="ot">&lt;-</span> all_effs_sex_none <span class="sc">%&gt;%</span></span>
<span id="cb83-170"><a href="#cb83-170" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-171"><a href="#cb83-171" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb83-172"><a href="#cb83-172" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb83-173"><a href="#cb83-173" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"none"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-174"><a href="#cb83-174" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"none"</span>))</span>
<span id="cb83-175"><a href="#cb83-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-176"><a href="#cb83-176" aria-hidden="true" tabindex="-1"></a>calc_power_sex_none <span class="sc">%&gt;%</span></span>
<span id="cb83-177"><a href="#cb83-177" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-178"><a href="#cb83-178" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-179"><a href="#cb83-179" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-180"><a href="#cb83-180" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb83-181"><a href="#cb83-181" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-182"><a href="#cb83-182" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-183"><a href="#cb83-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-184"><a href="#cb83-184" aria-hidden="true" tabindex="-1"></a><span class="fu">## Small sex eff, no ix</span></span>
<span id="cb83-185"><a href="#cb83-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-188"><a href="#cb83-188" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-189"><a href="#cb83-189" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb83-190"><a href="#cb83-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-191"><a href="#cb83-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-192"><a href="#cb83-192" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb83-193"><a href="#cb83-193" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-194"><a href="#cb83-194" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-195"><a href="#cb83-195" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-196"><a href="#cb83-196" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-197"><a href="#cb83-197" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-198"><a href="#cb83-198" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-199"><a href="#cb83-199" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb83-200"><a href="#cb83-200" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb83-201"><a href="#cb83-201" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-202"><a href="#cb83-202" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-203"><a href="#cb83-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-204"><a href="#cb83-204" aria-hidden="true" tabindex="-1"></a>all_effs_sex_small <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-205"><a href="#cb83-205" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-206"><a href="#cb83-206" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-207"><a href="#cb83-207" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-208"><a href="#cb83-208" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-209"><a href="#cb83-209" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-210"><a href="#cb83-210" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-211"><a href="#cb83-211" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-212"><a href="#cb83-212" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-213"><a href="#cb83-213" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-214"><a href="#cb83-214" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-215"><a href="#cb83-215" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-216"><a href="#cb83-216" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-217"><a href="#cb83-217" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-218"><a href="#cb83-218" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-219"><a href="#cb83-219" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-220"><a href="#cb83-220" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-221"><a href="#cb83-221" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-222"><a href="#cb83-222" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-223"><a href="#cb83-223" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-224"><a href="#cb83-224" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-225"><a href="#cb83-225" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-226"><a href="#cb83-226" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-227"><a href="#cb83-227" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-228"><a href="#cb83-228" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-229"><a href="#cb83-229" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-230"><a href="#cb83-230" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-231"><a href="#cb83-231" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-232"><a href="#cb83-232" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-233"><a href="#cb83-233" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-234"><a href="#cb83-234" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-235"><a href="#cb83-235" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-236"><a href="#cb83-236" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-237"><a href="#cb83-237" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-238"><a href="#cb83-238" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-239"><a href="#cb83-239" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-240"><a href="#cb83-240" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-241"><a href="#cb83-241" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-242"><a href="#cb83-242" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-243"><a href="#cb83-243" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-244"><a href="#cb83-244" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-245"><a href="#cb83-245" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-246"><a href="#cb83-246" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-247"><a href="#cb83-247" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-248"><a href="#cb83-248" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-249"><a href="#cb83-249" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-250"><a href="#cb83-250" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-251"><a href="#cb83-251" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-252"><a href="#cb83-252" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-253"><a href="#cb83-253" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-254"><a href="#cb83-254" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-255"><a href="#cb83-255" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-256"><a href="#cb83-256" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-257"><a href="#cb83-257" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-258"><a href="#cb83-258" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-259"><a href="#cb83-259" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-260"><a href="#cb83-260" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-261"><a href="#cb83-261" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-262"><a href="#cb83-262" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-263"><a href="#cb83-263" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-264"><a href="#cb83-264" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-265"><a href="#cb83-265" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-266"><a href="#cb83-266" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-267"><a href="#cb83-267" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-268"><a href="#cb83-268" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-269"><a href="#cb83-269" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-270"><a href="#cb83-270" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-271"><a href="#cb83-271" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-272"><a href="#cb83-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-273"><a href="#cb83-273" aria-hidden="true" tabindex="-1"></a>calc_power_sex_small <span class="ot">&lt;-</span> all_effs_sex_small <span class="sc">%&gt;%</span></span>
<span id="cb83-274"><a href="#cb83-274" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-275"><a href="#cb83-275" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb83-276"><a href="#cb83-276" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb83-277"><a href="#cb83-277" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"small"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-278"><a href="#cb83-278" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"none"</span>))</span>
<span id="cb83-279"><a href="#cb83-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-280"><a href="#cb83-280" aria-hidden="true" tabindex="-1"></a>calc_power_sex_small <span class="sc">%&gt;%</span></span>
<span id="cb83-281"><a href="#cb83-281" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-282"><a href="#cb83-282" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-283"><a href="#cb83-283" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-284"><a href="#cb83-284" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb83-285"><a href="#cb83-285" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-286"><a href="#cb83-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-287"><a href="#cb83-287" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-288"><a href="#cb83-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-289"><a href="#cb83-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-290"><a href="#cb83-290" aria-hidden="true" tabindex="-1"></a><span class="fu">## Large sex eff, no ix</span></span>
<span id="cb83-291"><a href="#cb83-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-294"><a href="#cb83-294" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-295"><a href="#cb83-295" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb83-296"><a href="#cb83-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-297"><a href="#cb83-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-298"><a href="#cb83-298" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb83-299"><a href="#cb83-299" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-300"><a href="#cb83-300" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-301"><a href="#cb83-301" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-302"><a href="#cb83-302" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-303"><a href="#cb83-303" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-304"><a href="#cb83-304" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-305"><a href="#cb83-305" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb83-306"><a href="#cb83-306" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb83-307"><a href="#cb83-307" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-308"><a href="#cb83-308" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-309"><a href="#cb83-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-310"><a href="#cb83-310" aria-hidden="true" tabindex="-1"></a>all_effs_sex_large <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-311"><a href="#cb83-311" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-312"><a href="#cb83-312" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-313"><a href="#cb83-313" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-314"><a href="#cb83-314" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-315"><a href="#cb83-315" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-316"><a href="#cb83-316" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-317"><a href="#cb83-317" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-318"><a href="#cb83-318" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-319"><a href="#cb83-319" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-320"><a href="#cb83-320" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-321"><a href="#cb83-321" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-322"><a href="#cb83-322" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-323"><a href="#cb83-323" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-324"><a href="#cb83-324" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-325"><a href="#cb83-325" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-326"><a href="#cb83-326" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-327"><a href="#cb83-327" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-328"><a href="#cb83-328" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-329"><a href="#cb83-329" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-330"><a href="#cb83-330" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-331"><a href="#cb83-331" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-332"><a href="#cb83-332" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-333"><a href="#cb83-333" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-334"><a href="#cb83-334" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-335"><a href="#cb83-335" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-336"><a href="#cb83-336" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-337"><a href="#cb83-337" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-338"><a href="#cb83-338" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-339"><a href="#cb83-339" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-340"><a href="#cb83-340" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-341"><a href="#cb83-341" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-342"><a href="#cb83-342" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-343"><a href="#cb83-343" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-344"><a href="#cb83-344" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-345"><a href="#cb83-345" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-346"><a href="#cb83-346" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-347"><a href="#cb83-347" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-348"><a href="#cb83-348" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-349"><a href="#cb83-349" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-350"><a href="#cb83-350" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-351"><a href="#cb83-351" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-352"><a href="#cb83-352" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-353"><a href="#cb83-353" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-354"><a href="#cb83-354" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-355"><a href="#cb83-355" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-356"><a href="#cb83-356" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-357"><a href="#cb83-357" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-358"><a href="#cb83-358" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-359"><a href="#cb83-359" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-360"><a href="#cb83-360" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-361"><a href="#cb83-361" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-362"><a href="#cb83-362" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-363"><a href="#cb83-363" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-364"><a href="#cb83-364" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-365"><a href="#cb83-365" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-366"><a href="#cb83-366" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-367"><a href="#cb83-367" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-368"><a href="#cb83-368" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-369"><a href="#cb83-369" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-370"><a href="#cb83-370" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-371"><a href="#cb83-371" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-372"><a href="#cb83-372" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-373"><a href="#cb83-373" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-374"><a href="#cb83-374" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-375"><a href="#cb83-375" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-376"><a href="#cb83-376" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-377"><a href="#cb83-377" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-378"><a href="#cb83-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-379"><a href="#cb83-379" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large <span class="ot">&lt;-</span> all_effs_sex_large <span class="sc">%&gt;%</span></span>
<span id="cb83-380"><a href="#cb83-380" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-381"><a href="#cb83-381" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb83-382"><a href="#cb83-382" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb83-383"><a href="#cb83-383" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-384"><a href="#cb83-384" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"none"</span>))</span>
<span id="cb83-385"><a href="#cb83-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-386"><a href="#cb83-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-387"><a href="#cb83-387" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large <span class="sc">%&gt;%</span></span>
<span id="cb83-388"><a href="#cb83-388" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-389"><a href="#cb83-389" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-390"><a href="#cb83-390" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-391"><a href="#cb83-391" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb83-392"><a href="#cb83-392" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-393"><a href="#cb83-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-394"><a href="#cb83-394" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-395"><a href="#cb83-395" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb83-396"><a href="#cb83-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-397"><a href="#cb83-397" aria-hidden="true" tabindex="-1"></a>Plots combining all scenarios from Fig. 1</span>
<span id="cb83-398"><a href="#cb83-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-401"><a href="#cb83-401" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-402"><a href="#cb83-402" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb83-403"><a href="#cb83-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-404"><a href="#cb83-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-405"><a href="#cb83-405" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="ot">&lt;-</span> <span class="fu">rbind</span>(calc_power_sex_none, calc_power_sex_small,</span>
<span id="cb83-406"><a href="#cb83-406" aria-hidden="true" tabindex="-1"></a>                               calc_power_sex_large)</span>
<span id="cb83-407"><a href="#cb83-407" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">lapply</span>(all_sex_effs_sex_only, unlist))</span>
<span id="cb83-408"><a href="#cb83-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-409"><a href="#cb83-409" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="sc">%&gt;%</span></span>
<span id="cb83-410"><a href="#cb83-410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Effect <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Treatment"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-411"><a href="#cb83-411" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">factor</span>(sex_eff_size,</span>
<span id="cb83-412"><a href="#cb83-412" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"none"</span>, <span class="st">"small"</span>, <span class="st">"large"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb83-413"><a href="#cb83-413" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">recode</span>(method,</span>
<span id="cb83-414"><a href="#cb83-414" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"ANOVA"</span> <span class="ot">=</span> <span class="st">"Factorial"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-415"><a href="#cb83-415" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> sex_eff_size,</span>
<span id="cb83-416"><a href="#cb83-416" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> <span class="fu">interaction</span>(sex_eff_size, method))) <span class="sc">+</span></span>
<span id="cb83-417"><a href="#cb83-417" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-418"><a href="#cb83-418" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> method)) <span class="sc">+</span></span>
<span id="cb83-419"><a href="#cb83-419" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb83-420"><a href="#cb83-420" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Statistical power"</span>) <span class="sc">+</span></span>
<span id="cb83-421"><a href="#cb83-421" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Main treatment effect"</span>) <span class="sc">+</span></span>
<span id="cb83-422"><a href="#cb83-422" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">name =</span> <span class="st">"Sex effect size"</span>, <span class="at">values =</span> cbb_palette) <span class="sc">+</span></span>
<span id="cb83-423"><a href="#cb83-423" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_discrete</span>(<span class="at">name =</span> <span class="st">"Stat method"</span>)  <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-424"><a href="#cb83-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-425"><a href="#cb83-425" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="sc">%&gt;%</span></span>
<span id="cb83-426"><a href="#cb83-426" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(!Effect %in% c("T-Test Treatment Eff")) %&gt;%</span></span>
<span id="cb83-427"><a href="#cb83-427" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">factor</span>(sex_eff_size,</span>
<span id="cb83-428"><a href="#cb83-428" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"none"</span>, <span class="st">"small"</span>, <span class="st">"large"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb83-429"><a href="#cb83-429" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect,</span>
<span id="cb83-430"><a href="#cb83-430" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> <span class="fu">interaction</span>(sex_eff_size, Effect))) <span class="sc">+</span></span>
<span id="cb83-431"><a href="#cb83-431" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-432"><a href="#cb83-432" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> sex_eff_size)) <span class="sc">+</span></span>
<span id="cb83-433"><a href="#cb83-433" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb83-434"><a href="#cb83-434" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Statistical power"</span>) <span class="sc">+</span></span>
<span id="cb83-435"><a href="#cb83-435" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Main treatment effect"</span>) <span class="sc">+</span></span>
<span id="cb83-436"><a href="#cb83-436" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">name =</span> <span class="st">"Effect"</span>, <span class="at">values =</span> cbb_palette) <span class="sc">+</span></span>
<span id="cb83-437"><a href="#cb83-437" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_discrete</span>(<span class="at">name =</span> <span class="st">"Sex effect size"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-438"><a href="#cb83-438" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-439"><a href="#cb83-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-440"><a href="#cb83-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-441"><a href="#cb83-441" aria-hidden="true" tabindex="-1"></a><span class="fu">## Heteroscedastic sex variances {#sec-powerbreakdown}</span></span>
<span id="cb83-442"><a href="#cb83-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-443"><a href="#cb83-443" aria-hidden="true" tabindex="-1"></a>We assume several scenarios with $\alpha$ equal to 0 (the above scenarios), 1 and 2, which relates to 100% or 200% increase in male variance, in relation to female variance (or ~44% and ~73% increase in male SD). The direction of sex bias is arbitrary.</span>
<span id="cb83-444"><a href="#cb83-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-445"><a href="#cb83-445" aria-hidden="true" tabindex="-1"></a>**Low heteroscedasticity**</span>
<span id="cb83-446"><a href="#cb83-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-449"><a href="#cb83-449" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-450"><a href="#cb83-450" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-451"><a href="#cb83-451" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-452"><a href="#cb83-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-453"><a href="#cb83-453" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb83-454"><a href="#cb83-454" aria-hidden="true" tabindex="-1"></a><span class="fu">## No sex eff, no ix</span></span>
<span id="cb83-455"><a href="#cb83-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-458"><a href="#cb83-458" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-459"><a href="#cb83-459" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb83-460"><a href="#cb83-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-461"><a href="#cb83-461" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb83-462"><a href="#cb83-462" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-463"><a href="#cb83-463" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-464"><a href="#cb83-464" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-465"><a href="#cb83-465" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-466"><a href="#cb83-466" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-467"><a href="#cb83-467" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-468"><a href="#cb83-468" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb83-469"><a href="#cb83-469" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb83-470"><a href="#cb83-470" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-471"><a href="#cb83-471" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb83-472"><a href="#cb83-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-473"><a href="#cb83-473" aria-hidden="true" tabindex="-1"></a>all_effs_sex_none_lowh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-474"><a href="#cb83-474" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-475"><a href="#cb83-475" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-476"><a href="#cb83-476" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-477"><a href="#cb83-477" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-478"><a href="#cb83-478" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-479"><a href="#cb83-479" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-480"><a href="#cb83-480" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-481"><a href="#cb83-481" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-482"><a href="#cb83-482" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-483"><a href="#cb83-483" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-484"><a href="#cb83-484" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-485"><a href="#cb83-485" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-486"><a href="#cb83-486" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-487"><a href="#cb83-487" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-488"><a href="#cb83-488" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-489"><a href="#cb83-489" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-490"><a href="#cb83-490" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-491"><a href="#cb83-491" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-492"><a href="#cb83-492" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-493"><a href="#cb83-493" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-494"><a href="#cb83-494" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-495"><a href="#cb83-495" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-496"><a href="#cb83-496" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-497"><a href="#cb83-497" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-498"><a href="#cb83-498" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-499"><a href="#cb83-499" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-500"><a href="#cb83-500" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-501"><a href="#cb83-501" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-502"><a href="#cb83-502" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-503"><a href="#cb83-503" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-504"><a href="#cb83-504" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-505"><a href="#cb83-505" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-506"><a href="#cb83-506" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-507"><a href="#cb83-507" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-508"><a href="#cb83-508" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-509"><a href="#cb83-509" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-510"><a href="#cb83-510" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-511"><a href="#cb83-511" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-512"><a href="#cb83-512" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-513"><a href="#cb83-513" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-514"><a href="#cb83-514" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-515"><a href="#cb83-515" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-516"><a href="#cb83-516" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-517"><a href="#cb83-517" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-518"><a href="#cb83-518" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-519"><a href="#cb83-519" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-520"><a href="#cb83-520" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-521"><a href="#cb83-521" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-522"><a href="#cb83-522" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-523"><a href="#cb83-523" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-524"><a href="#cb83-524" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-525"><a href="#cb83-525" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-526"><a href="#cb83-526" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-527"><a href="#cb83-527" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-528"><a href="#cb83-528" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-529"><a href="#cb83-529" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-530"><a href="#cb83-530" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-531"><a href="#cb83-531" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-532"><a href="#cb83-532" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-533"><a href="#cb83-533" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-534"><a href="#cb83-534" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-535"><a href="#cb83-535" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-536"><a href="#cb83-536" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-537"><a href="#cb83-537" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-538"><a href="#cb83-538" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-539"><a href="#cb83-539" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-540"><a href="#cb83-540" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-541"><a href="#cb83-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-542"><a href="#cb83-542" aria-hidden="true" tabindex="-1"></a>calc_power_sex_none_lowh <span class="ot">&lt;-</span> all_effs_sex_none_lowh <span class="sc">%&gt;%</span></span>
<span id="cb83-543"><a href="#cb83-543" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-544"><a href="#cb83-544" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb83-545"><a href="#cb83-545" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb83-546"><a href="#cb83-546" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"none"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-547"><a href="#cb83-547" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"low"</span>))</span>
<span id="cb83-548"><a href="#cb83-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-549"><a href="#cb83-549" aria-hidden="true" tabindex="-1"></a>calc_power_sex_none_lowh <span class="sc">%&gt;%</span></span>
<span id="cb83-550"><a href="#cb83-550" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-551"><a href="#cb83-551" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-552"><a href="#cb83-552" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-553"><a href="#cb83-553" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb83-554"><a href="#cb83-554" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-555"><a href="#cb83-555" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-556"><a href="#cb83-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-557"><a href="#cb83-557" aria-hidden="true" tabindex="-1"></a><span class="fu">## Small sex eff, no ix</span></span>
<span id="cb83-558"><a href="#cb83-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-561"><a href="#cb83-561" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-562"><a href="#cb83-562" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb83-563"><a href="#cb83-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-564"><a href="#cb83-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-565"><a href="#cb83-565" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb83-566"><a href="#cb83-566" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-567"><a href="#cb83-567" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-568"><a href="#cb83-568" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-569"><a href="#cb83-569" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-570"><a href="#cb83-570" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-571"><a href="#cb83-571" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-572"><a href="#cb83-572" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb83-573"><a href="#cb83-573" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb83-574"><a href="#cb83-574" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-575"><a href="#cb83-575" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb83-576"><a href="#cb83-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-577"><a href="#cb83-577" aria-hidden="true" tabindex="-1"></a>all_effs_sex_small_lowh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-578"><a href="#cb83-578" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-579"><a href="#cb83-579" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-580"><a href="#cb83-580" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-581"><a href="#cb83-581" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-582"><a href="#cb83-582" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-583"><a href="#cb83-583" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-584"><a href="#cb83-584" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-585"><a href="#cb83-585" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-586"><a href="#cb83-586" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-587"><a href="#cb83-587" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-588"><a href="#cb83-588" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-589"><a href="#cb83-589" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-590"><a href="#cb83-590" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-591"><a href="#cb83-591" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-592"><a href="#cb83-592" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-593"><a href="#cb83-593" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-594"><a href="#cb83-594" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-595"><a href="#cb83-595" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-596"><a href="#cb83-596" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-597"><a href="#cb83-597" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-598"><a href="#cb83-598" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-599"><a href="#cb83-599" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-600"><a href="#cb83-600" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-601"><a href="#cb83-601" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-602"><a href="#cb83-602" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-603"><a href="#cb83-603" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-604"><a href="#cb83-604" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-605"><a href="#cb83-605" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-606"><a href="#cb83-606" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-607"><a href="#cb83-607" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-608"><a href="#cb83-608" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-609"><a href="#cb83-609" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-610"><a href="#cb83-610" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-611"><a href="#cb83-611" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-612"><a href="#cb83-612" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-613"><a href="#cb83-613" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-614"><a href="#cb83-614" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-615"><a href="#cb83-615" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-616"><a href="#cb83-616" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-617"><a href="#cb83-617" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-618"><a href="#cb83-618" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-619"><a href="#cb83-619" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-620"><a href="#cb83-620" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-621"><a href="#cb83-621" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-622"><a href="#cb83-622" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-623"><a href="#cb83-623" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-624"><a href="#cb83-624" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-625"><a href="#cb83-625" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-626"><a href="#cb83-626" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-627"><a href="#cb83-627" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-628"><a href="#cb83-628" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-629"><a href="#cb83-629" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-630"><a href="#cb83-630" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-631"><a href="#cb83-631" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-632"><a href="#cb83-632" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-633"><a href="#cb83-633" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-634"><a href="#cb83-634" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-635"><a href="#cb83-635" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-636"><a href="#cb83-636" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-637"><a href="#cb83-637" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-638"><a href="#cb83-638" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-639"><a href="#cb83-639" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-640"><a href="#cb83-640" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-641"><a href="#cb83-641" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-642"><a href="#cb83-642" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-643"><a href="#cb83-643" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-644"><a href="#cb83-644" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-645"><a href="#cb83-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-646"><a href="#cb83-646" aria-hidden="true" tabindex="-1"></a>calc_power_sex_small_lowh <span class="ot">&lt;-</span> all_effs_sex_small_lowh <span class="sc">%&gt;%</span></span>
<span id="cb83-647"><a href="#cb83-647" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-648"><a href="#cb83-648" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb83-649"><a href="#cb83-649" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb83-650"><a href="#cb83-650" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"small"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-651"><a href="#cb83-651" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"low"</span>))</span>
<span id="cb83-652"><a href="#cb83-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-653"><a href="#cb83-653" aria-hidden="true" tabindex="-1"></a>calc_power_sex_small_lowh <span class="sc">%&gt;%</span></span>
<span id="cb83-654"><a href="#cb83-654" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-655"><a href="#cb83-655" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-656"><a href="#cb83-656" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-657"><a href="#cb83-657" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb83-658"><a href="#cb83-658" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-659"><a href="#cb83-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-660"><a href="#cb83-660" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-661"><a href="#cb83-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-662"><a href="#cb83-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-663"><a href="#cb83-663" aria-hidden="true" tabindex="-1"></a><span class="fu">## Large sex eff, no ix</span></span>
<span id="cb83-664"><a href="#cb83-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-667"><a href="#cb83-667" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-668"><a href="#cb83-668" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb83-669"><a href="#cb83-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-670"><a href="#cb83-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-671"><a href="#cb83-671" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb83-672"><a href="#cb83-672" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-673"><a href="#cb83-673" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-674"><a href="#cb83-674" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-675"><a href="#cb83-675" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-676"><a href="#cb83-676" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-677"><a href="#cb83-677" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-678"><a href="#cb83-678" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb83-679"><a href="#cb83-679" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb83-680"><a href="#cb83-680" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-681"><a href="#cb83-681" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb83-682"><a href="#cb83-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-683"><a href="#cb83-683" aria-hidden="true" tabindex="-1"></a>all_effs_sex_large_lowh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-684"><a href="#cb83-684" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-685"><a href="#cb83-685" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-686"><a href="#cb83-686" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-687"><a href="#cb83-687" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-688"><a href="#cb83-688" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-689"><a href="#cb83-689" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-690"><a href="#cb83-690" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-691"><a href="#cb83-691" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-692"><a href="#cb83-692" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-693"><a href="#cb83-693" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-694"><a href="#cb83-694" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-695"><a href="#cb83-695" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-696"><a href="#cb83-696" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-697"><a href="#cb83-697" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-698"><a href="#cb83-698" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-699"><a href="#cb83-699" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-700"><a href="#cb83-700" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-701"><a href="#cb83-701" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-702"><a href="#cb83-702" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-703"><a href="#cb83-703" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-704"><a href="#cb83-704" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-705"><a href="#cb83-705" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-706"><a href="#cb83-706" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-707"><a href="#cb83-707" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-708"><a href="#cb83-708" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-709"><a href="#cb83-709" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-710"><a href="#cb83-710" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-711"><a href="#cb83-711" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-712"><a href="#cb83-712" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-713"><a href="#cb83-713" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-714"><a href="#cb83-714" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-715"><a href="#cb83-715" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-716"><a href="#cb83-716" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-717"><a href="#cb83-717" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-718"><a href="#cb83-718" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-719"><a href="#cb83-719" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-720"><a href="#cb83-720" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-721"><a href="#cb83-721" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-722"><a href="#cb83-722" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-723"><a href="#cb83-723" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-724"><a href="#cb83-724" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-725"><a href="#cb83-725" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-726"><a href="#cb83-726" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-727"><a href="#cb83-727" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-728"><a href="#cb83-728" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-729"><a href="#cb83-729" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-730"><a href="#cb83-730" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-731"><a href="#cb83-731" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-732"><a href="#cb83-732" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-733"><a href="#cb83-733" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-734"><a href="#cb83-734" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-735"><a href="#cb83-735" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-736"><a href="#cb83-736" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-737"><a href="#cb83-737" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-738"><a href="#cb83-738" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-739"><a href="#cb83-739" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-740"><a href="#cb83-740" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-741"><a href="#cb83-741" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-742"><a href="#cb83-742" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-743"><a href="#cb83-743" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-744"><a href="#cb83-744" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-745"><a href="#cb83-745" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-746"><a href="#cb83-746" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-747"><a href="#cb83-747" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-748"><a href="#cb83-748" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-749"><a href="#cb83-749" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-750"><a href="#cb83-750" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-751"><a href="#cb83-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-752"><a href="#cb83-752" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large_lowh <span class="ot">&lt;-</span> all_effs_sex_large_lowh <span class="sc">%&gt;%</span></span>
<span id="cb83-753"><a href="#cb83-753" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-754"><a href="#cb83-754" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb83-755"><a href="#cb83-755" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb83-756"><a href="#cb83-756" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-757"><a href="#cb83-757" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"low"</span>))</span>
<span id="cb83-758"><a href="#cb83-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-759"><a href="#cb83-759" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large_lowh <span class="sc">%&gt;%</span></span>
<span id="cb83-760"><a href="#cb83-760" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-761"><a href="#cb83-761" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-762"><a href="#cb83-762" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-763"><a href="#cb83-763" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb83-764"><a href="#cb83-764" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-765"><a href="#cb83-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-766"><a href="#cb83-766" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-767"><a href="#cb83-767" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb83-768"><a href="#cb83-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-769"><a href="#cb83-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-770"><a href="#cb83-770" aria-hidden="true" tabindex="-1"></a>**Large heteroscedasticity**</span>
<span id="cb83-771"><a href="#cb83-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-774"><a href="#cb83-774" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-775"><a href="#cb83-775" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb83-776"><a href="#cb83-776" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-777"><a href="#cb83-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-778"><a href="#cb83-778" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb83-779"><a href="#cb83-779" aria-hidden="true" tabindex="-1"></a><span class="fu">## No sex eff, no ix</span></span>
<span id="cb83-780"><a href="#cb83-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-783"><a href="#cb83-783" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-784"><a href="#cb83-784" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb83-785"><a href="#cb83-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-786"><a href="#cb83-786" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb83-787"><a href="#cb83-787" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-788"><a href="#cb83-788" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-789"><a href="#cb83-789" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-790"><a href="#cb83-790" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-791"><a href="#cb83-791" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-792"><a href="#cb83-792" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-793"><a href="#cb83-793" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb83-794"><a href="#cb83-794" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb83-795"><a href="#cb83-795" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-796"><a href="#cb83-796" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb83-797"><a href="#cb83-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-798"><a href="#cb83-798" aria-hidden="true" tabindex="-1"></a>all_effs_sex_none_largeh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-799"><a href="#cb83-799" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-800"><a href="#cb83-800" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-801"><a href="#cb83-801" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-802"><a href="#cb83-802" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-803"><a href="#cb83-803" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-804"><a href="#cb83-804" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-805"><a href="#cb83-805" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-806"><a href="#cb83-806" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-807"><a href="#cb83-807" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-808"><a href="#cb83-808" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-809"><a href="#cb83-809" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-810"><a href="#cb83-810" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-811"><a href="#cb83-811" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-812"><a href="#cb83-812" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-813"><a href="#cb83-813" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-814"><a href="#cb83-814" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-815"><a href="#cb83-815" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-816"><a href="#cb83-816" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-817"><a href="#cb83-817" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-818"><a href="#cb83-818" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-819"><a href="#cb83-819" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-820"><a href="#cb83-820" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-821"><a href="#cb83-821" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-822"><a href="#cb83-822" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-823"><a href="#cb83-823" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-824"><a href="#cb83-824" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-825"><a href="#cb83-825" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-826"><a href="#cb83-826" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-827"><a href="#cb83-827" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-828"><a href="#cb83-828" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-829"><a href="#cb83-829" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-830"><a href="#cb83-830" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-831"><a href="#cb83-831" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-832"><a href="#cb83-832" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-833"><a href="#cb83-833" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-834"><a href="#cb83-834" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-835"><a href="#cb83-835" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-836"><a href="#cb83-836" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-837"><a href="#cb83-837" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-838"><a href="#cb83-838" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-839"><a href="#cb83-839" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-840"><a href="#cb83-840" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-841"><a href="#cb83-841" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-842"><a href="#cb83-842" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-843"><a href="#cb83-843" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-844"><a href="#cb83-844" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-845"><a href="#cb83-845" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-846"><a href="#cb83-846" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-847"><a href="#cb83-847" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-848"><a href="#cb83-848" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-849"><a href="#cb83-849" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-850"><a href="#cb83-850" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-851"><a href="#cb83-851" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-852"><a href="#cb83-852" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-853"><a href="#cb83-853" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-854"><a href="#cb83-854" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-855"><a href="#cb83-855" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-856"><a href="#cb83-856" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-857"><a href="#cb83-857" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-858"><a href="#cb83-858" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-859"><a href="#cb83-859" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-860"><a href="#cb83-860" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-861"><a href="#cb83-861" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-862"><a href="#cb83-862" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-863"><a href="#cb83-863" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-864"><a href="#cb83-864" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-865"><a href="#cb83-865" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-866"><a href="#cb83-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-867"><a href="#cb83-867" aria-hidden="true" tabindex="-1"></a>calc_power_sex_none_largeh <span class="ot">&lt;-</span> all_effs_sex_none_largeh <span class="sc">%&gt;%</span></span>
<span id="cb83-868"><a href="#cb83-868" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-869"><a href="#cb83-869" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb83-870"><a href="#cb83-870" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb83-871"><a href="#cb83-871" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"none"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-872"><a href="#cb83-872" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"large"</span>))</span>
<span id="cb83-873"><a href="#cb83-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-874"><a href="#cb83-874" aria-hidden="true" tabindex="-1"></a>calc_power_sex_none_largeh <span class="sc">%&gt;%</span></span>
<span id="cb83-875"><a href="#cb83-875" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-876"><a href="#cb83-876" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-877"><a href="#cb83-877" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-878"><a href="#cb83-878" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb83-879"><a href="#cb83-879" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-880"><a href="#cb83-880" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-881"><a href="#cb83-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-882"><a href="#cb83-882" aria-hidden="true" tabindex="-1"></a><span class="fu">## Small sex eff, no ix</span></span>
<span id="cb83-883"><a href="#cb83-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-886"><a href="#cb83-886" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-887"><a href="#cb83-887" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb83-888"><a href="#cb83-888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-889"><a href="#cb83-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-890"><a href="#cb83-890" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb83-891"><a href="#cb83-891" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-892"><a href="#cb83-892" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-893"><a href="#cb83-893" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-894"><a href="#cb83-894" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-895"><a href="#cb83-895" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-896"><a href="#cb83-896" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-897"><a href="#cb83-897" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb83-898"><a href="#cb83-898" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb83-899"><a href="#cb83-899" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-900"><a href="#cb83-900" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb83-901"><a href="#cb83-901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-902"><a href="#cb83-902" aria-hidden="true" tabindex="-1"></a>all_effs_sex_small_largeh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-903"><a href="#cb83-903" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-904"><a href="#cb83-904" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-905"><a href="#cb83-905" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-906"><a href="#cb83-906" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-907"><a href="#cb83-907" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-908"><a href="#cb83-908" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-909"><a href="#cb83-909" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-910"><a href="#cb83-910" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-911"><a href="#cb83-911" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-912"><a href="#cb83-912" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-913"><a href="#cb83-913" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-914"><a href="#cb83-914" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-915"><a href="#cb83-915" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-916"><a href="#cb83-916" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-917"><a href="#cb83-917" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-918"><a href="#cb83-918" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-919"><a href="#cb83-919" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-920"><a href="#cb83-920" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-921"><a href="#cb83-921" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-922"><a href="#cb83-922" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-923"><a href="#cb83-923" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-924"><a href="#cb83-924" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-925"><a href="#cb83-925" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-926"><a href="#cb83-926" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-927"><a href="#cb83-927" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-928"><a href="#cb83-928" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-929"><a href="#cb83-929" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-930"><a href="#cb83-930" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-931"><a href="#cb83-931" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-932"><a href="#cb83-932" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-933"><a href="#cb83-933" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-934"><a href="#cb83-934" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-935"><a href="#cb83-935" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-936"><a href="#cb83-936" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-937"><a href="#cb83-937" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-938"><a href="#cb83-938" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-939"><a href="#cb83-939" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-940"><a href="#cb83-940" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-941"><a href="#cb83-941" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-942"><a href="#cb83-942" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-943"><a href="#cb83-943" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-944"><a href="#cb83-944" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-945"><a href="#cb83-945" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-946"><a href="#cb83-946" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-947"><a href="#cb83-947" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-948"><a href="#cb83-948" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-949"><a href="#cb83-949" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-950"><a href="#cb83-950" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-951"><a href="#cb83-951" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-952"><a href="#cb83-952" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-953"><a href="#cb83-953" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-954"><a href="#cb83-954" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-955"><a href="#cb83-955" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-956"><a href="#cb83-956" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-957"><a href="#cb83-957" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-958"><a href="#cb83-958" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-959"><a href="#cb83-959" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-960"><a href="#cb83-960" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-961"><a href="#cb83-961" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-962"><a href="#cb83-962" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-963"><a href="#cb83-963" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-964"><a href="#cb83-964" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-965"><a href="#cb83-965" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-966"><a href="#cb83-966" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-967"><a href="#cb83-967" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-968"><a href="#cb83-968" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-969"><a href="#cb83-969" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-970"><a href="#cb83-970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-971"><a href="#cb83-971" aria-hidden="true" tabindex="-1"></a>calc_power_sex_small_largeh <span class="ot">&lt;-</span> all_effs_sex_small_largeh <span class="sc">%&gt;%</span></span>
<span id="cb83-972"><a href="#cb83-972" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-973"><a href="#cb83-973" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb83-974"><a href="#cb83-974" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb83-975"><a href="#cb83-975" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"small"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-976"><a href="#cb83-976" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"large"</span>))</span>
<span id="cb83-977"><a href="#cb83-977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-978"><a href="#cb83-978" aria-hidden="true" tabindex="-1"></a>calc_power_sex_small_largeh <span class="sc">%&gt;%</span></span>
<span id="cb83-979"><a href="#cb83-979" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-980"><a href="#cb83-980" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-981"><a href="#cb83-981" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-982"><a href="#cb83-982" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb83-983"><a href="#cb83-983" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-984"><a href="#cb83-984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-985"><a href="#cb83-985" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-986"><a href="#cb83-986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-987"><a href="#cb83-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-988"><a href="#cb83-988" aria-hidden="true" tabindex="-1"></a><span class="fu">## Large sex eff, no ix</span></span>
<span id="cb83-989"><a href="#cb83-989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-992"><a href="#cb83-992" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-993"><a href="#cb83-993" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb83-994"><a href="#cb83-994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-995"><a href="#cb83-995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-996"><a href="#cb83-996" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb83-997"><a href="#cb83-997" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-998"><a href="#cb83-998" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-999"><a href="#cb83-999" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-1000"><a href="#cb83-1000" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-1001"><a href="#cb83-1001" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-1002"><a href="#cb83-1002" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-1003"><a href="#cb83-1003" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb83-1004"><a href="#cb83-1004" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb83-1005"><a href="#cb83-1005" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-1006"><a href="#cb83-1006" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb83-1007"><a href="#cb83-1007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1008"><a href="#cb83-1008" aria-hidden="true" tabindex="-1"></a>all_effs_sex_large_largeh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-1009"><a href="#cb83-1009" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1010"><a href="#cb83-1010" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1011"><a href="#cb83-1011" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1012"><a href="#cb83-1012" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1013"><a href="#cb83-1013" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1014"><a href="#cb83-1014" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1015"><a href="#cb83-1015" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1016"><a href="#cb83-1016" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1017"><a href="#cb83-1017" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1018"><a href="#cb83-1018" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1019"><a href="#cb83-1019" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1020"><a href="#cb83-1020" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1021"><a href="#cb83-1021" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1022"><a href="#cb83-1022" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1023"><a href="#cb83-1023" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1024"><a href="#cb83-1024" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1025"><a href="#cb83-1025" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1026"><a href="#cb83-1026" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1027"><a href="#cb83-1027" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1028"><a href="#cb83-1028" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1029"><a href="#cb83-1029" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1030"><a href="#cb83-1030" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1031"><a href="#cb83-1031" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1032"><a href="#cb83-1032" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1033"><a href="#cb83-1033" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1034"><a href="#cb83-1034" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1035"><a href="#cb83-1035" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1036"><a href="#cb83-1036" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1037"><a href="#cb83-1037" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1038"><a href="#cb83-1038" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1039"><a href="#cb83-1039" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1040"><a href="#cb83-1040" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1041"><a href="#cb83-1041" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1042"><a href="#cb83-1042" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1043"><a href="#cb83-1043" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1044"><a href="#cb83-1044" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1045"><a href="#cb83-1045" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1046"><a href="#cb83-1046" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1047"><a href="#cb83-1047" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1048"><a href="#cb83-1048" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1049"><a href="#cb83-1049" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1050"><a href="#cb83-1050" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1051"><a href="#cb83-1051" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1052"><a href="#cb83-1052" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1053"><a href="#cb83-1053" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1054"><a href="#cb83-1054" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1055"><a href="#cb83-1055" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1056"><a href="#cb83-1056" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1057"><a href="#cb83-1057" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1058"><a href="#cb83-1058" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1059"><a href="#cb83-1059" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1060"><a href="#cb83-1060" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1061"><a href="#cb83-1061" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1062"><a href="#cb83-1062" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1063"><a href="#cb83-1063" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1064"><a href="#cb83-1064" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1065"><a href="#cb83-1065" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1066"><a href="#cb83-1066" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1067"><a href="#cb83-1067" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1068"><a href="#cb83-1068" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1069"><a href="#cb83-1069" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1070"><a href="#cb83-1070" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1071"><a href="#cb83-1071" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1072"><a href="#cb83-1072" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1073"><a href="#cb83-1073" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1074"><a href="#cb83-1074" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-1075"><a href="#cb83-1075" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-1076"><a href="#cb83-1076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1077"><a href="#cb83-1077" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large_largeh <span class="ot">&lt;-</span> all_effs_sex_large_largeh <span class="sc">%&gt;%</span></span>
<span id="cb83-1078"><a href="#cb83-1078" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-1079"><a href="#cb83-1079" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb83-1080"><a href="#cb83-1080" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb83-1081"><a href="#cb83-1081" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-1082"><a href="#cb83-1082" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"large"</span>))</span>
<span id="cb83-1083"><a href="#cb83-1083" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1084"><a href="#cb83-1084" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large_largeh <span class="sc">%&gt;%</span></span>
<span id="cb83-1085"><a href="#cb83-1085" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-1086"><a href="#cb83-1086" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-1087"><a href="#cb83-1087" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-1088"><a href="#cb83-1088" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb83-1089"><a href="#cb83-1089" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-1090"><a href="#cb83-1090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1091"><a href="#cb83-1091" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-1092"><a href="#cb83-1092" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb83-1093"><a href="#cb83-1093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1094"><a href="#cb83-1094" aria-hidden="true" tabindex="-1"></a>It should be of note that evolutionary biology has seen heteroscedasticities exceeding 100% in variance ration between sexes. Combined results below show the impact of heteroscedasticity.</span>
<span id="cb83-1095"><a href="#cb83-1095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1098"><a href="#cb83-1098" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-1099"><a href="#cb83-1099" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb83-1100"><a href="#cb83-1100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1101"><a href="#cb83-1101" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="ot">&lt;-</span> <span class="fu">rbind</span>(calc_power_sex_small,</span>
<span id="cb83-1102"><a href="#cb83-1102" aria-hidden="true" tabindex="-1"></a>                               calc_power_sex_large,</span>
<span id="cb83-1103"><a href="#cb83-1103" aria-hidden="true" tabindex="-1"></a>                               calc_power_sex_small_lowh,</span>
<span id="cb83-1104"><a href="#cb83-1104" aria-hidden="true" tabindex="-1"></a>                               calc_power_sex_large_lowh,</span>
<span id="cb83-1105"><a href="#cb83-1105" aria-hidden="true" tabindex="-1"></a>                               calc_power_sex_small_largeh,</span>
<span id="cb83-1106"><a href="#cb83-1106" aria-hidden="true" tabindex="-1"></a>                               calc_power_sex_large_largeh)</span>
<span id="cb83-1107"><a href="#cb83-1107" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">lapply</span>(all_sex_effs_sex_only, unlist))</span>
<span id="cb83-1108"><a href="#cb83-1108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1109"><a href="#cb83-1109" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="sc">%&gt;%</span></span>
<span id="cb83-1110"><a href="#cb83-1110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Effect <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Treatment"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-1111"><a href="#cb83-1111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">factor</span>(sex_eff_size,</span>
<span id="cb83-1112"><a href="#cb83-1112" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"small"</span>, <span class="st">"large"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb83-1113"><a href="#cb83-1113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">recode</span>(method,</span>
<span id="cb83-1114"><a href="#cb83-1114" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"ANOVA"</span> <span class="ot">=</span> <span class="st">"Factorial"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-1115"><a href="#cb83-1115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">factor</span>(heterosc,</span>
<span id="cb83-1116"><a href="#cb83-1116" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"large"</span>, <span class="st">"low"</span>, <span class="st">"none"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb83-1117"><a href="#cb83-1117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> sex_eff_size,</span>
<span id="cb83-1118"><a href="#cb83-1118" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> <span class="fu">interaction</span>(sex_eff_size, heterosc))) <span class="sc">+</span></span>
<span id="cb83-1119"><a href="#cb83-1119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-1120"><a href="#cb83-1120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> heterosc)) <span class="sc">+</span></span>
<span id="cb83-1121"><a href="#cb83-1121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb83-1122"><a href="#cb83-1122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Statistical power"</span>) <span class="sc">+</span></span>
<span id="cb83-1123"><a href="#cb83-1123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Main treatment effect"</span>) <span class="sc">+</span></span>
<span id="cb83-1124"><a href="#cb83-1124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">name =</span> <span class="st">"Sex effect size"</span>, <span class="at">values =</span> cbb_palette) <span class="sc">+</span></span>
<span id="cb83-1125"><a href="#cb83-1125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_discrete</span>(<span class="at">name =</span> <span class="st">"Heteroscedasticity"</span>)  <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-1126"><a href="#cb83-1126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1127"><a href="#cb83-1127" aria-hidden="true" tabindex="-1"></a>plotA <span class="ot">&lt;-</span> all_sex_effs_sex_only <span class="sc">%&gt;%</span></span>
<span id="cb83-1128"><a href="#cb83-1128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sex_eff_size <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-1129"><a href="#cb83-1129" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sex_eff_size = factor(sex_eff_size,</span></span>
<span id="cb83-1130"><a href="#cb83-1130" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("none", "small", "large"))) %&gt;%</span></span>
<span id="cb83-1131"><a href="#cb83-1131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">factor</span>(heterosc,</span>
<span id="cb83-1132"><a href="#cb83-1132" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"large"</span>, <span class="st">"low"</span>, <span class="st">"none"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb83-1133"><a href="#cb83-1133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-1134"><a href="#cb83-1134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-1135"><a href="#cb83-1135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> heterosc)) <span class="sc">+</span></span>
<span id="cb83-1136"><a href="#cb83-1136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb83-1137"><a href="#cb83-1137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Statistical power"</span>) <span class="sc">+</span></span>
<span id="cb83-1138"><a href="#cb83-1138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Main treatment effect"</span>) <span class="sc">+</span></span>
<span id="cb83-1139"><a href="#cb83-1139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">name =</span> <span class="st">"Effect"</span>, <span class="at">values =</span> cbb_palette) <span class="sc">+</span></span>
<span id="cb83-1140"><a href="#cb83-1140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_discrete</span>(<span class="at">name =</span> <span class="st">"Heteroscedasticity"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-1141"><a href="#cb83-1141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1142"><a href="#cb83-1142" aria-hidden="true" tabindex="-1"></a>plotA</span>
<span id="cb83-1143"><a href="#cb83-1143" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-1144"><a href="#cb83-1144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1145"><a href="#cb83-1145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1146"><a href="#cb83-1146" aria-hidden="true" tabindex="-1"></a><span class="fu"># Scenarios from Fig. 4 - interaction of magnitude</span></span>
<span id="cb83-1147"><a href="#cb83-1147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1148"><a href="#cb83-1148" aria-hidden="true" tabindex="-1"></a><span class="fu">## From original paper</span></span>
<span id="cb83-1149"><a href="#cb83-1149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1150"><a href="#cb83-1150" aria-hidden="true" tabindex="-1"></a>Below simulations were only slightly modified. We assumed a moderate (+0.5) overall effect of sex and a varying interaction increasing the magnitude of sex difference in the treated group (+0, +0.5, +1).</span>
<span id="cb83-1151"><a href="#cb83-1151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1152"><a href="#cb83-1152" aria-hidden="true" tabindex="-1"></a>**Assuming homoscedasticity of sex variances**</span>
<span id="cb83-1153"><a href="#cb83-1153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1154"><a href="#cb83-1154" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb83-1155"><a href="#cb83-1155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1156"><a href="#cb83-1156" aria-hidden="true" tabindex="-1"></a><span class="fu">## No sex eff, no ix</span></span>
<span id="cb83-1157"><a href="#cb83-1157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1160"><a href="#cb83-1160" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-1161"><a href="#cb83-1161" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb83-1162"><a href="#cb83-1162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1163"><a href="#cb83-1163" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb83-1164"><a href="#cb83-1164" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-1165"><a href="#cb83-1165" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-1166"><a href="#cb83-1166" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-1167"><a href="#cb83-1167" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-1168"><a href="#cb83-1168" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-1169"><a href="#cb83-1169" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-1170"><a href="#cb83-1170" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb83-1171"><a href="#cb83-1171" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb83-1172"><a href="#cb83-1172" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-1173"><a href="#cb83-1173" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span><span class="dv">0</span></span>
<span id="cb83-1174"><a href="#cb83-1174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1175"><a href="#cb83-1175" aria-hidden="true" tabindex="-1"></a>all_effs_sex_ix_none <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-1176"><a href="#cb83-1176" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1177"><a href="#cb83-1177" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1178"><a href="#cb83-1178" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1179"><a href="#cb83-1179" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1180"><a href="#cb83-1180" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1181"><a href="#cb83-1181" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1182"><a href="#cb83-1182" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1183"><a href="#cb83-1183" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1184"><a href="#cb83-1184" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1185"><a href="#cb83-1185" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1186"><a href="#cb83-1186" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1187"><a href="#cb83-1187" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1188"><a href="#cb83-1188" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1189"><a href="#cb83-1189" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1190"><a href="#cb83-1190" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1191"><a href="#cb83-1191" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1192"><a href="#cb83-1192" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1193"><a href="#cb83-1193" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1194"><a href="#cb83-1194" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1195"><a href="#cb83-1195" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1196"><a href="#cb83-1196" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1197"><a href="#cb83-1197" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1198"><a href="#cb83-1198" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1199"><a href="#cb83-1199" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1200"><a href="#cb83-1200" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1201"><a href="#cb83-1201" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1202"><a href="#cb83-1202" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1203"><a href="#cb83-1203" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1204"><a href="#cb83-1204" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1205"><a href="#cb83-1205" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1206"><a href="#cb83-1206" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1207"><a href="#cb83-1207" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1208"><a href="#cb83-1208" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1209"><a href="#cb83-1209" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1210"><a href="#cb83-1210" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1211"><a href="#cb83-1211" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1212"><a href="#cb83-1212" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1213"><a href="#cb83-1213" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1214"><a href="#cb83-1214" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1215"><a href="#cb83-1215" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1216"><a href="#cb83-1216" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1217"><a href="#cb83-1217" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1218"><a href="#cb83-1218" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1219"><a href="#cb83-1219" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1220"><a href="#cb83-1220" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1221"><a href="#cb83-1221" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1222"><a href="#cb83-1222" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1223"><a href="#cb83-1223" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1224"><a href="#cb83-1224" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1225"><a href="#cb83-1225" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1226"><a href="#cb83-1226" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1227"><a href="#cb83-1227" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1228"><a href="#cb83-1228" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1229"><a href="#cb83-1229" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1230"><a href="#cb83-1230" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1231"><a href="#cb83-1231" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1232"><a href="#cb83-1232" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1233"><a href="#cb83-1233" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1234"><a href="#cb83-1234" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1235"><a href="#cb83-1235" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1236"><a href="#cb83-1236" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1237"><a href="#cb83-1237" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1238"><a href="#cb83-1238" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1239"><a href="#cb83-1239" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1240"><a href="#cb83-1240" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1241"><a href="#cb83-1241" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-1242"><a href="#cb83-1242" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-1243"><a href="#cb83-1243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1244"><a href="#cb83-1244" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_none <span class="ot">&lt;-</span> all_effs_sex_ix_none <span class="sc">%&gt;%</span></span>
<span id="cb83-1245"><a href="#cb83-1245" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-1246"><a href="#cb83-1246" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, ix_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb83-1247"><a href="#cb83-1247" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb83-1248"><a href="#cb83-1248" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"small"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-1249"><a href="#cb83-1249" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"none"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-1250"><a href="#cb83-1250" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"none"</span>))</span>
<span id="cb83-1251"><a href="#cb83-1251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1252"><a href="#cb83-1252" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_none <span class="sc">%&gt;%</span></span>
<span id="cb83-1253"><a href="#cb83-1253" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-1254"><a href="#cb83-1254" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-1255"><a href="#cb83-1255" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-1256"><a href="#cb83-1256" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb83-1257"><a href="#cb83-1257" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-1258"><a href="#cb83-1258" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-1259"><a href="#cb83-1259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1260"><a href="#cb83-1260" aria-hidden="true" tabindex="-1"></a><span class="fu">## Small sex eff, no ix</span></span>
<span id="cb83-1261"><a href="#cb83-1261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1264"><a href="#cb83-1264" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-1265"><a href="#cb83-1265" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb83-1266"><a href="#cb83-1266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1267"><a href="#cb83-1267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1268"><a href="#cb83-1268" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb83-1269"><a href="#cb83-1269" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-1270"><a href="#cb83-1270" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-1271"><a href="#cb83-1271" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-1272"><a href="#cb83-1272" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-1273"><a href="#cb83-1273" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-1274"><a href="#cb83-1274" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-1275"><a href="#cb83-1275" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb83-1276"><a href="#cb83-1276" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb83-1277"><a href="#cb83-1277" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-1278"><a href="#cb83-1278" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-1279"><a href="#cb83-1279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1280"><a href="#cb83-1280" aria-hidden="true" tabindex="-1"></a>all_effs_sex_ix_small <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-1281"><a href="#cb83-1281" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1282"><a href="#cb83-1282" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1283"><a href="#cb83-1283" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1284"><a href="#cb83-1284" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1285"><a href="#cb83-1285" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1286"><a href="#cb83-1286" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1287"><a href="#cb83-1287" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1288"><a href="#cb83-1288" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1289"><a href="#cb83-1289" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1290"><a href="#cb83-1290" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1291"><a href="#cb83-1291" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1292"><a href="#cb83-1292" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1293"><a href="#cb83-1293" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1294"><a href="#cb83-1294" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1295"><a href="#cb83-1295" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1296"><a href="#cb83-1296" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1297"><a href="#cb83-1297" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1298"><a href="#cb83-1298" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1299"><a href="#cb83-1299" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1300"><a href="#cb83-1300" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1301"><a href="#cb83-1301" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1302"><a href="#cb83-1302" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1303"><a href="#cb83-1303" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1304"><a href="#cb83-1304" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1305"><a href="#cb83-1305" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1306"><a href="#cb83-1306" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1307"><a href="#cb83-1307" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1308"><a href="#cb83-1308" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1309"><a href="#cb83-1309" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1310"><a href="#cb83-1310" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1311"><a href="#cb83-1311" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1312"><a href="#cb83-1312" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1313"><a href="#cb83-1313" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1314"><a href="#cb83-1314" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1315"><a href="#cb83-1315" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1316"><a href="#cb83-1316" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1317"><a href="#cb83-1317" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1318"><a href="#cb83-1318" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1319"><a href="#cb83-1319" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1320"><a href="#cb83-1320" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1321"><a href="#cb83-1321" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1322"><a href="#cb83-1322" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1323"><a href="#cb83-1323" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1324"><a href="#cb83-1324" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1325"><a href="#cb83-1325" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1326"><a href="#cb83-1326" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1327"><a href="#cb83-1327" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1328"><a href="#cb83-1328" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1329"><a href="#cb83-1329" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1330"><a href="#cb83-1330" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1331"><a href="#cb83-1331" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1332"><a href="#cb83-1332" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1333"><a href="#cb83-1333" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1334"><a href="#cb83-1334" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1335"><a href="#cb83-1335" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1336"><a href="#cb83-1336" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1337"><a href="#cb83-1337" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1338"><a href="#cb83-1338" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1339"><a href="#cb83-1339" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1340"><a href="#cb83-1340" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1341"><a href="#cb83-1341" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1342"><a href="#cb83-1342" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1343"><a href="#cb83-1343" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1344"><a href="#cb83-1344" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1345"><a href="#cb83-1345" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1346"><a href="#cb83-1346" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-1347"><a href="#cb83-1347" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-1348"><a href="#cb83-1348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1349"><a href="#cb83-1349" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_small <span class="ot">&lt;-</span> all_effs_sex_ix_small <span class="sc">%&gt;%</span></span>
<span id="cb83-1350"><a href="#cb83-1350" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-1351"><a href="#cb83-1351" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, ix_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb83-1352"><a href="#cb83-1352" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb83-1353"><a href="#cb83-1353" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"small"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-1354"><a href="#cb83-1354" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"none"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-1355"><a href="#cb83-1355" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"small"</span>))</span>
<span id="cb83-1356"><a href="#cb83-1356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1357"><a href="#cb83-1357" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_small <span class="sc">%&gt;%</span></span>
<span id="cb83-1358"><a href="#cb83-1358" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-1359"><a href="#cb83-1359" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-1360"><a href="#cb83-1360" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-1361"><a href="#cb83-1361" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb83-1362"><a href="#cb83-1362" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-1363"><a href="#cb83-1363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1364"><a href="#cb83-1364" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-1365"><a href="#cb83-1365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1366"><a href="#cb83-1366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1367"><a href="#cb83-1367" aria-hidden="true" tabindex="-1"></a><span class="fu">## Large sex eff, no ix</span></span>
<span id="cb83-1368"><a href="#cb83-1368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1371"><a href="#cb83-1371" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-1372"><a href="#cb83-1372" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb83-1373"><a href="#cb83-1373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1374"><a href="#cb83-1374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1375"><a href="#cb83-1375" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb83-1376"><a href="#cb83-1376" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-1377"><a href="#cb83-1377" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-1378"><a href="#cb83-1378" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-1379"><a href="#cb83-1379" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-1380"><a href="#cb83-1380" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-1381"><a href="#cb83-1381" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-1382"><a href="#cb83-1382" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb83-1383"><a href="#cb83-1383" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb83-1384"><a href="#cb83-1384" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-1385"><a href="#cb83-1385" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-1386"><a href="#cb83-1386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1387"><a href="#cb83-1387" aria-hidden="true" tabindex="-1"></a>all_effs_sex_ix_large <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-1388"><a href="#cb83-1388" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1389"><a href="#cb83-1389" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1390"><a href="#cb83-1390" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1391"><a href="#cb83-1391" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1392"><a href="#cb83-1392" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1393"><a href="#cb83-1393" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1394"><a href="#cb83-1394" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1395"><a href="#cb83-1395" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1396"><a href="#cb83-1396" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1397"><a href="#cb83-1397" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1398"><a href="#cb83-1398" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1399"><a href="#cb83-1399" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1400"><a href="#cb83-1400" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1401"><a href="#cb83-1401" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1402"><a href="#cb83-1402" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1403"><a href="#cb83-1403" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1404"><a href="#cb83-1404" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1405"><a href="#cb83-1405" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1406"><a href="#cb83-1406" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1407"><a href="#cb83-1407" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1408"><a href="#cb83-1408" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1409"><a href="#cb83-1409" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1410"><a href="#cb83-1410" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1411"><a href="#cb83-1411" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1412"><a href="#cb83-1412" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1413"><a href="#cb83-1413" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1414"><a href="#cb83-1414" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1415"><a href="#cb83-1415" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1416"><a href="#cb83-1416" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1417"><a href="#cb83-1417" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1418"><a href="#cb83-1418" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1419"><a href="#cb83-1419" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1420"><a href="#cb83-1420" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1421"><a href="#cb83-1421" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1422"><a href="#cb83-1422" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1423"><a href="#cb83-1423" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1424"><a href="#cb83-1424" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1425"><a href="#cb83-1425" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1426"><a href="#cb83-1426" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1427"><a href="#cb83-1427" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1428"><a href="#cb83-1428" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1429"><a href="#cb83-1429" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1430"><a href="#cb83-1430" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1431"><a href="#cb83-1431" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1432"><a href="#cb83-1432" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1433"><a href="#cb83-1433" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1434"><a href="#cb83-1434" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1435"><a href="#cb83-1435" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1436"><a href="#cb83-1436" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1437"><a href="#cb83-1437" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1438"><a href="#cb83-1438" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1439"><a href="#cb83-1439" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1440"><a href="#cb83-1440" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1441"><a href="#cb83-1441" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1442"><a href="#cb83-1442" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1443"><a href="#cb83-1443" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1444"><a href="#cb83-1444" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1445"><a href="#cb83-1445" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1446"><a href="#cb83-1446" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1447"><a href="#cb83-1447" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1448"><a href="#cb83-1448" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1449"><a href="#cb83-1449" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1450"><a href="#cb83-1450" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1451"><a href="#cb83-1451" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1452"><a href="#cb83-1452" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1453"><a href="#cb83-1453" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-1454"><a href="#cb83-1454" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-1455"><a href="#cb83-1455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1456"><a href="#cb83-1456" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_large <span class="ot">&lt;-</span> all_effs_sex_ix_large <span class="sc">%&gt;%</span></span>
<span id="cb83-1457"><a href="#cb83-1457" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-1458"><a href="#cb83-1458" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, ix_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb83-1459"><a href="#cb83-1459" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb83-1460"><a href="#cb83-1460" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-1461"><a href="#cb83-1461" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"none"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-1462"><a href="#cb83-1462" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>))</span>
<span id="cb83-1463"><a href="#cb83-1463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1464"><a href="#cb83-1464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1465"><a href="#cb83-1465" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_large <span class="sc">%&gt;%</span></span>
<span id="cb83-1466"><a href="#cb83-1466" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-1467"><a href="#cb83-1467" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-1468"><a href="#cb83-1468" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-1469"><a href="#cb83-1469" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb83-1470"><a href="#cb83-1470" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-1471"><a href="#cb83-1471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1472"><a href="#cb83-1472" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-1473"><a href="#cb83-1473" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb83-1474"><a href="#cb83-1474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1475"><a href="#cb83-1475" aria-hidden="true" tabindex="-1"></a>Plots combining all scenarios from Fig. 1</span>
<span id="cb83-1476"><a href="#cb83-1476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1479"><a href="#cb83-1479" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-1480"><a href="#cb83-1480" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb83-1481"><a href="#cb83-1481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1482"><a href="#cb83-1482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1483"><a href="#cb83-1483" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="ot">&lt;-</span> <span class="fu">rbind</span>(calc_power_sex_ix_none, calc_power_sex_ix_small,</span>
<span id="cb83-1484"><a href="#cb83-1484" aria-hidden="true" tabindex="-1"></a>                               calc_power_sex_ix_large)</span>
<span id="cb83-1485"><a href="#cb83-1485" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">lapply</span>(all_sex_effs_sex_only, unlist))</span>
<span id="cb83-1486"><a href="#cb83-1486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1487"><a href="#cb83-1487" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="sc">%&gt;%</span></span>
<span id="cb83-1488"><a href="#cb83-1488" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Effect <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Treatment"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-1489"><a href="#cb83-1489" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">factor</span>(ix_eff_size,</span>
<span id="cb83-1490"><a href="#cb83-1490" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"none"</span>, <span class="st">"small"</span>, <span class="st">"large"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb83-1491"><a href="#cb83-1491" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">recode</span>(method,</span>
<span id="cb83-1492"><a href="#cb83-1492" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"ANOVA"</span> <span class="ot">=</span> <span class="st">"Factorial"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-1493"><a href="#cb83-1493" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> ix_eff_size,</span>
<span id="cb83-1494"><a href="#cb83-1494" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> <span class="fu">interaction</span>(ix_eff_size, method))) <span class="sc">+</span></span>
<span id="cb83-1495"><a href="#cb83-1495" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-1496"><a href="#cb83-1496" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> method)) <span class="sc">+</span></span>
<span id="cb83-1497"><a href="#cb83-1497" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb83-1498"><a href="#cb83-1498" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Statistical power"</span>) <span class="sc">+</span></span>
<span id="cb83-1499"><a href="#cb83-1499" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Main treatment effect"</span>) <span class="sc">+</span></span>
<span id="cb83-1500"><a href="#cb83-1500" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">name =</span> <span class="st">"Ix effect size"</span>, <span class="at">values =</span> cbb_palette) <span class="sc">+</span></span>
<span id="cb83-1501"><a href="#cb83-1501" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_discrete</span>(<span class="at">name =</span> <span class="st">"Stat method"</span>)  <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-1502"><a href="#cb83-1502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1503"><a href="#cb83-1503" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="sc">%&gt;%</span></span>
<span id="cb83-1504"><a href="#cb83-1504" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(!Effect %in% c("T-Test Treatment Eff")) %&gt;%</span></span>
<span id="cb83-1505"><a href="#cb83-1505" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">factor</span>(ix_eff_size,</span>
<span id="cb83-1506"><a href="#cb83-1506" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"none"</span>, <span class="st">"small"</span>, <span class="st">"large"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb83-1507"><a href="#cb83-1507" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect,</span>
<span id="cb83-1508"><a href="#cb83-1508" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> <span class="fu">interaction</span>(ix_eff_size, Effect))) <span class="sc">+</span></span>
<span id="cb83-1509"><a href="#cb83-1509" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-1510"><a href="#cb83-1510" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> ix_eff_size)) <span class="sc">+</span></span>
<span id="cb83-1511"><a href="#cb83-1511" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb83-1512"><a href="#cb83-1512" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Statistical power"</span>) <span class="sc">+</span></span>
<span id="cb83-1513"><a href="#cb83-1513" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Main treatment effect"</span>) <span class="sc">+</span></span>
<span id="cb83-1514"><a href="#cb83-1514" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">name =</span> <span class="st">"Effect"</span>, <span class="at">values =</span> cbb_palette) <span class="sc">+</span></span>
<span id="cb83-1515"><a href="#cb83-1515" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_discrete</span>(<span class="at">name =</span> <span class="st">"Ix effect size"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-1516"><a href="#cb83-1516" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-1517"><a href="#cb83-1517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1518"><a href="#cb83-1518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1519"><a href="#cb83-1519" aria-hidden="true" tabindex="-1"></a><span class="fu">## Heteroscedastic sex variances</span></span>
<span id="cb83-1520"><a href="#cb83-1520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1521"><a href="#cb83-1521" aria-hidden="true" tabindex="-1"></a>We assume several scenarios with $\alpha$ equal to 0 (the above scenarios), 1 and 2, which relates to 100% or 200% increase in male variance, in relation to female variance (or ~44% and ~73% increase in male SD). The direction of sex bias is arbitrary.</span>
<span id="cb83-1522"><a href="#cb83-1522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1523"><a href="#cb83-1523" aria-hidden="true" tabindex="-1"></a>**Low heteroscedasticity**</span>
<span id="cb83-1524"><a href="#cb83-1524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1527"><a href="#cb83-1527" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-1528"><a href="#cb83-1528" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-1529"><a href="#cb83-1529" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-1530"><a href="#cb83-1530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1531"><a href="#cb83-1531" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb83-1532"><a href="#cb83-1532" aria-hidden="true" tabindex="-1"></a><span class="fu">## Small sex eff, no ix</span></span>
<span id="cb83-1533"><a href="#cb83-1533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1536"><a href="#cb83-1536" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-1537"><a href="#cb83-1537" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb83-1538"><a href="#cb83-1538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1539"><a href="#cb83-1539" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb83-1540"><a href="#cb83-1540" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-1541"><a href="#cb83-1541" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-1542"><a href="#cb83-1542" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-1543"><a href="#cb83-1543" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-1544"><a href="#cb83-1544" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-1545"><a href="#cb83-1545" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-1546"><a href="#cb83-1546" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb83-1547"><a href="#cb83-1547" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb83-1548"><a href="#cb83-1548" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-1549"><a href="#cb83-1549" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb83-1550"><a href="#cb83-1550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1551"><a href="#cb83-1551" aria-hidden="true" tabindex="-1"></a>all_effs_sex_ix_none_lowh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-1552"><a href="#cb83-1552" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1553"><a href="#cb83-1553" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1554"><a href="#cb83-1554" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1555"><a href="#cb83-1555" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1556"><a href="#cb83-1556" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1557"><a href="#cb83-1557" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1558"><a href="#cb83-1558" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1559"><a href="#cb83-1559" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1560"><a href="#cb83-1560" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1561"><a href="#cb83-1561" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1562"><a href="#cb83-1562" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1563"><a href="#cb83-1563" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1564"><a href="#cb83-1564" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1565"><a href="#cb83-1565" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1566"><a href="#cb83-1566" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1567"><a href="#cb83-1567" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1568"><a href="#cb83-1568" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1569"><a href="#cb83-1569" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1570"><a href="#cb83-1570" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1571"><a href="#cb83-1571" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1572"><a href="#cb83-1572" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1573"><a href="#cb83-1573" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1574"><a href="#cb83-1574" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1575"><a href="#cb83-1575" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1576"><a href="#cb83-1576" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1577"><a href="#cb83-1577" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1578"><a href="#cb83-1578" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1579"><a href="#cb83-1579" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1580"><a href="#cb83-1580" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1581"><a href="#cb83-1581" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1582"><a href="#cb83-1582" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1583"><a href="#cb83-1583" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1584"><a href="#cb83-1584" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1585"><a href="#cb83-1585" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1586"><a href="#cb83-1586" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1587"><a href="#cb83-1587" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1588"><a href="#cb83-1588" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1589"><a href="#cb83-1589" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1590"><a href="#cb83-1590" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1591"><a href="#cb83-1591" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1592"><a href="#cb83-1592" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1593"><a href="#cb83-1593" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1594"><a href="#cb83-1594" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1595"><a href="#cb83-1595" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1596"><a href="#cb83-1596" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1597"><a href="#cb83-1597" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1598"><a href="#cb83-1598" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1599"><a href="#cb83-1599" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1600"><a href="#cb83-1600" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1601"><a href="#cb83-1601" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1602"><a href="#cb83-1602" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1603"><a href="#cb83-1603" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1604"><a href="#cb83-1604" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1605"><a href="#cb83-1605" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1606"><a href="#cb83-1606" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1607"><a href="#cb83-1607" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1608"><a href="#cb83-1608" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1609"><a href="#cb83-1609" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1610"><a href="#cb83-1610" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1611"><a href="#cb83-1611" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1612"><a href="#cb83-1612" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1613"><a href="#cb83-1613" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1614"><a href="#cb83-1614" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1615"><a href="#cb83-1615" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1616"><a href="#cb83-1616" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1617"><a href="#cb83-1617" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-1618"><a href="#cb83-1618" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-1619"><a href="#cb83-1619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1620"><a href="#cb83-1620" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_none_lowh <span class="ot">&lt;-</span> all_effs_sex_ix_none_lowh <span class="sc">%&gt;%</span></span>
<span id="cb83-1621"><a href="#cb83-1621" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-1622"><a href="#cb83-1622" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, ix_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb83-1623"><a href="#cb83-1623" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb83-1624"><a href="#cb83-1624" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"small"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-1625"><a href="#cb83-1625" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"low"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-1626"><a href="#cb83-1626" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"none"</span>))</span>
<span id="cb83-1627"><a href="#cb83-1627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1628"><a href="#cb83-1628" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_none_lowh <span class="sc">%&gt;%</span></span>
<span id="cb83-1629"><a href="#cb83-1629" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-1630"><a href="#cb83-1630" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-1631"><a href="#cb83-1631" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-1632"><a href="#cb83-1632" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb83-1633"><a href="#cb83-1633" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-1634"><a href="#cb83-1634" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-1635"><a href="#cb83-1635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1636"><a href="#cb83-1636" aria-hidden="true" tabindex="-1"></a><span class="fu">## Small sex eff, small ix</span></span>
<span id="cb83-1637"><a href="#cb83-1637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1640"><a href="#cb83-1640" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-1641"><a href="#cb83-1641" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb83-1642"><a href="#cb83-1642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1643"><a href="#cb83-1643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1644"><a href="#cb83-1644" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb83-1645"><a href="#cb83-1645" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-1646"><a href="#cb83-1646" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-1647"><a href="#cb83-1647" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-1648"><a href="#cb83-1648" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-1649"><a href="#cb83-1649" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-1650"><a href="#cb83-1650" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-1651"><a href="#cb83-1651" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb83-1652"><a href="#cb83-1652" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb83-1653"><a href="#cb83-1653" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-1654"><a href="#cb83-1654" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb83-1655"><a href="#cb83-1655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1656"><a href="#cb83-1656" aria-hidden="true" tabindex="-1"></a>all_effs_sex_ix_small_lowh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-1657"><a href="#cb83-1657" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1658"><a href="#cb83-1658" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1659"><a href="#cb83-1659" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1660"><a href="#cb83-1660" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1661"><a href="#cb83-1661" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1662"><a href="#cb83-1662" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1663"><a href="#cb83-1663" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1664"><a href="#cb83-1664" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1665"><a href="#cb83-1665" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1666"><a href="#cb83-1666" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1667"><a href="#cb83-1667" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1668"><a href="#cb83-1668" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1669"><a href="#cb83-1669" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1670"><a href="#cb83-1670" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1671"><a href="#cb83-1671" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1672"><a href="#cb83-1672" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1673"><a href="#cb83-1673" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1674"><a href="#cb83-1674" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1675"><a href="#cb83-1675" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1676"><a href="#cb83-1676" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1677"><a href="#cb83-1677" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1678"><a href="#cb83-1678" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1679"><a href="#cb83-1679" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1680"><a href="#cb83-1680" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1681"><a href="#cb83-1681" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1682"><a href="#cb83-1682" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1683"><a href="#cb83-1683" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1684"><a href="#cb83-1684" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1685"><a href="#cb83-1685" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1686"><a href="#cb83-1686" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1687"><a href="#cb83-1687" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1688"><a href="#cb83-1688" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1689"><a href="#cb83-1689" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1690"><a href="#cb83-1690" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1691"><a href="#cb83-1691" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1692"><a href="#cb83-1692" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1693"><a href="#cb83-1693" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1694"><a href="#cb83-1694" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1695"><a href="#cb83-1695" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1696"><a href="#cb83-1696" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1697"><a href="#cb83-1697" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1698"><a href="#cb83-1698" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1699"><a href="#cb83-1699" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1700"><a href="#cb83-1700" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1701"><a href="#cb83-1701" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1702"><a href="#cb83-1702" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1703"><a href="#cb83-1703" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1704"><a href="#cb83-1704" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1705"><a href="#cb83-1705" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1706"><a href="#cb83-1706" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1707"><a href="#cb83-1707" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1708"><a href="#cb83-1708" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1709"><a href="#cb83-1709" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1710"><a href="#cb83-1710" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1711"><a href="#cb83-1711" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1712"><a href="#cb83-1712" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1713"><a href="#cb83-1713" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1714"><a href="#cb83-1714" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1715"><a href="#cb83-1715" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1716"><a href="#cb83-1716" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1717"><a href="#cb83-1717" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1718"><a href="#cb83-1718" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1719"><a href="#cb83-1719" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1720"><a href="#cb83-1720" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1721"><a href="#cb83-1721" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1722"><a href="#cb83-1722" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-1723"><a href="#cb83-1723" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-1724"><a href="#cb83-1724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1725"><a href="#cb83-1725" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_small_lowh <span class="ot">&lt;-</span> all_effs_sex_ix_small_lowh <span class="sc">%&gt;%</span></span>
<span id="cb83-1726"><a href="#cb83-1726" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-1727"><a href="#cb83-1727" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, ix_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb83-1728"><a href="#cb83-1728" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb83-1729"><a href="#cb83-1729" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"small"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-1730"><a href="#cb83-1730" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"low"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-1731"><a href="#cb83-1731" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"small"</span>))</span>
<span id="cb83-1732"><a href="#cb83-1732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1733"><a href="#cb83-1733" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_small_lowh <span class="sc">%&gt;%</span></span>
<span id="cb83-1734"><a href="#cb83-1734" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-1735"><a href="#cb83-1735" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-1736"><a href="#cb83-1736" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-1737"><a href="#cb83-1737" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb83-1738"><a href="#cb83-1738" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-1739"><a href="#cb83-1739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1740"><a href="#cb83-1740" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-1741"><a href="#cb83-1741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1742"><a href="#cb83-1742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1743"><a href="#cb83-1743" aria-hidden="true" tabindex="-1"></a><span class="fu">## Small sex eff, large ix</span></span>
<span id="cb83-1744"><a href="#cb83-1744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1747"><a href="#cb83-1747" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-1748"><a href="#cb83-1748" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb83-1749"><a href="#cb83-1749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1750"><a href="#cb83-1750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1751"><a href="#cb83-1751" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb83-1752"><a href="#cb83-1752" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-1753"><a href="#cb83-1753" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-1754"><a href="#cb83-1754" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-1755"><a href="#cb83-1755" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-1756"><a href="#cb83-1756" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-1757"><a href="#cb83-1757" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-1758"><a href="#cb83-1758" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb83-1759"><a href="#cb83-1759" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb83-1760"><a href="#cb83-1760" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-1761"><a href="#cb83-1761" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb83-1762"><a href="#cb83-1762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1763"><a href="#cb83-1763" aria-hidden="true" tabindex="-1"></a>all_effs_sex_ix_large_lowh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-1764"><a href="#cb83-1764" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1765"><a href="#cb83-1765" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1766"><a href="#cb83-1766" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1767"><a href="#cb83-1767" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1768"><a href="#cb83-1768" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1769"><a href="#cb83-1769" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1770"><a href="#cb83-1770" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1771"><a href="#cb83-1771" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1772"><a href="#cb83-1772" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1773"><a href="#cb83-1773" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1774"><a href="#cb83-1774" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1775"><a href="#cb83-1775" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1776"><a href="#cb83-1776" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1777"><a href="#cb83-1777" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1778"><a href="#cb83-1778" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1779"><a href="#cb83-1779" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1780"><a href="#cb83-1780" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1781"><a href="#cb83-1781" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1782"><a href="#cb83-1782" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1783"><a href="#cb83-1783" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1784"><a href="#cb83-1784" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1785"><a href="#cb83-1785" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1786"><a href="#cb83-1786" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1787"><a href="#cb83-1787" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1788"><a href="#cb83-1788" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1789"><a href="#cb83-1789" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1790"><a href="#cb83-1790" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1791"><a href="#cb83-1791" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1792"><a href="#cb83-1792" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1793"><a href="#cb83-1793" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1794"><a href="#cb83-1794" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1795"><a href="#cb83-1795" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1796"><a href="#cb83-1796" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1797"><a href="#cb83-1797" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1798"><a href="#cb83-1798" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1799"><a href="#cb83-1799" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1800"><a href="#cb83-1800" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1801"><a href="#cb83-1801" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1802"><a href="#cb83-1802" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1803"><a href="#cb83-1803" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1804"><a href="#cb83-1804" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1805"><a href="#cb83-1805" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1806"><a href="#cb83-1806" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1807"><a href="#cb83-1807" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1808"><a href="#cb83-1808" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1809"><a href="#cb83-1809" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1810"><a href="#cb83-1810" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1811"><a href="#cb83-1811" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1812"><a href="#cb83-1812" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1813"><a href="#cb83-1813" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1814"><a href="#cb83-1814" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1815"><a href="#cb83-1815" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1816"><a href="#cb83-1816" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1817"><a href="#cb83-1817" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1818"><a href="#cb83-1818" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1819"><a href="#cb83-1819" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1820"><a href="#cb83-1820" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1821"><a href="#cb83-1821" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1822"><a href="#cb83-1822" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1823"><a href="#cb83-1823" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1824"><a href="#cb83-1824" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1825"><a href="#cb83-1825" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1826"><a href="#cb83-1826" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1827"><a href="#cb83-1827" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1828"><a href="#cb83-1828" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1829"><a href="#cb83-1829" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-1830"><a href="#cb83-1830" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-1831"><a href="#cb83-1831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1832"><a href="#cb83-1832" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_large_lowh <span class="ot">&lt;-</span> all_effs_sex_ix_large_lowh <span class="sc">%&gt;%</span></span>
<span id="cb83-1833"><a href="#cb83-1833" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-1834"><a href="#cb83-1834" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, ix_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb83-1835"><a href="#cb83-1835" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb83-1836"><a href="#cb83-1836" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"small"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-1837"><a href="#cb83-1837" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"low"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-1838"><a href="#cb83-1838" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>))</span>
<span id="cb83-1839"><a href="#cb83-1839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1840"><a href="#cb83-1840" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_large_lowh <span class="sc">%&gt;%</span></span>
<span id="cb83-1841"><a href="#cb83-1841" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-1842"><a href="#cb83-1842" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-1843"><a href="#cb83-1843" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-1844"><a href="#cb83-1844" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb83-1845"><a href="#cb83-1845" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-1846"><a href="#cb83-1846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1847"><a href="#cb83-1847" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-1848"><a href="#cb83-1848" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb83-1849"><a href="#cb83-1849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1850"><a href="#cb83-1850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1851"><a href="#cb83-1851" aria-hidden="true" tabindex="-1"></a>**Large heteroscedasticity**</span>
<span id="cb83-1852"><a href="#cb83-1852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1855"><a href="#cb83-1855" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-1856"><a href="#cb83-1856" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb83-1857"><a href="#cb83-1857" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-1858"><a href="#cb83-1858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1859"><a href="#cb83-1859" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb83-1860"><a href="#cb83-1860" aria-hidden="true" tabindex="-1"></a><span class="fu">## Small sex eff, no ix</span></span>
<span id="cb83-1861"><a href="#cb83-1861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1864"><a href="#cb83-1864" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-1865"><a href="#cb83-1865" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb83-1866"><a href="#cb83-1866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1867"><a href="#cb83-1867" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb83-1868"><a href="#cb83-1868" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-1869"><a href="#cb83-1869" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-1870"><a href="#cb83-1870" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-1871"><a href="#cb83-1871" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-1872"><a href="#cb83-1872" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-1873"><a href="#cb83-1873" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-1874"><a href="#cb83-1874" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb83-1875"><a href="#cb83-1875" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb83-1876"><a href="#cb83-1876" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-1877"><a href="#cb83-1877" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb83-1878"><a href="#cb83-1878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1879"><a href="#cb83-1879" aria-hidden="true" tabindex="-1"></a>all_effs_sex_ix_none_largeh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-1880"><a href="#cb83-1880" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1881"><a href="#cb83-1881" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1882"><a href="#cb83-1882" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1883"><a href="#cb83-1883" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1884"><a href="#cb83-1884" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1885"><a href="#cb83-1885" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1886"><a href="#cb83-1886" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1887"><a href="#cb83-1887" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1888"><a href="#cb83-1888" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1889"><a href="#cb83-1889" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1890"><a href="#cb83-1890" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1891"><a href="#cb83-1891" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1892"><a href="#cb83-1892" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1893"><a href="#cb83-1893" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1894"><a href="#cb83-1894" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1895"><a href="#cb83-1895" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1896"><a href="#cb83-1896" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1897"><a href="#cb83-1897" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1898"><a href="#cb83-1898" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1899"><a href="#cb83-1899" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1900"><a href="#cb83-1900" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1901"><a href="#cb83-1901" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1902"><a href="#cb83-1902" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1903"><a href="#cb83-1903" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1904"><a href="#cb83-1904" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1905"><a href="#cb83-1905" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1906"><a href="#cb83-1906" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1907"><a href="#cb83-1907" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1908"><a href="#cb83-1908" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1909"><a href="#cb83-1909" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1910"><a href="#cb83-1910" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1911"><a href="#cb83-1911" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1912"><a href="#cb83-1912" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1913"><a href="#cb83-1913" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1914"><a href="#cb83-1914" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1915"><a href="#cb83-1915" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1916"><a href="#cb83-1916" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1917"><a href="#cb83-1917" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1918"><a href="#cb83-1918" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1919"><a href="#cb83-1919" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1920"><a href="#cb83-1920" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1921"><a href="#cb83-1921" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1922"><a href="#cb83-1922" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1923"><a href="#cb83-1923" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1924"><a href="#cb83-1924" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1925"><a href="#cb83-1925" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1926"><a href="#cb83-1926" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1927"><a href="#cb83-1927" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1928"><a href="#cb83-1928" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1929"><a href="#cb83-1929" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1930"><a href="#cb83-1930" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1931"><a href="#cb83-1931" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1932"><a href="#cb83-1932" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1933"><a href="#cb83-1933" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1934"><a href="#cb83-1934" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1935"><a href="#cb83-1935" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1936"><a href="#cb83-1936" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1937"><a href="#cb83-1937" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1938"><a href="#cb83-1938" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1939"><a href="#cb83-1939" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1940"><a href="#cb83-1940" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1941"><a href="#cb83-1941" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1942"><a href="#cb83-1942" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1943"><a href="#cb83-1943" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1944"><a href="#cb83-1944" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1945"><a href="#cb83-1945" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-1946"><a href="#cb83-1946" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-1947"><a href="#cb83-1947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1948"><a href="#cb83-1948" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_none_largeh <span class="ot">&lt;-</span> all_effs_sex_ix_none_largeh <span class="sc">%&gt;%</span></span>
<span id="cb83-1949"><a href="#cb83-1949" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-1950"><a href="#cb83-1950" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, ix_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb83-1951"><a href="#cb83-1951" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb83-1952"><a href="#cb83-1952" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"small"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-1953"><a href="#cb83-1953" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-1954"><a href="#cb83-1954" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"none"</span>))</span>
<span id="cb83-1955"><a href="#cb83-1955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1956"><a href="#cb83-1956" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_none_largeh <span class="sc">%&gt;%</span></span>
<span id="cb83-1957"><a href="#cb83-1957" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-1958"><a href="#cb83-1958" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-1959"><a href="#cb83-1959" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-1960"><a href="#cb83-1960" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb83-1961"><a href="#cb83-1961" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-1962"><a href="#cb83-1962" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-1963"><a href="#cb83-1963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1964"><a href="#cb83-1964" aria-hidden="true" tabindex="-1"></a><span class="fu">## Small sex eff, small ix</span></span>
<span id="cb83-1965"><a href="#cb83-1965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1968"><a href="#cb83-1968" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-1969"><a href="#cb83-1969" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb83-1970"><a href="#cb83-1970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1971"><a href="#cb83-1971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1972"><a href="#cb83-1972" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb83-1973"><a href="#cb83-1973" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-1974"><a href="#cb83-1974" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-1975"><a href="#cb83-1975" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-1976"><a href="#cb83-1976" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-1977"><a href="#cb83-1977" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-1978"><a href="#cb83-1978" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-1979"><a href="#cb83-1979" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb83-1980"><a href="#cb83-1980" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb83-1981"><a href="#cb83-1981" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-1982"><a href="#cb83-1982" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb83-1983"><a href="#cb83-1983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-1984"><a href="#cb83-1984" aria-hidden="true" tabindex="-1"></a>all_effs_sex_ix_small_largeh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-1985"><a href="#cb83-1985" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1986"><a href="#cb83-1986" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1987"><a href="#cb83-1987" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1988"><a href="#cb83-1988" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1989"><a href="#cb83-1989" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1990"><a href="#cb83-1990" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1991"><a href="#cb83-1991" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1992"><a href="#cb83-1992" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1993"><a href="#cb83-1993" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-1994"><a href="#cb83-1994" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-1995"><a href="#cb83-1995" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-1996"><a href="#cb83-1996" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-1997"><a href="#cb83-1997" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-1998"><a href="#cb83-1998" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-1999"><a href="#cb83-1999" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2000"><a href="#cb83-2000" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2001"><a href="#cb83-2001" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2002"><a href="#cb83-2002" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2003"><a href="#cb83-2003" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2004"><a href="#cb83-2004" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2005"><a href="#cb83-2005" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2006"><a href="#cb83-2006" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2007"><a href="#cb83-2007" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2008"><a href="#cb83-2008" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2009"><a href="#cb83-2009" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2010"><a href="#cb83-2010" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2011"><a href="#cb83-2011" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2012"><a href="#cb83-2012" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2013"><a href="#cb83-2013" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2014"><a href="#cb83-2014" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2015"><a href="#cb83-2015" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2016"><a href="#cb83-2016" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2017"><a href="#cb83-2017" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2018"><a href="#cb83-2018" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2019"><a href="#cb83-2019" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2020"><a href="#cb83-2020" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2021"><a href="#cb83-2021" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2022"><a href="#cb83-2022" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2023"><a href="#cb83-2023" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2024"><a href="#cb83-2024" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2025"><a href="#cb83-2025" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2026"><a href="#cb83-2026" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2027"><a href="#cb83-2027" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2028"><a href="#cb83-2028" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2029"><a href="#cb83-2029" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2030"><a href="#cb83-2030" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2031"><a href="#cb83-2031" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2032"><a href="#cb83-2032" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2033"><a href="#cb83-2033" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2034"><a href="#cb83-2034" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2035"><a href="#cb83-2035" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2036"><a href="#cb83-2036" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2037"><a href="#cb83-2037" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2038"><a href="#cb83-2038" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2039"><a href="#cb83-2039" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2040"><a href="#cb83-2040" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2041"><a href="#cb83-2041" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2042"><a href="#cb83-2042" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2043"><a href="#cb83-2043" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2044"><a href="#cb83-2044" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2045"><a href="#cb83-2045" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2046"><a href="#cb83-2046" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2047"><a href="#cb83-2047" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2048"><a href="#cb83-2048" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2049"><a href="#cb83-2049" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2050"><a href="#cb83-2050" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-2051"><a href="#cb83-2051" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-2052"><a href="#cb83-2052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2053"><a href="#cb83-2053" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_small_largeh <span class="ot">&lt;-</span> all_effs_sex_ix_small_largeh <span class="sc">%&gt;%</span></span>
<span id="cb83-2054"><a href="#cb83-2054" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-2055"><a href="#cb83-2055" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, ix_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb83-2056"><a href="#cb83-2056" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb83-2057"><a href="#cb83-2057" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"small"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-2058"><a href="#cb83-2058" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-2059"><a href="#cb83-2059" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"small"</span>))</span>
<span id="cb83-2060"><a href="#cb83-2060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2061"><a href="#cb83-2061" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_small_largeh <span class="sc">%&gt;%</span></span>
<span id="cb83-2062"><a href="#cb83-2062" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-2063"><a href="#cb83-2063" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-2064"><a href="#cb83-2064" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-2065"><a href="#cb83-2065" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb83-2066"><a href="#cb83-2066" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-2067"><a href="#cb83-2067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2068"><a href="#cb83-2068" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-2069"><a href="#cb83-2069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2070"><a href="#cb83-2070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2071"><a href="#cb83-2071" aria-hidden="true" tabindex="-1"></a><span class="fu">## Small sex eff, large ix</span></span>
<span id="cb83-2072"><a href="#cb83-2072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2075"><a href="#cb83-2075" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-2076"><a href="#cb83-2076" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb83-2077"><a href="#cb83-2077" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2078"><a href="#cb83-2078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2079"><a href="#cb83-2079" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb83-2080"><a href="#cb83-2080" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-2081"><a href="#cb83-2081" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-2082"><a href="#cb83-2082" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-2083"><a href="#cb83-2083" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-2084"><a href="#cb83-2084" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-2085"><a href="#cb83-2085" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-2086"><a href="#cb83-2086" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb83-2087"><a href="#cb83-2087" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb83-2088"><a href="#cb83-2088" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-2089"><a href="#cb83-2089" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb83-2090"><a href="#cb83-2090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2091"><a href="#cb83-2091" aria-hidden="true" tabindex="-1"></a>all_effs_sex_ix_large_largeh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-2092"><a href="#cb83-2092" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2093"><a href="#cb83-2093" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2094"><a href="#cb83-2094" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2095"><a href="#cb83-2095" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2096"><a href="#cb83-2096" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2097"><a href="#cb83-2097" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2098"><a href="#cb83-2098" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2099"><a href="#cb83-2099" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2100"><a href="#cb83-2100" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2101"><a href="#cb83-2101" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2102"><a href="#cb83-2102" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2103"><a href="#cb83-2103" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2104"><a href="#cb83-2104" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2105"><a href="#cb83-2105" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2106"><a href="#cb83-2106" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2107"><a href="#cb83-2107" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2108"><a href="#cb83-2108" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2109"><a href="#cb83-2109" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2110"><a href="#cb83-2110" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2111"><a href="#cb83-2111" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2112"><a href="#cb83-2112" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2113"><a href="#cb83-2113" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2114"><a href="#cb83-2114" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2115"><a href="#cb83-2115" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2116"><a href="#cb83-2116" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2117"><a href="#cb83-2117" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2118"><a href="#cb83-2118" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2119"><a href="#cb83-2119" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2120"><a href="#cb83-2120" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2121"><a href="#cb83-2121" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2122"><a href="#cb83-2122" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2123"><a href="#cb83-2123" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2124"><a href="#cb83-2124" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2125"><a href="#cb83-2125" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2126"><a href="#cb83-2126" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2127"><a href="#cb83-2127" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2128"><a href="#cb83-2128" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2129"><a href="#cb83-2129" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2130"><a href="#cb83-2130" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2131"><a href="#cb83-2131" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2132"><a href="#cb83-2132" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2133"><a href="#cb83-2133" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2134"><a href="#cb83-2134" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2135"><a href="#cb83-2135" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2136"><a href="#cb83-2136" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2137"><a href="#cb83-2137" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2138"><a href="#cb83-2138" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2139"><a href="#cb83-2139" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2140"><a href="#cb83-2140" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2141"><a href="#cb83-2141" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2142"><a href="#cb83-2142" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2143"><a href="#cb83-2143" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2144"><a href="#cb83-2144" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2145"><a href="#cb83-2145" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2146"><a href="#cb83-2146" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2147"><a href="#cb83-2147" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2148"><a href="#cb83-2148" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2149"><a href="#cb83-2149" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2150"><a href="#cb83-2150" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2151"><a href="#cb83-2151" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2152"><a href="#cb83-2152" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2153"><a href="#cb83-2153" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2154"><a href="#cb83-2154" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2155"><a href="#cb83-2155" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2156"><a href="#cb83-2156" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2157"><a href="#cb83-2157" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-2158"><a href="#cb83-2158" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-2159"><a href="#cb83-2159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2160"><a href="#cb83-2160" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_large_largeh <span class="ot">&lt;-</span> all_effs_sex_ix_large_largeh <span class="sc">%&gt;%</span></span>
<span id="cb83-2161"><a href="#cb83-2161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-2162"><a href="#cb83-2162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, ix_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb83-2163"><a href="#cb83-2163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb83-2164"><a href="#cb83-2164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-2165"><a href="#cb83-2165" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-2166"><a href="#cb83-2166" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>))</span>
<span id="cb83-2167"><a href="#cb83-2167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2168"><a href="#cb83-2168" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_large_largeh <span class="sc">%&gt;%</span></span>
<span id="cb83-2169"><a href="#cb83-2169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-2170"><a href="#cb83-2170" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-2171"><a href="#cb83-2171" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-2172"><a href="#cb83-2172" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb83-2173"><a href="#cb83-2173" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-2174"><a href="#cb83-2174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2175"><a href="#cb83-2175" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-2176"><a href="#cb83-2176" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb83-2177"><a href="#cb83-2177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2178"><a href="#cb83-2178" aria-hidden="true" tabindex="-1"></a>Power consequences of heteroscedasticities with varying (magnitude-only) interaction.</span>
<span id="cb83-2179"><a href="#cb83-2179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2182"><a href="#cb83-2182" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-2183"><a href="#cb83-2183" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb83-2184"><a href="#cb83-2184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2185"><a href="#cb83-2185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2186"><a href="#cb83-2186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2187"><a href="#cb83-2187" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="ot">&lt;-</span> <span class="fu">rbind</span>(calc_power_sex_ix_small,</span>
<span id="cb83-2188"><a href="#cb83-2188" aria-hidden="true" tabindex="-1"></a>                               calc_power_sex_ix_large,</span>
<span id="cb83-2189"><a href="#cb83-2189" aria-hidden="true" tabindex="-1"></a>                               calc_power_sex_ix_small_lowh,</span>
<span id="cb83-2190"><a href="#cb83-2190" aria-hidden="true" tabindex="-1"></a>                               calc_power_sex_ix_large_lowh,</span>
<span id="cb83-2191"><a href="#cb83-2191" aria-hidden="true" tabindex="-1"></a>                               calc_power_sex_ix_small_largeh,</span>
<span id="cb83-2192"><a href="#cb83-2192" aria-hidden="true" tabindex="-1"></a>                               calc_power_sex_ix_large_largeh)</span>
<span id="cb83-2193"><a href="#cb83-2193" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">lapply</span>(all_sex_effs_sex_only, unlist))</span>
<span id="cb83-2194"><a href="#cb83-2194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2195"><a href="#cb83-2195" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="sc">%&gt;%</span></span>
<span id="cb83-2196"><a href="#cb83-2196" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Effect <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Treatment"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-2197"><a href="#cb83-2197" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">factor</span>(ix_eff_size,</span>
<span id="cb83-2198"><a href="#cb83-2198" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"small"</span>, <span class="st">"large"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb83-2199"><a href="#cb83-2199" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">recode</span>(method,</span>
<span id="cb83-2200"><a href="#cb83-2200" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"ANOVA"</span> <span class="ot">=</span> <span class="st">"Factorial"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-2201"><a href="#cb83-2201" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">factor</span>(heterosc,</span>
<span id="cb83-2202"><a href="#cb83-2202" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"large"</span>, <span class="st">"low"</span>, <span class="st">"none"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb83-2203"><a href="#cb83-2203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> ix_eff_size,</span>
<span id="cb83-2204"><a href="#cb83-2204" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> <span class="fu">interaction</span>(ix_eff_size, heterosc))) <span class="sc">+</span></span>
<span id="cb83-2205"><a href="#cb83-2205" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-2206"><a href="#cb83-2206" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> heterosc)) <span class="sc">+</span></span>
<span id="cb83-2207"><a href="#cb83-2207" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb83-2208"><a href="#cb83-2208" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Statistical power"</span>) <span class="sc">+</span></span>
<span id="cb83-2209"><a href="#cb83-2209" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Main treatment effect"</span>) <span class="sc">+</span></span>
<span id="cb83-2210"><a href="#cb83-2210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">name =</span> <span class="st">"Ix effect size"</span>, <span class="at">values =</span> cbb_palette) <span class="sc">+</span></span>
<span id="cb83-2211"><a href="#cb83-2211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_discrete</span>(<span class="at">name =</span> <span class="st">"Heteroscedasticity"</span>)  <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-2212"><a href="#cb83-2212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2213"><a href="#cb83-2213" aria-hidden="true" tabindex="-1"></a>plotB <span class="ot">&lt;-</span> all_sex_effs_sex_only <span class="sc">%&gt;%</span></span>
<span id="cb83-2214"><a href="#cb83-2214" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ix_eff_size <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-2215"><a href="#cb83-2215" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sex_eff_size = factor(sex_eff_size,</span></span>
<span id="cb83-2216"><a href="#cb83-2216" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("none", "small", "large"))) %&gt;%</span></span>
<span id="cb83-2217"><a href="#cb83-2217" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">factor</span>(heterosc,</span>
<span id="cb83-2218"><a href="#cb83-2218" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"large"</span>, <span class="st">"low"</span>, <span class="st">"none"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb83-2219"><a href="#cb83-2219" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-2220"><a href="#cb83-2220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-2221"><a href="#cb83-2221" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> heterosc)) <span class="sc">+</span></span>
<span id="cb83-2222"><a href="#cb83-2222" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb83-2223"><a href="#cb83-2223" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Statistical power"</span>) <span class="sc">+</span></span>
<span id="cb83-2224"><a href="#cb83-2224" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Main treatment effect"</span>) <span class="sc">+</span></span>
<span id="cb83-2225"><a href="#cb83-2225" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">name =</span> <span class="st">"Effect"</span>, <span class="at">values =</span> cbb_palette) <span class="sc">+</span></span>
<span id="cb83-2226"><a href="#cb83-2226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_discrete</span>(<span class="at">name =</span> <span class="st">"Heteroscedasticity"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-2227"><a href="#cb83-2227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2228"><a href="#cb83-2228" aria-hidden="true" tabindex="-1"></a>plotB</span>
<span id="cb83-2229"><a href="#cb83-2229" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-2230"><a href="#cb83-2230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2231"><a href="#cb83-2231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2232"><a href="#cb83-2232" aria-hidden="true" tabindex="-1"></a><span class="fu"># Scenarios from Fig. 5 - interaction of direction</span></span>
<span id="cb83-2233"><a href="#cb83-2233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2234"><a href="#cb83-2234" aria-hidden="true" tabindex="-1"></a><span class="fu">## From original paper</span></span>
<span id="cb83-2235"><a href="#cb83-2235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2236"><a href="#cb83-2236" aria-hidden="true" tabindex="-1"></a>Below simulations were only slightly modified. We assumed a strong (-1) overall effect of sex and a varying interaction resulting of crossing of sex effects on the treatment effect (0, -1, -2).</span>
<span id="cb83-2237"><a href="#cb83-2237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2238"><a href="#cb83-2238" aria-hidden="true" tabindex="-1"></a>**Assuming homoscedasticity of sex variances**</span>
<span id="cb83-2239"><a href="#cb83-2239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2240"><a href="#cb83-2240" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb83-2241"><a href="#cb83-2241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2242"><a href="#cb83-2242" aria-hidden="true" tabindex="-1"></a><span class="fu">## No sex eff, no ix</span></span>
<span id="cb83-2243"><a href="#cb83-2243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2246"><a href="#cb83-2246" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-2247"><a href="#cb83-2247" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb83-2248"><a href="#cb83-2248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2249"><a href="#cb83-2249" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb83-2250"><a href="#cb83-2250" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-2251"><a href="#cb83-2251" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-2252"><a href="#cb83-2252" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-2253"><a href="#cb83-2253" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb83-2254"><a href="#cb83-2254" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-2255"><a href="#cb83-2255" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-2256"><a href="#cb83-2256" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb83-2257"><a href="#cb83-2257" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb83-2258"><a href="#cb83-2258" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-2259"><a href="#cb83-2259" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span><span class="dv">0</span></span>
<span id="cb83-2260"><a href="#cb83-2260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2261"><a href="#cb83-2261" aria-hidden="true" tabindex="-1"></a>all_effs_sex_ix_none <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-2262"><a href="#cb83-2262" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2263"><a href="#cb83-2263" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2264"><a href="#cb83-2264" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2265"><a href="#cb83-2265" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2266"><a href="#cb83-2266" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2267"><a href="#cb83-2267" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2268"><a href="#cb83-2268" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2269"><a href="#cb83-2269" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2270"><a href="#cb83-2270" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2271"><a href="#cb83-2271" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2272"><a href="#cb83-2272" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2273"><a href="#cb83-2273" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2274"><a href="#cb83-2274" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2275"><a href="#cb83-2275" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2276"><a href="#cb83-2276" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2277"><a href="#cb83-2277" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2278"><a href="#cb83-2278" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2279"><a href="#cb83-2279" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2280"><a href="#cb83-2280" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2281"><a href="#cb83-2281" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2282"><a href="#cb83-2282" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2283"><a href="#cb83-2283" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2284"><a href="#cb83-2284" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2285"><a href="#cb83-2285" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2286"><a href="#cb83-2286" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2287"><a href="#cb83-2287" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2288"><a href="#cb83-2288" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2289"><a href="#cb83-2289" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2290"><a href="#cb83-2290" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2291"><a href="#cb83-2291" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2292"><a href="#cb83-2292" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2293"><a href="#cb83-2293" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2294"><a href="#cb83-2294" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2295"><a href="#cb83-2295" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2296"><a href="#cb83-2296" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2297"><a href="#cb83-2297" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2298"><a href="#cb83-2298" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2299"><a href="#cb83-2299" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2300"><a href="#cb83-2300" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2301"><a href="#cb83-2301" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2302"><a href="#cb83-2302" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2303"><a href="#cb83-2303" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2304"><a href="#cb83-2304" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2305"><a href="#cb83-2305" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2306"><a href="#cb83-2306" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2307"><a href="#cb83-2307" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2308"><a href="#cb83-2308" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2309"><a href="#cb83-2309" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2310"><a href="#cb83-2310" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2311"><a href="#cb83-2311" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2312"><a href="#cb83-2312" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2313"><a href="#cb83-2313" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2314"><a href="#cb83-2314" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2315"><a href="#cb83-2315" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2316"><a href="#cb83-2316" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2317"><a href="#cb83-2317" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2318"><a href="#cb83-2318" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2319"><a href="#cb83-2319" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2320"><a href="#cb83-2320" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2321"><a href="#cb83-2321" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2322"><a href="#cb83-2322" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2323"><a href="#cb83-2323" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2324"><a href="#cb83-2324" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2325"><a href="#cb83-2325" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2326"><a href="#cb83-2326" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2327"><a href="#cb83-2327" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-2328"><a href="#cb83-2328" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-2329"><a href="#cb83-2329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2330"><a href="#cb83-2330" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_none <span class="ot">&lt;-</span> all_effs_sex_ix_none <span class="sc">%&gt;%</span></span>
<span id="cb83-2331"><a href="#cb83-2331" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-2332"><a href="#cb83-2332" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, ix_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb83-2333"><a href="#cb83-2333" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb83-2334"><a href="#cb83-2334" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"small"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-2335"><a href="#cb83-2335" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"none"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-2336"><a href="#cb83-2336" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"none"</span>))</span>
<span id="cb83-2337"><a href="#cb83-2337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2338"><a href="#cb83-2338" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_none <span class="sc">%&gt;%</span></span>
<span id="cb83-2339"><a href="#cb83-2339" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-2340"><a href="#cb83-2340" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-2341"><a href="#cb83-2341" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-2342"><a href="#cb83-2342" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb83-2343"><a href="#cb83-2343" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-2344"><a href="#cb83-2344" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-2345"><a href="#cb83-2345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2346"><a href="#cb83-2346" aria-hidden="true" tabindex="-1"></a><span class="fu">## Small sex eff, no ix</span></span>
<span id="cb83-2347"><a href="#cb83-2347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2350"><a href="#cb83-2350" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-2351"><a href="#cb83-2351" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb83-2352"><a href="#cb83-2352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2353"><a href="#cb83-2353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2354"><a href="#cb83-2354" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb83-2355"><a href="#cb83-2355" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-2356"><a href="#cb83-2356" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-2357"><a href="#cb83-2357" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-2358"><a href="#cb83-2358" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb83-2359"><a href="#cb83-2359" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-2360"><a href="#cb83-2360" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-2361"><a href="#cb83-2361" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb83-2362"><a href="#cb83-2362" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb83-2363"><a href="#cb83-2363" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb83-2364"><a href="#cb83-2364" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-2365"><a href="#cb83-2365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2366"><a href="#cb83-2366" aria-hidden="true" tabindex="-1"></a>all_effs_sex_ix_small <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-2367"><a href="#cb83-2367" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2368"><a href="#cb83-2368" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2369"><a href="#cb83-2369" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2370"><a href="#cb83-2370" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2371"><a href="#cb83-2371" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2372"><a href="#cb83-2372" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2373"><a href="#cb83-2373" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2374"><a href="#cb83-2374" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2375"><a href="#cb83-2375" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2376"><a href="#cb83-2376" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2377"><a href="#cb83-2377" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2378"><a href="#cb83-2378" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2379"><a href="#cb83-2379" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2380"><a href="#cb83-2380" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2381"><a href="#cb83-2381" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2382"><a href="#cb83-2382" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2383"><a href="#cb83-2383" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2384"><a href="#cb83-2384" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2385"><a href="#cb83-2385" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2386"><a href="#cb83-2386" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2387"><a href="#cb83-2387" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2388"><a href="#cb83-2388" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2389"><a href="#cb83-2389" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2390"><a href="#cb83-2390" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2391"><a href="#cb83-2391" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2392"><a href="#cb83-2392" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2393"><a href="#cb83-2393" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2394"><a href="#cb83-2394" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2395"><a href="#cb83-2395" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2396"><a href="#cb83-2396" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2397"><a href="#cb83-2397" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2398"><a href="#cb83-2398" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2399"><a href="#cb83-2399" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2400"><a href="#cb83-2400" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2401"><a href="#cb83-2401" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2402"><a href="#cb83-2402" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2403"><a href="#cb83-2403" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2404"><a href="#cb83-2404" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2405"><a href="#cb83-2405" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2406"><a href="#cb83-2406" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2407"><a href="#cb83-2407" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2408"><a href="#cb83-2408" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2409"><a href="#cb83-2409" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2410"><a href="#cb83-2410" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2411"><a href="#cb83-2411" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2412"><a href="#cb83-2412" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2413"><a href="#cb83-2413" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2414"><a href="#cb83-2414" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2415"><a href="#cb83-2415" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2416"><a href="#cb83-2416" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2417"><a href="#cb83-2417" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2418"><a href="#cb83-2418" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2419"><a href="#cb83-2419" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2420"><a href="#cb83-2420" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2421"><a href="#cb83-2421" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2422"><a href="#cb83-2422" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2423"><a href="#cb83-2423" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2424"><a href="#cb83-2424" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2425"><a href="#cb83-2425" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2426"><a href="#cb83-2426" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2427"><a href="#cb83-2427" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2428"><a href="#cb83-2428" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2429"><a href="#cb83-2429" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2430"><a href="#cb83-2430" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2431"><a href="#cb83-2431" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2432"><a href="#cb83-2432" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-2433"><a href="#cb83-2433" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-2434"><a href="#cb83-2434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2435"><a href="#cb83-2435" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_small <span class="ot">&lt;-</span> all_effs_sex_ix_small <span class="sc">%&gt;%</span></span>
<span id="cb83-2436"><a href="#cb83-2436" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-2437"><a href="#cb83-2437" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, ix_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb83-2438"><a href="#cb83-2438" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb83-2439"><a href="#cb83-2439" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"small"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-2440"><a href="#cb83-2440" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"none"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-2441"><a href="#cb83-2441" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"small"</span>))</span>
<span id="cb83-2442"><a href="#cb83-2442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2443"><a href="#cb83-2443" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_small <span class="sc">%&gt;%</span></span>
<span id="cb83-2444"><a href="#cb83-2444" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-2445"><a href="#cb83-2445" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-2446"><a href="#cb83-2446" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-2447"><a href="#cb83-2447" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb83-2448"><a href="#cb83-2448" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-2449"><a href="#cb83-2449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2450"><a href="#cb83-2450" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-2451"><a href="#cb83-2451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2452"><a href="#cb83-2452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2453"><a href="#cb83-2453" aria-hidden="true" tabindex="-1"></a><span class="fu">## Large sex eff, no ix</span></span>
<span id="cb83-2454"><a href="#cb83-2454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2457"><a href="#cb83-2457" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-2458"><a href="#cb83-2458" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb83-2459"><a href="#cb83-2459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2460"><a href="#cb83-2460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2461"><a href="#cb83-2461" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb83-2462"><a href="#cb83-2462" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-2463"><a href="#cb83-2463" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-2464"><a href="#cb83-2464" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-2465"><a href="#cb83-2465" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb83-2466"><a href="#cb83-2466" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-2467"><a href="#cb83-2467" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-2468"><a href="#cb83-2468" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb83-2469"><a href="#cb83-2469" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb83-2470"><a href="#cb83-2470" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span></span>
<span id="cb83-2471"><a href="#cb83-2471" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-2472"><a href="#cb83-2472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2473"><a href="#cb83-2473" aria-hidden="true" tabindex="-1"></a>all_effs_sex_ix_large <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-2474"><a href="#cb83-2474" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2475"><a href="#cb83-2475" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2476"><a href="#cb83-2476" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2477"><a href="#cb83-2477" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2478"><a href="#cb83-2478" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2479"><a href="#cb83-2479" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2480"><a href="#cb83-2480" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2481"><a href="#cb83-2481" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2482"><a href="#cb83-2482" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2483"><a href="#cb83-2483" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2484"><a href="#cb83-2484" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2485"><a href="#cb83-2485" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2486"><a href="#cb83-2486" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2487"><a href="#cb83-2487" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2488"><a href="#cb83-2488" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2489"><a href="#cb83-2489" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2490"><a href="#cb83-2490" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2491"><a href="#cb83-2491" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2492"><a href="#cb83-2492" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2493"><a href="#cb83-2493" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2494"><a href="#cb83-2494" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2495"><a href="#cb83-2495" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2496"><a href="#cb83-2496" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2497"><a href="#cb83-2497" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2498"><a href="#cb83-2498" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2499"><a href="#cb83-2499" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2500"><a href="#cb83-2500" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2501"><a href="#cb83-2501" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2502"><a href="#cb83-2502" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2503"><a href="#cb83-2503" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2504"><a href="#cb83-2504" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2505"><a href="#cb83-2505" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2506"><a href="#cb83-2506" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2507"><a href="#cb83-2507" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2508"><a href="#cb83-2508" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2509"><a href="#cb83-2509" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2510"><a href="#cb83-2510" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2511"><a href="#cb83-2511" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2512"><a href="#cb83-2512" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2513"><a href="#cb83-2513" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2514"><a href="#cb83-2514" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2515"><a href="#cb83-2515" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2516"><a href="#cb83-2516" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2517"><a href="#cb83-2517" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2518"><a href="#cb83-2518" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2519"><a href="#cb83-2519" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2520"><a href="#cb83-2520" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2521"><a href="#cb83-2521" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2522"><a href="#cb83-2522" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2523"><a href="#cb83-2523" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2524"><a href="#cb83-2524" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2525"><a href="#cb83-2525" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2526"><a href="#cb83-2526" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2527"><a href="#cb83-2527" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2528"><a href="#cb83-2528" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2529"><a href="#cb83-2529" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2530"><a href="#cb83-2530" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2531"><a href="#cb83-2531" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2532"><a href="#cb83-2532" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2533"><a href="#cb83-2533" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2534"><a href="#cb83-2534" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2535"><a href="#cb83-2535" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2536"><a href="#cb83-2536" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2537"><a href="#cb83-2537" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2538"><a href="#cb83-2538" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2539"><a href="#cb83-2539" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-2540"><a href="#cb83-2540" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-2541"><a href="#cb83-2541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2542"><a href="#cb83-2542" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_large <span class="ot">&lt;-</span> all_effs_sex_ix_large <span class="sc">%&gt;%</span></span>
<span id="cb83-2543"><a href="#cb83-2543" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-2544"><a href="#cb83-2544" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, ix_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb83-2545"><a href="#cb83-2545" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb83-2546"><a href="#cb83-2546" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-2547"><a href="#cb83-2547" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"none"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-2548"><a href="#cb83-2548" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>))</span>
<span id="cb83-2549"><a href="#cb83-2549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2550"><a href="#cb83-2550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2551"><a href="#cb83-2551" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_large <span class="sc">%&gt;%</span></span>
<span id="cb83-2552"><a href="#cb83-2552" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-2553"><a href="#cb83-2553" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-2554"><a href="#cb83-2554" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-2555"><a href="#cb83-2555" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb83-2556"><a href="#cb83-2556" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-2557"><a href="#cb83-2557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2558"><a href="#cb83-2558" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-2559"><a href="#cb83-2559" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb83-2560"><a href="#cb83-2560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2561"><a href="#cb83-2561" aria-hidden="true" tabindex="-1"></a>Plots combining all scenarios from Fig. 1</span>
<span id="cb83-2562"><a href="#cb83-2562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2565"><a href="#cb83-2565" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-2566"><a href="#cb83-2566" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb83-2567"><a href="#cb83-2567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2568"><a href="#cb83-2568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2569"><a href="#cb83-2569" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="ot">&lt;-</span> <span class="fu">rbind</span>(calc_power_sex_ix_none, calc_power_sex_ix_small,</span>
<span id="cb83-2570"><a href="#cb83-2570" aria-hidden="true" tabindex="-1"></a>                               calc_power_sex_ix_large)</span>
<span id="cb83-2571"><a href="#cb83-2571" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">lapply</span>(all_sex_effs_sex_only, unlist))</span>
<span id="cb83-2572"><a href="#cb83-2572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2573"><a href="#cb83-2573" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="sc">%&gt;%</span></span>
<span id="cb83-2574"><a href="#cb83-2574" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Effect <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Treatment"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-2575"><a href="#cb83-2575" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">factor</span>(ix_eff_size,</span>
<span id="cb83-2576"><a href="#cb83-2576" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"none"</span>, <span class="st">"small"</span>, <span class="st">"large"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb83-2577"><a href="#cb83-2577" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">recode</span>(method,</span>
<span id="cb83-2578"><a href="#cb83-2578" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"ANOVA"</span> <span class="ot">=</span> <span class="st">"Factorial"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-2579"><a href="#cb83-2579" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> ix_eff_size,</span>
<span id="cb83-2580"><a href="#cb83-2580" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> <span class="fu">interaction</span>(ix_eff_size, method))) <span class="sc">+</span></span>
<span id="cb83-2581"><a href="#cb83-2581" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-2582"><a href="#cb83-2582" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> method)) <span class="sc">+</span></span>
<span id="cb83-2583"><a href="#cb83-2583" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb83-2584"><a href="#cb83-2584" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Statistical power"</span>) <span class="sc">+</span></span>
<span id="cb83-2585"><a href="#cb83-2585" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Main treatment effect"</span>) <span class="sc">+</span></span>
<span id="cb83-2586"><a href="#cb83-2586" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">name =</span> <span class="st">"Ix effect size"</span>, <span class="at">values =</span> cbb_palette) <span class="sc">+</span></span>
<span id="cb83-2587"><a href="#cb83-2587" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_discrete</span>(<span class="at">name =</span> <span class="st">"Stat method"</span>)  <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-2588"><a href="#cb83-2588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2589"><a href="#cb83-2589" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="sc">%&gt;%</span></span>
<span id="cb83-2590"><a href="#cb83-2590" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(!Effect %in% c("T-Test Treatment Eff")) %&gt;%</span></span>
<span id="cb83-2591"><a href="#cb83-2591" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">factor</span>(ix_eff_size,</span>
<span id="cb83-2592"><a href="#cb83-2592" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"none"</span>, <span class="st">"small"</span>, <span class="st">"large"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb83-2593"><a href="#cb83-2593" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect,</span>
<span id="cb83-2594"><a href="#cb83-2594" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> <span class="fu">interaction</span>(ix_eff_size, Effect))) <span class="sc">+</span></span>
<span id="cb83-2595"><a href="#cb83-2595" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-2596"><a href="#cb83-2596" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> ix_eff_size)) <span class="sc">+</span></span>
<span id="cb83-2597"><a href="#cb83-2597" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb83-2598"><a href="#cb83-2598" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Statistical power"</span>) <span class="sc">+</span></span>
<span id="cb83-2599"><a href="#cb83-2599" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Main treatment effect"</span>) <span class="sc">+</span></span>
<span id="cb83-2600"><a href="#cb83-2600" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">name =</span> <span class="st">"Effect"</span>, <span class="at">values =</span> cbb_palette) <span class="sc">+</span></span>
<span id="cb83-2601"><a href="#cb83-2601" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_discrete</span>(<span class="at">name =</span> <span class="st">"Ix effect size"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-2602"><a href="#cb83-2602" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-2603"><a href="#cb83-2603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2604"><a href="#cb83-2604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2605"><a href="#cb83-2605" aria-hidden="true" tabindex="-1"></a><span class="fu">## Heteroscedastic sex variances</span></span>
<span id="cb83-2606"><a href="#cb83-2606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2607"><a href="#cb83-2607" aria-hidden="true" tabindex="-1"></a>We assume several scenarios with $\alpha$ equal to 0 (the above scenarios), 1 and 2, which relates to 100% or 200% increase in male variance, in relation to female variance (or ~44% and ~73% increase in male SD). The direction of sex bias is arbitrary.</span>
<span id="cb83-2608"><a href="#cb83-2608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2609"><a href="#cb83-2609" aria-hidden="true" tabindex="-1"></a>**Low heteroscedasticity**</span>
<span id="cb83-2610"><a href="#cb83-2610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2613"><a href="#cb83-2613" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-2614"><a href="#cb83-2614" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-2615"><a href="#cb83-2615" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-2616"><a href="#cb83-2616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2617"><a href="#cb83-2617" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb83-2618"><a href="#cb83-2618" aria-hidden="true" tabindex="-1"></a><span class="fu">## Small sex eff, no ix</span></span>
<span id="cb83-2619"><a href="#cb83-2619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2622"><a href="#cb83-2622" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-2623"><a href="#cb83-2623" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb83-2624"><a href="#cb83-2624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2625"><a href="#cb83-2625" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb83-2626"><a href="#cb83-2626" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-2627"><a href="#cb83-2627" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-2628"><a href="#cb83-2628" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-2629"><a href="#cb83-2629" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb83-2630"><a href="#cb83-2630" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-2631"><a href="#cb83-2631" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-2632"><a href="#cb83-2632" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb83-2633"><a href="#cb83-2633" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb83-2634"><a href="#cb83-2634" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-2635"><a href="#cb83-2635" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb83-2636"><a href="#cb83-2636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2637"><a href="#cb83-2637" aria-hidden="true" tabindex="-1"></a>all_effs_sex_ix_none_lowh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-2638"><a href="#cb83-2638" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2639"><a href="#cb83-2639" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2640"><a href="#cb83-2640" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2641"><a href="#cb83-2641" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2642"><a href="#cb83-2642" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2643"><a href="#cb83-2643" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2644"><a href="#cb83-2644" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2645"><a href="#cb83-2645" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2646"><a href="#cb83-2646" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2647"><a href="#cb83-2647" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2648"><a href="#cb83-2648" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2649"><a href="#cb83-2649" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2650"><a href="#cb83-2650" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2651"><a href="#cb83-2651" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2652"><a href="#cb83-2652" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2653"><a href="#cb83-2653" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2654"><a href="#cb83-2654" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2655"><a href="#cb83-2655" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2656"><a href="#cb83-2656" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2657"><a href="#cb83-2657" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2658"><a href="#cb83-2658" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2659"><a href="#cb83-2659" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2660"><a href="#cb83-2660" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2661"><a href="#cb83-2661" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2662"><a href="#cb83-2662" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2663"><a href="#cb83-2663" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2664"><a href="#cb83-2664" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2665"><a href="#cb83-2665" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2666"><a href="#cb83-2666" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2667"><a href="#cb83-2667" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2668"><a href="#cb83-2668" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2669"><a href="#cb83-2669" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2670"><a href="#cb83-2670" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2671"><a href="#cb83-2671" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2672"><a href="#cb83-2672" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2673"><a href="#cb83-2673" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2674"><a href="#cb83-2674" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2675"><a href="#cb83-2675" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2676"><a href="#cb83-2676" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2677"><a href="#cb83-2677" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2678"><a href="#cb83-2678" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2679"><a href="#cb83-2679" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2680"><a href="#cb83-2680" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2681"><a href="#cb83-2681" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2682"><a href="#cb83-2682" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2683"><a href="#cb83-2683" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2684"><a href="#cb83-2684" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2685"><a href="#cb83-2685" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2686"><a href="#cb83-2686" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2687"><a href="#cb83-2687" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2688"><a href="#cb83-2688" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2689"><a href="#cb83-2689" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2690"><a href="#cb83-2690" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2691"><a href="#cb83-2691" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2692"><a href="#cb83-2692" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2693"><a href="#cb83-2693" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2694"><a href="#cb83-2694" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2695"><a href="#cb83-2695" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2696"><a href="#cb83-2696" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2697"><a href="#cb83-2697" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2698"><a href="#cb83-2698" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2699"><a href="#cb83-2699" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2700"><a href="#cb83-2700" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2701"><a href="#cb83-2701" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2702"><a href="#cb83-2702" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2703"><a href="#cb83-2703" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-2704"><a href="#cb83-2704" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-2705"><a href="#cb83-2705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2706"><a href="#cb83-2706" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_none_lowh <span class="ot">&lt;-</span> all_effs_sex_ix_none_lowh <span class="sc">%&gt;%</span></span>
<span id="cb83-2707"><a href="#cb83-2707" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-2708"><a href="#cb83-2708" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, ix_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb83-2709"><a href="#cb83-2709" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb83-2710"><a href="#cb83-2710" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"small"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-2711"><a href="#cb83-2711" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"low"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-2712"><a href="#cb83-2712" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"none"</span>))</span>
<span id="cb83-2713"><a href="#cb83-2713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2714"><a href="#cb83-2714" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_none_lowh <span class="sc">%&gt;%</span></span>
<span id="cb83-2715"><a href="#cb83-2715" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-2716"><a href="#cb83-2716" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-2717"><a href="#cb83-2717" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-2718"><a href="#cb83-2718" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb83-2719"><a href="#cb83-2719" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-2720"><a href="#cb83-2720" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-2721"><a href="#cb83-2721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2722"><a href="#cb83-2722" aria-hidden="true" tabindex="-1"></a><span class="fu">## Small sex eff, small ix</span></span>
<span id="cb83-2723"><a href="#cb83-2723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2726"><a href="#cb83-2726" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-2727"><a href="#cb83-2727" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb83-2728"><a href="#cb83-2728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2729"><a href="#cb83-2729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2730"><a href="#cb83-2730" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb83-2731"><a href="#cb83-2731" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-2732"><a href="#cb83-2732" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-2733"><a href="#cb83-2733" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-2734"><a href="#cb83-2734" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb83-2735"><a href="#cb83-2735" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-2736"><a href="#cb83-2736" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-2737"><a href="#cb83-2737" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb83-2738"><a href="#cb83-2738" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb83-2739"><a href="#cb83-2739" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb83-2740"><a href="#cb83-2740" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb83-2741"><a href="#cb83-2741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2742"><a href="#cb83-2742" aria-hidden="true" tabindex="-1"></a>all_effs_sex_ix_small_lowh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-2743"><a href="#cb83-2743" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2744"><a href="#cb83-2744" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2745"><a href="#cb83-2745" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2746"><a href="#cb83-2746" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2747"><a href="#cb83-2747" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2748"><a href="#cb83-2748" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2749"><a href="#cb83-2749" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2750"><a href="#cb83-2750" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2751"><a href="#cb83-2751" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2752"><a href="#cb83-2752" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2753"><a href="#cb83-2753" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2754"><a href="#cb83-2754" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2755"><a href="#cb83-2755" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2756"><a href="#cb83-2756" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2757"><a href="#cb83-2757" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2758"><a href="#cb83-2758" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2759"><a href="#cb83-2759" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2760"><a href="#cb83-2760" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2761"><a href="#cb83-2761" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2762"><a href="#cb83-2762" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2763"><a href="#cb83-2763" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2764"><a href="#cb83-2764" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2765"><a href="#cb83-2765" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2766"><a href="#cb83-2766" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2767"><a href="#cb83-2767" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2768"><a href="#cb83-2768" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2769"><a href="#cb83-2769" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2770"><a href="#cb83-2770" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2771"><a href="#cb83-2771" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2772"><a href="#cb83-2772" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2773"><a href="#cb83-2773" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2774"><a href="#cb83-2774" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2775"><a href="#cb83-2775" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2776"><a href="#cb83-2776" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2777"><a href="#cb83-2777" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2778"><a href="#cb83-2778" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2779"><a href="#cb83-2779" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2780"><a href="#cb83-2780" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2781"><a href="#cb83-2781" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2782"><a href="#cb83-2782" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2783"><a href="#cb83-2783" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2784"><a href="#cb83-2784" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2785"><a href="#cb83-2785" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2786"><a href="#cb83-2786" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2787"><a href="#cb83-2787" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2788"><a href="#cb83-2788" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2789"><a href="#cb83-2789" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2790"><a href="#cb83-2790" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2791"><a href="#cb83-2791" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2792"><a href="#cb83-2792" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2793"><a href="#cb83-2793" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2794"><a href="#cb83-2794" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2795"><a href="#cb83-2795" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2796"><a href="#cb83-2796" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2797"><a href="#cb83-2797" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2798"><a href="#cb83-2798" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2799"><a href="#cb83-2799" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2800"><a href="#cb83-2800" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2801"><a href="#cb83-2801" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2802"><a href="#cb83-2802" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2803"><a href="#cb83-2803" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2804"><a href="#cb83-2804" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2805"><a href="#cb83-2805" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2806"><a href="#cb83-2806" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2807"><a href="#cb83-2807" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2808"><a href="#cb83-2808" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-2809"><a href="#cb83-2809" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-2810"><a href="#cb83-2810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2811"><a href="#cb83-2811" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_small_lowh <span class="ot">&lt;-</span> all_effs_sex_ix_small_lowh <span class="sc">%&gt;%</span></span>
<span id="cb83-2812"><a href="#cb83-2812" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-2813"><a href="#cb83-2813" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, ix_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb83-2814"><a href="#cb83-2814" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb83-2815"><a href="#cb83-2815" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"small"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-2816"><a href="#cb83-2816" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"low"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-2817"><a href="#cb83-2817" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"small"</span>))</span>
<span id="cb83-2818"><a href="#cb83-2818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2819"><a href="#cb83-2819" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_small_lowh <span class="sc">%&gt;%</span></span>
<span id="cb83-2820"><a href="#cb83-2820" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-2821"><a href="#cb83-2821" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-2822"><a href="#cb83-2822" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-2823"><a href="#cb83-2823" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb83-2824"><a href="#cb83-2824" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-2825"><a href="#cb83-2825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2826"><a href="#cb83-2826" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-2827"><a href="#cb83-2827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2828"><a href="#cb83-2828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2829"><a href="#cb83-2829" aria-hidden="true" tabindex="-1"></a><span class="fu">## Small sex eff, large ix</span></span>
<span id="cb83-2830"><a href="#cb83-2830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2833"><a href="#cb83-2833" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-2834"><a href="#cb83-2834" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb83-2835"><a href="#cb83-2835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2836"><a href="#cb83-2836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2837"><a href="#cb83-2837" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb83-2838"><a href="#cb83-2838" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-2839"><a href="#cb83-2839" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-2840"><a href="#cb83-2840" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-2841"><a href="#cb83-2841" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb83-2842"><a href="#cb83-2842" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-2843"><a href="#cb83-2843" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-2844"><a href="#cb83-2844" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb83-2845"><a href="#cb83-2845" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb83-2846"><a href="#cb83-2846" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span></span>
<span id="cb83-2847"><a href="#cb83-2847" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb83-2848"><a href="#cb83-2848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2849"><a href="#cb83-2849" aria-hidden="true" tabindex="-1"></a>all_effs_sex_ix_large_lowh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-2850"><a href="#cb83-2850" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2851"><a href="#cb83-2851" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2852"><a href="#cb83-2852" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2853"><a href="#cb83-2853" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2854"><a href="#cb83-2854" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2855"><a href="#cb83-2855" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2856"><a href="#cb83-2856" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2857"><a href="#cb83-2857" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2858"><a href="#cb83-2858" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2859"><a href="#cb83-2859" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2860"><a href="#cb83-2860" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2861"><a href="#cb83-2861" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2862"><a href="#cb83-2862" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2863"><a href="#cb83-2863" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2864"><a href="#cb83-2864" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2865"><a href="#cb83-2865" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2866"><a href="#cb83-2866" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2867"><a href="#cb83-2867" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2868"><a href="#cb83-2868" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2869"><a href="#cb83-2869" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2870"><a href="#cb83-2870" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2871"><a href="#cb83-2871" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2872"><a href="#cb83-2872" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2873"><a href="#cb83-2873" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2874"><a href="#cb83-2874" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2875"><a href="#cb83-2875" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2876"><a href="#cb83-2876" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2877"><a href="#cb83-2877" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2878"><a href="#cb83-2878" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2879"><a href="#cb83-2879" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2880"><a href="#cb83-2880" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2881"><a href="#cb83-2881" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2882"><a href="#cb83-2882" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2883"><a href="#cb83-2883" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2884"><a href="#cb83-2884" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2885"><a href="#cb83-2885" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2886"><a href="#cb83-2886" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2887"><a href="#cb83-2887" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2888"><a href="#cb83-2888" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2889"><a href="#cb83-2889" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2890"><a href="#cb83-2890" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2891"><a href="#cb83-2891" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2892"><a href="#cb83-2892" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2893"><a href="#cb83-2893" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2894"><a href="#cb83-2894" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2895"><a href="#cb83-2895" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2896"><a href="#cb83-2896" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2897"><a href="#cb83-2897" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2898"><a href="#cb83-2898" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2899"><a href="#cb83-2899" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2900"><a href="#cb83-2900" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2901"><a href="#cb83-2901" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2902"><a href="#cb83-2902" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2903"><a href="#cb83-2903" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2904"><a href="#cb83-2904" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2905"><a href="#cb83-2905" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2906"><a href="#cb83-2906" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2907"><a href="#cb83-2907" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2908"><a href="#cb83-2908" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2909"><a href="#cb83-2909" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2910"><a href="#cb83-2910" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2911"><a href="#cb83-2911" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2912"><a href="#cb83-2912" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2913"><a href="#cb83-2913" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2914"><a href="#cb83-2914" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2915"><a href="#cb83-2915" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-2916"><a href="#cb83-2916" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-2917"><a href="#cb83-2917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2918"><a href="#cb83-2918" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_large_lowh <span class="ot">&lt;-</span> all_effs_sex_ix_large_lowh <span class="sc">%&gt;%</span></span>
<span id="cb83-2919"><a href="#cb83-2919" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-2920"><a href="#cb83-2920" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, ix_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb83-2921"><a href="#cb83-2921" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb83-2922"><a href="#cb83-2922" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"small"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-2923"><a href="#cb83-2923" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"low"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-2924"><a href="#cb83-2924" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>))</span>
<span id="cb83-2925"><a href="#cb83-2925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2926"><a href="#cb83-2926" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_large_lowh <span class="sc">%&gt;%</span></span>
<span id="cb83-2927"><a href="#cb83-2927" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-2928"><a href="#cb83-2928" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-2929"><a href="#cb83-2929" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-2930"><a href="#cb83-2930" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb83-2931"><a href="#cb83-2931" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-2932"><a href="#cb83-2932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2933"><a href="#cb83-2933" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-2934"><a href="#cb83-2934" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb83-2935"><a href="#cb83-2935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2936"><a href="#cb83-2936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2937"><a href="#cb83-2937" aria-hidden="true" tabindex="-1"></a>**Large heteroscedasticity**</span>
<span id="cb83-2938"><a href="#cb83-2938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2941"><a href="#cb83-2941" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-2942"><a href="#cb83-2942" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb83-2943"><a href="#cb83-2943" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-2944"><a href="#cb83-2944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2945"><a href="#cb83-2945" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb83-2946"><a href="#cb83-2946" aria-hidden="true" tabindex="-1"></a><span class="fu">## Small sex eff, no ix</span></span>
<span id="cb83-2947"><a href="#cb83-2947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2950"><a href="#cb83-2950" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-2951"><a href="#cb83-2951" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb83-2952"><a href="#cb83-2952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2953"><a href="#cb83-2953" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb83-2954"><a href="#cb83-2954" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-2955"><a href="#cb83-2955" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-2956"><a href="#cb83-2956" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-2957"><a href="#cb83-2957" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb83-2958"><a href="#cb83-2958" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-2959"><a href="#cb83-2959" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-2960"><a href="#cb83-2960" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb83-2961"><a href="#cb83-2961" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb83-2962"><a href="#cb83-2962" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-2963"><a href="#cb83-2963" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb83-2964"><a href="#cb83-2964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-2965"><a href="#cb83-2965" aria-hidden="true" tabindex="-1"></a>all_effs_sex_ix_none_largeh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-2966"><a href="#cb83-2966" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2967"><a href="#cb83-2967" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2968"><a href="#cb83-2968" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2969"><a href="#cb83-2969" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2970"><a href="#cb83-2970" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2971"><a href="#cb83-2971" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2972"><a href="#cb83-2972" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2973"><a href="#cb83-2973" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2974"><a href="#cb83-2974" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2975"><a href="#cb83-2975" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2976"><a href="#cb83-2976" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2977"><a href="#cb83-2977" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2978"><a href="#cb83-2978" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2979"><a href="#cb83-2979" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2980"><a href="#cb83-2980" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2981"><a href="#cb83-2981" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2982"><a href="#cb83-2982" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2983"><a href="#cb83-2983" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2984"><a href="#cb83-2984" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2985"><a href="#cb83-2985" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2986"><a href="#cb83-2986" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2987"><a href="#cb83-2987" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2988"><a href="#cb83-2988" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2989"><a href="#cb83-2989" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2990"><a href="#cb83-2990" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2991"><a href="#cb83-2991" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2992"><a href="#cb83-2992" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2993"><a href="#cb83-2993" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-2994"><a href="#cb83-2994" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-2995"><a href="#cb83-2995" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-2996"><a href="#cb83-2996" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-2997"><a href="#cb83-2997" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-2998"><a href="#cb83-2998" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-2999"><a href="#cb83-2999" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3000"><a href="#cb83-3000" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3001"><a href="#cb83-3001" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3002"><a href="#cb83-3002" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3003"><a href="#cb83-3003" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3004"><a href="#cb83-3004" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3005"><a href="#cb83-3005" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3006"><a href="#cb83-3006" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3007"><a href="#cb83-3007" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3008"><a href="#cb83-3008" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3009"><a href="#cb83-3009" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3010"><a href="#cb83-3010" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3011"><a href="#cb83-3011" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3012"><a href="#cb83-3012" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3013"><a href="#cb83-3013" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3014"><a href="#cb83-3014" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3015"><a href="#cb83-3015" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3016"><a href="#cb83-3016" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3017"><a href="#cb83-3017" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3018"><a href="#cb83-3018" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3019"><a href="#cb83-3019" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3020"><a href="#cb83-3020" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3021"><a href="#cb83-3021" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3022"><a href="#cb83-3022" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3023"><a href="#cb83-3023" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3024"><a href="#cb83-3024" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3025"><a href="#cb83-3025" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3026"><a href="#cb83-3026" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3027"><a href="#cb83-3027" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3028"><a href="#cb83-3028" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3029"><a href="#cb83-3029" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3030"><a href="#cb83-3030" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3031"><a href="#cb83-3031" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-3032"><a href="#cb83-3032" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-3033"><a href="#cb83-3033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3034"><a href="#cb83-3034" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_none_largeh <span class="ot">&lt;-</span> all_effs_sex_ix_none_largeh <span class="sc">%&gt;%</span></span>
<span id="cb83-3035"><a href="#cb83-3035" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-3036"><a href="#cb83-3036" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, ix_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb83-3037"><a href="#cb83-3037" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb83-3038"><a href="#cb83-3038" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"small"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-3039"><a href="#cb83-3039" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-3040"><a href="#cb83-3040" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"none"</span>))</span>
<span id="cb83-3041"><a href="#cb83-3041" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3042"><a href="#cb83-3042" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_none_largeh <span class="sc">%&gt;%</span></span>
<span id="cb83-3043"><a href="#cb83-3043" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-3044"><a href="#cb83-3044" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-3045"><a href="#cb83-3045" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-3046"><a href="#cb83-3046" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb83-3047"><a href="#cb83-3047" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-3048"><a href="#cb83-3048" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-3049"><a href="#cb83-3049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3050"><a href="#cb83-3050" aria-hidden="true" tabindex="-1"></a><span class="fu">## Small sex eff, small ix</span></span>
<span id="cb83-3051"><a href="#cb83-3051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3054"><a href="#cb83-3054" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-3055"><a href="#cb83-3055" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb83-3056"><a href="#cb83-3056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3057"><a href="#cb83-3057" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3058"><a href="#cb83-3058" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb83-3059"><a href="#cb83-3059" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-3060"><a href="#cb83-3060" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-3061"><a href="#cb83-3061" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-3062"><a href="#cb83-3062" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb83-3063"><a href="#cb83-3063" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-3064"><a href="#cb83-3064" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-3065"><a href="#cb83-3065" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb83-3066"><a href="#cb83-3066" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb83-3067"><a href="#cb83-3067" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb83-3068"><a href="#cb83-3068" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb83-3069"><a href="#cb83-3069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3070"><a href="#cb83-3070" aria-hidden="true" tabindex="-1"></a>all_effs_sex_ix_small_largeh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-3071"><a href="#cb83-3071" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3072"><a href="#cb83-3072" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3073"><a href="#cb83-3073" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3074"><a href="#cb83-3074" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3075"><a href="#cb83-3075" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3076"><a href="#cb83-3076" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3077"><a href="#cb83-3077" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3078"><a href="#cb83-3078" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3079"><a href="#cb83-3079" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3080"><a href="#cb83-3080" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3081"><a href="#cb83-3081" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3082"><a href="#cb83-3082" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3083"><a href="#cb83-3083" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3084"><a href="#cb83-3084" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3085"><a href="#cb83-3085" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3086"><a href="#cb83-3086" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3087"><a href="#cb83-3087" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3088"><a href="#cb83-3088" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3089"><a href="#cb83-3089" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3090"><a href="#cb83-3090" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3091"><a href="#cb83-3091" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3092"><a href="#cb83-3092" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3093"><a href="#cb83-3093" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3094"><a href="#cb83-3094" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3095"><a href="#cb83-3095" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3096"><a href="#cb83-3096" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3097"><a href="#cb83-3097" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3098"><a href="#cb83-3098" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3099"><a href="#cb83-3099" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3100"><a href="#cb83-3100" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3101"><a href="#cb83-3101" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3102"><a href="#cb83-3102" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3103"><a href="#cb83-3103" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3104"><a href="#cb83-3104" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3105"><a href="#cb83-3105" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3106"><a href="#cb83-3106" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3107"><a href="#cb83-3107" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3108"><a href="#cb83-3108" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3109"><a href="#cb83-3109" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3110"><a href="#cb83-3110" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3111"><a href="#cb83-3111" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3112"><a href="#cb83-3112" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3113"><a href="#cb83-3113" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3114"><a href="#cb83-3114" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3115"><a href="#cb83-3115" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3116"><a href="#cb83-3116" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3117"><a href="#cb83-3117" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3118"><a href="#cb83-3118" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3119"><a href="#cb83-3119" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3120"><a href="#cb83-3120" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3121"><a href="#cb83-3121" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3122"><a href="#cb83-3122" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3123"><a href="#cb83-3123" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3124"><a href="#cb83-3124" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3125"><a href="#cb83-3125" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3126"><a href="#cb83-3126" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3127"><a href="#cb83-3127" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3128"><a href="#cb83-3128" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3129"><a href="#cb83-3129" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3130"><a href="#cb83-3130" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3131"><a href="#cb83-3131" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3132"><a href="#cb83-3132" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3133"><a href="#cb83-3133" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3134"><a href="#cb83-3134" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3135"><a href="#cb83-3135" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3136"><a href="#cb83-3136" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-3137"><a href="#cb83-3137" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-3138"><a href="#cb83-3138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3139"><a href="#cb83-3139" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_small_largeh <span class="ot">&lt;-</span> all_effs_sex_ix_small_largeh <span class="sc">%&gt;%</span></span>
<span id="cb83-3140"><a href="#cb83-3140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-3141"><a href="#cb83-3141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, ix_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb83-3142"><a href="#cb83-3142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb83-3143"><a href="#cb83-3143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"small"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-3144"><a href="#cb83-3144" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-3145"><a href="#cb83-3145" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"small"</span>))</span>
<span id="cb83-3146"><a href="#cb83-3146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3147"><a href="#cb83-3147" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_small_largeh <span class="sc">%&gt;%</span></span>
<span id="cb83-3148"><a href="#cb83-3148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-3149"><a href="#cb83-3149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-3150"><a href="#cb83-3150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-3151"><a href="#cb83-3151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb83-3152"><a href="#cb83-3152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-3153"><a href="#cb83-3153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3154"><a href="#cb83-3154" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-3155"><a href="#cb83-3155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3156"><a href="#cb83-3156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3157"><a href="#cb83-3157" aria-hidden="true" tabindex="-1"></a><span class="fu">## Small sex eff, large ix</span></span>
<span id="cb83-3158"><a href="#cb83-3158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3161"><a href="#cb83-3161" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-3162"><a href="#cb83-3162" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb83-3163"><a href="#cb83-3163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3164"><a href="#cb83-3164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3165"><a href="#cb83-3165" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb83-3166"><a href="#cb83-3166" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-3167"><a href="#cb83-3167" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-3168"><a href="#cb83-3168" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-3169"><a href="#cb83-3169" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb83-3170"><a href="#cb83-3170" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-3171"><a href="#cb83-3171" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-3172"><a href="#cb83-3172" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb83-3173"><a href="#cb83-3173" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb83-3174"><a href="#cb83-3174" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span></span>
<span id="cb83-3175"><a href="#cb83-3175" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb83-3176"><a href="#cb83-3176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3177"><a href="#cb83-3177" aria-hidden="true" tabindex="-1"></a>all_effs_sex_ix_large_largeh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-3178"><a href="#cb83-3178" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3179"><a href="#cb83-3179" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3180"><a href="#cb83-3180" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3181"><a href="#cb83-3181" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3182"><a href="#cb83-3182" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3183"><a href="#cb83-3183" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3184"><a href="#cb83-3184" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3185"><a href="#cb83-3185" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3186"><a href="#cb83-3186" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3187"><a href="#cb83-3187" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3188"><a href="#cb83-3188" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3189"><a href="#cb83-3189" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3190"><a href="#cb83-3190" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3191"><a href="#cb83-3191" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3192"><a href="#cb83-3192" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3193"><a href="#cb83-3193" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3194"><a href="#cb83-3194" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3195"><a href="#cb83-3195" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3196"><a href="#cb83-3196" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3197"><a href="#cb83-3197" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3198"><a href="#cb83-3198" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3199"><a href="#cb83-3199" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3200"><a href="#cb83-3200" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3201"><a href="#cb83-3201" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3202"><a href="#cb83-3202" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3203"><a href="#cb83-3203" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3204"><a href="#cb83-3204" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3205"><a href="#cb83-3205" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3206"><a href="#cb83-3206" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3207"><a href="#cb83-3207" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3208"><a href="#cb83-3208" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3209"><a href="#cb83-3209" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3210"><a href="#cb83-3210" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3211"><a href="#cb83-3211" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3212"><a href="#cb83-3212" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3213"><a href="#cb83-3213" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3214"><a href="#cb83-3214" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3215"><a href="#cb83-3215" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3216"><a href="#cb83-3216" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3217"><a href="#cb83-3217" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3218"><a href="#cb83-3218" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3219"><a href="#cb83-3219" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3220"><a href="#cb83-3220" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3221"><a href="#cb83-3221" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3222"><a href="#cb83-3222" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3223"><a href="#cb83-3223" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3224"><a href="#cb83-3224" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3225"><a href="#cb83-3225" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3226"><a href="#cb83-3226" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3227"><a href="#cb83-3227" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3228"><a href="#cb83-3228" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3229"><a href="#cb83-3229" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3230"><a href="#cb83-3230" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3231"><a href="#cb83-3231" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3232"><a href="#cb83-3232" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3233"><a href="#cb83-3233" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3234"><a href="#cb83-3234" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3235"><a href="#cb83-3235" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3236"><a href="#cb83-3236" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3237"><a href="#cb83-3237" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3238"><a href="#cb83-3238" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3239"><a href="#cb83-3239" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3240"><a href="#cb83-3240" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3241"><a href="#cb83-3241" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3242"><a href="#cb83-3242" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3243"><a href="#cb83-3243" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-3244"><a href="#cb83-3244" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-3245"><a href="#cb83-3245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3246"><a href="#cb83-3246" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_large_largeh <span class="ot">&lt;-</span> all_effs_sex_ix_large_largeh <span class="sc">%&gt;%</span></span>
<span id="cb83-3247"><a href="#cb83-3247" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-3248"><a href="#cb83-3248" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, ix_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb83-3249"><a href="#cb83-3249" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb83-3250"><a href="#cb83-3250" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-3251"><a href="#cb83-3251" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-3252"><a href="#cb83-3252" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>))</span>
<span id="cb83-3253"><a href="#cb83-3253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3254"><a href="#cb83-3254" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_large_largeh <span class="sc">%&gt;%</span></span>
<span id="cb83-3255"><a href="#cb83-3255" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-3256"><a href="#cb83-3256" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-3257"><a href="#cb83-3257" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-3258"><a href="#cb83-3258" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb83-3259"><a href="#cb83-3259" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-3260"><a href="#cb83-3260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3261"><a href="#cb83-3261" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-3262"><a href="#cb83-3262" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb83-3263"><a href="#cb83-3263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3264"><a href="#cb83-3264" aria-hidden="true" tabindex="-1"></a>Power consequences of heteroscedasticities with varying (direction-only) interaction. Power anomalies indicate pretty low inferential abilities of such models at low sample sizes.</span>
<span id="cb83-3265"><a href="#cb83-3265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3268"><a href="#cb83-3268" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-3269"><a href="#cb83-3269" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb83-3270"><a href="#cb83-3270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3271"><a href="#cb83-3271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3272"><a href="#cb83-3272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3273"><a href="#cb83-3273" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="ot">&lt;-</span> <span class="fu">rbind</span>(calc_power_sex_ix_small,</span>
<span id="cb83-3274"><a href="#cb83-3274" aria-hidden="true" tabindex="-1"></a>                               calc_power_sex_ix_large,</span>
<span id="cb83-3275"><a href="#cb83-3275" aria-hidden="true" tabindex="-1"></a>                               calc_power_sex_ix_small_lowh,</span>
<span id="cb83-3276"><a href="#cb83-3276" aria-hidden="true" tabindex="-1"></a>                               calc_power_sex_ix_large_lowh,</span>
<span id="cb83-3277"><a href="#cb83-3277" aria-hidden="true" tabindex="-1"></a>                               calc_power_sex_ix_small_largeh,</span>
<span id="cb83-3278"><a href="#cb83-3278" aria-hidden="true" tabindex="-1"></a>                               calc_power_sex_ix_large_largeh)</span>
<span id="cb83-3279"><a href="#cb83-3279" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">lapply</span>(all_sex_effs_sex_only, unlist))</span>
<span id="cb83-3280"><a href="#cb83-3280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3281"><a href="#cb83-3281" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="sc">%&gt;%</span></span>
<span id="cb83-3282"><a href="#cb83-3282" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Effect <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Treatment"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-3283"><a href="#cb83-3283" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">factor</span>(ix_eff_size,</span>
<span id="cb83-3284"><a href="#cb83-3284" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"small"</span>, <span class="st">"large"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb83-3285"><a href="#cb83-3285" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">recode</span>(method,</span>
<span id="cb83-3286"><a href="#cb83-3286" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"ANOVA"</span> <span class="ot">=</span> <span class="st">"Factorial"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-3287"><a href="#cb83-3287" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">factor</span>(heterosc,</span>
<span id="cb83-3288"><a href="#cb83-3288" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"large"</span>, <span class="st">"low"</span>, <span class="st">"none"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb83-3289"><a href="#cb83-3289" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> ix_eff_size,</span>
<span id="cb83-3290"><a href="#cb83-3290" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> <span class="fu">interaction</span>(ix_eff_size, heterosc))) <span class="sc">+</span></span>
<span id="cb83-3291"><a href="#cb83-3291" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-3292"><a href="#cb83-3292" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> heterosc)) <span class="sc">+</span></span>
<span id="cb83-3293"><a href="#cb83-3293" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb83-3294"><a href="#cb83-3294" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Statistical power"</span>) <span class="sc">+</span></span>
<span id="cb83-3295"><a href="#cb83-3295" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Main treatment effect"</span>) <span class="sc">+</span></span>
<span id="cb83-3296"><a href="#cb83-3296" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">name =</span> <span class="st">"Ix effect size"</span>, <span class="at">values =</span> cbb_palette) <span class="sc">+</span></span>
<span id="cb83-3297"><a href="#cb83-3297" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_discrete</span>(<span class="at">name =</span> <span class="st">"Heteroscedasticity"</span>)  <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-3298"><a href="#cb83-3298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3299"><a href="#cb83-3299" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="sc">%&gt;%</span></span>
<span id="cb83-3300"><a href="#cb83-3300" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ix_eff_size <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-3301"><a href="#cb83-3301" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sex_eff_size = factor(sex_eff_size,</span></span>
<span id="cb83-3302"><a href="#cb83-3302" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("none", "small", "large"))) %&gt;%</span></span>
<span id="cb83-3303"><a href="#cb83-3303" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">factor</span>(heterosc,</span>
<span id="cb83-3304"><a href="#cb83-3304" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"large"</span>, <span class="st">"low"</span>, <span class="st">"none"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb83-3305"><a href="#cb83-3305" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-3306"><a href="#cb83-3306" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-3307"><a href="#cb83-3307" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> heterosc)) <span class="sc">+</span></span>
<span id="cb83-3308"><a href="#cb83-3308" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb83-3309"><a href="#cb83-3309" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Statistical power"</span>) <span class="sc">+</span></span>
<span id="cb83-3310"><a href="#cb83-3310" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Main treatment effect"</span>) <span class="sc">+</span></span>
<span id="cb83-3311"><a href="#cb83-3311" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">name =</span> <span class="st">"Effect"</span>, <span class="at">values =</span> cbb_palette) <span class="sc">+</span></span>
<span id="cb83-3312"><a href="#cb83-3312" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_discrete</span>(<span class="at">name =</span> <span class="st">"Heteroscedasticity"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-3313"><a href="#cb83-3313" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-3314"><a href="#cb83-3314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3315"><a href="#cb83-3315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3316"><a href="#cb83-3316" aria-hidden="true" tabindex="-1"></a><span class="fu"># Impact of sample size on power</span></span>
<span id="cb83-3317"><a href="#cb83-3317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3318"><a href="#cb83-3318" aria-hidden="true" tabindex="-1"></a><span class="fu">## Large sex eff, no ix</span></span>
<span id="cb83-3319"><a href="#cb83-3319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3320"><a href="#cb83-3320" aria-hidden="true" tabindex="-1"></a>Below simulation code generates power estimates for the following sample size scenarios: 5M+5F in each treatment group (original scenario, totql sample 20 individuals), 10M+10F (N = 40), 50M+50F (N = 200).</span>
<span id="cb83-3321"><a href="#cb83-3321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3322"><a href="#cb83-3322" aria-hidden="true" tabindex="-1"></a>First - low heteroscedasticity:</span>
<span id="cb83-3323"><a href="#cb83-3323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3324"><a href="#cb83-3324" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb83-3325"><a href="#cb83-3325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3326"><a href="#cb83-3326" aria-hidden="true" tabindex="-1"></a><span class="fu">## 5M+5F</span></span>
<span id="cb83-3329"><a href="#cb83-3329" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-3330"><a href="#cb83-3330" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb83-3331"><a href="#cb83-3331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3332"><a href="#cb83-3332" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-3333"><a href="#cb83-3333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3334"><a href="#cb83-3334" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb83-3335"><a href="#cb83-3335" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-3336"><a href="#cb83-3336" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-3337"><a href="#cb83-3337" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-3338"><a href="#cb83-3338" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-3339"><a href="#cb83-3339" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-3340"><a href="#cb83-3340" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-3341"><a href="#cb83-3341" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb83-3342"><a href="#cb83-3342" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb83-3343"><a href="#cb83-3343" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-3344"><a href="#cb83-3344" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb83-3345"><a href="#cb83-3345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3346"><a href="#cb83-3346" aria-hidden="true" tabindex="-1"></a>all_effs_sex_large_lowh_5 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-3347"><a href="#cb83-3347" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3348"><a href="#cb83-3348" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3349"><a href="#cb83-3349" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3350"><a href="#cb83-3350" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3351"><a href="#cb83-3351" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3352"><a href="#cb83-3352" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3353"><a href="#cb83-3353" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3354"><a href="#cb83-3354" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3355"><a href="#cb83-3355" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3356"><a href="#cb83-3356" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3357"><a href="#cb83-3357" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3358"><a href="#cb83-3358" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3359"><a href="#cb83-3359" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3360"><a href="#cb83-3360" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3361"><a href="#cb83-3361" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3362"><a href="#cb83-3362" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3363"><a href="#cb83-3363" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3364"><a href="#cb83-3364" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3365"><a href="#cb83-3365" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3366"><a href="#cb83-3366" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3367"><a href="#cb83-3367" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3368"><a href="#cb83-3368" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3369"><a href="#cb83-3369" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3370"><a href="#cb83-3370" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3371"><a href="#cb83-3371" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3372"><a href="#cb83-3372" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3373"><a href="#cb83-3373" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3374"><a href="#cb83-3374" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3375"><a href="#cb83-3375" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3376"><a href="#cb83-3376" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3377"><a href="#cb83-3377" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3378"><a href="#cb83-3378" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3379"><a href="#cb83-3379" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3380"><a href="#cb83-3380" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3381"><a href="#cb83-3381" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3382"><a href="#cb83-3382" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3383"><a href="#cb83-3383" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3384"><a href="#cb83-3384" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3385"><a href="#cb83-3385" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3386"><a href="#cb83-3386" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3387"><a href="#cb83-3387" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3388"><a href="#cb83-3388" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3389"><a href="#cb83-3389" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3390"><a href="#cb83-3390" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3391"><a href="#cb83-3391" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3392"><a href="#cb83-3392" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3393"><a href="#cb83-3393" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3394"><a href="#cb83-3394" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3395"><a href="#cb83-3395" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3396"><a href="#cb83-3396" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3397"><a href="#cb83-3397" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3398"><a href="#cb83-3398" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3399"><a href="#cb83-3399" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3400"><a href="#cb83-3400" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3401"><a href="#cb83-3401" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3402"><a href="#cb83-3402" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3403"><a href="#cb83-3403" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3404"><a href="#cb83-3404" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3405"><a href="#cb83-3405" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3406"><a href="#cb83-3406" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3407"><a href="#cb83-3407" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3408"><a href="#cb83-3408" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3409"><a href="#cb83-3409" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3410"><a href="#cb83-3410" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3411"><a href="#cb83-3411" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3412"><a href="#cb83-3412" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-3413"><a href="#cb83-3413" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-3414"><a href="#cb83-3414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3415"><a href="#cb83-3415" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large_lowh_5 <span class="ot">&lt;-</span> all_effs_sex_large_lowh_5 <span class="sc">%&gt;%</span></span>
<span id="cb83-3416"><a href="#cb83-3416" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-3417"><a href="#cb83-3417" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb83-3418"><a href="#cb83-3418" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb83-3419"><a href="#cb83-3419" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-3420"><a href="#cb83-3420" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"none"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-3421"><a href="#cb83-3421" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sample_size =</span> <span class="fu">rep</span>(<span class="st">"5M+5F"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-3422"><a href="#cb83-3422" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"low"</span>))</span>
<span id="cb83-3423"><a href="#cb83-3423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3424"><a href="#cb83-3424" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large_lowh_5 <span class="sc">%&gt;%</span></span>
<span id="cb83-3425"><a href="#cb83-3425" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-3426"><a href="#cb83-3426" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-3427"><a href="#cb83-3427" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-3428"><a href="#cb83-3428" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb83-3429"><a href="#cb83-3429" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-3430"><a href="#cb83-3430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3431"><a href="#cb83-3431" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-3432"><a href="#cb83-3432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3433"><a href="#cb83-3433" aria-hidden="true" tabindex="-1"></a><span class="fu">## 10M+10F</span></span>
<span id="cb83-3436"><a href="#cb83-3436" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-3437"><a href="#cb83-3437" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb83-3438"><a href="#cb83-3438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3439"><a href="#cb83-3439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3440"><a href="#cb83-3440" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb83-3441"><a href="#cb83-3441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3442"><a href="#cb83-3442" aria-hidden="true" tabindex="-1"></a>all_effs_sex_large_lowh_10 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-3443"><a href="#cb83-3443" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3444"><a href="#cb83-3444" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3445"><a href="#cb83-3445" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3446"><a href="#cb83-3446" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3447"><a href="#cb83-3447" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3448"><a href="#cb83-3448" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3449"><a href="#cb83-3449" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3450"><a href="#cb83-3450" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3451"><a href="#cb83-3451" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3452"><a href="#cb83-3452" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3453"><a href="#cb83-3453" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3454"><a href="#cb83-3454" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3455"><a href="#cb83-3455" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3456"><a href="#cb83-3456" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3457"><a href="#cb83-3457" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3458"><a href="#cb83-3458" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3459"><a href="#cb83-3459" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3460"><a href="#cb83-3460" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3461"><a href="#cb83-3461" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3462"><a href="#cb83-3462" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3463"><a href="#cb83-3463" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3464"><a href="#cb83-3464" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3465"><a href="#cb83-3465" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3466"><a href="#cb83-3466" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3467"><a href="#cb83-3467" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3468"><a href="#cb83-3468" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3469"><a href="#cb83-3469" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3470"><a href="#cb83-3470" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3471"><a href="#cb83-3471" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3472"><a href="#cb83-3472" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3473"><a href="#cb83-3473" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3474"><a href="#cb83-3474" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3475"><a href="#cb83-3475" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3476"><a href="#cb83-3476" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3477"><a href="#cb83-3477" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3478"><a href="#cb83-3478" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3479"><a href="#cb83-3479" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3480"><a href="#cb83-3480" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3481"><a href="#cb83-3481" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3482"><a href="#cb83-3482" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3483"><a href="#cb83-3483" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3484"><a href="#cb83-3484" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3485"><a href="#cb83-3485" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3486"><a href="#cb83-3486" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3487"><a href="#cb83-3487" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3488"><a href="#cb83-3488" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3489"><a href="#cb83-3489" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3490"><a href="#cb83-3490" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3491"><a href="#cb83-3491" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3492"><a href="#cb83-3492" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3493"><a href="#cb83-3493" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3494"><a href="#cb83-3494" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3495"><a href="#cb83-3495" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3496"><a href="#cb83-3496" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3497"><a href="#cb83-3497" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3498"><a href="#cb83-3498" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3499"><a href="#cb83-3499" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3500"><a href="#cb83-3500" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3501"><a href="#cb83-3501" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3502"><a href="#cb83-3502" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3503"><a href="#cb83-3503" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3504"><a href="#cb83-3504" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3505"><a href="#cb83-3505" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3506"><a href="#cb83-3506" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3507"><a href="#cb83-3507" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3508"><a href="#cb83-3508" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-3509"><a href="#cb83-3509" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-3510"><a href="#cb83-3510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3511"><a href="#cb83-3511" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large_lowh_10 <span class="ot">&lt;-</span> all_effs_sex_large_lowh_10 <span class="sc">%&gt;%</span></span>
<span id="cb83-3512"><a href="#cb83-3512" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-3513"><a href="#cb83-3513" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb83-3514"><a href="#cb83-3514" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb83-3515"><a href="#cb83-3515" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-3516"><a href="#cb83-3516" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"none"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-3517"><a href="#cb83-3517" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sample_size =</span> <span class="fu">rep</span>(<span class="st">"10M+10F"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-3518"><a href="#cb83-3518" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"low"</span>))</span>
<span id="cb83-3519"><a href="#cb83-3519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3520"><a href="#cb83-3520" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large_lowh_10 <span class="sc">%&gt;%</span></span>
<span id="cb83-3521"><a href="#cb83-3521" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-3522"><a href="#cb83-3522" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-3523"><a href="#cb83-3523" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-3524"><a href="#cb83-3524" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb83-3525"><a href="#cb83-3525" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-3526"><a href="#cb83-3526" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-3527"><a href="#cb83-3527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3528"><a href="#cb83-3528" aria-hidden="true" tabindex="-1"></a><span class="fu">## 50M+50F</span></span>
<span id="cb83-3531"><a href="#cb83-3531" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-3532"><a href="#cb83-3532" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb83-3533"><a href="#cb83-3533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3534"><a href="#cb83-3534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3535"><a href="#cb83-3535" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb83-3536"><a href="#cb83-3536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3537"><a href="#cb83-3537" aria-hidden="true" tabindex="-1"></a>all_effs_sex_large_lowh_50 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-3538"><a href="#cb83-3538" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3539"><a href="#cb83-3539" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3540"><a href="#cb83-3540" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3541"><a href="#cb83-3541" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3542"><a href="#cb83-3542" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3543"><a href="#cb83-3543" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3544"><a href="#cb83-3544" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3545"><a href="#cb83-3545" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3546"><a href="#cb83-3546" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3547"><a href="#cb83-3547" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3548"><a href="#cb83-3548" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3549"><a href="#cb83-3549" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3550"><a href="#cb83-3550" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3551"><a href="#cb83-3551" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3552"><a href="#cb83-3552" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3553"><a href="#cb83-3553" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3554"><a href="#cb83-3554" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3555"><a href="#cb83-3555" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3556"><a href="#cb83-3556" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3557"><a href="#cb83-3557" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3558"><a href="#cb83-3558" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3559"><a href="#cb83-3559" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3560"><a href="#cb83-3560" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3561"><a href="#cb83-3561" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3562"><a href="#cb83-3562" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3563"><a href="#cb83-3563" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3564"><a href="#cb83-3564" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3565"><a href="#cb83-3565" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3566"><a href="#cb83-3566" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3567"><a href="#cb83-3567" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3568"><a href="#cb83-3568" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3569"><a href="#cb83-3569" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3570"><a href="#cb83-3570" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3571"><a href="#cb83-3571" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3572"><a href="#cb83-3572" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3573"><a href="#cb83-3573" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3574"><a href="#cb83-3574" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3575"><a href="#cb83-3575" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3576"><a href="#cb83-3576" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3577"><a href="#cb83-3577" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3578"><a href="#cb83-3578" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3579"><a href="#cb83-3579" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3580"><a href="#cb83-3580" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3581"><a href="#cb83-3581" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3582"><a href="#cb83-3582" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3583"><a href="#cb83-3583" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3584"><a href="#cb83-3584" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3585"><a href="#cb83-3585" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3586"><a href="#cb83-3586" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3587"><a href="#cb83-3587" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3588"><a href="#cb83-3588" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3589"><a href="#cb83-3589" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3590"><a href="#cb83-3590" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3591"><a href="#cb83-3591" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3592"><a href="#cb83-3592" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3593"><a href="#cb83-3593" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3594"><a href="#cb83-3594" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3595"><a href="#cb83-3595" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3596"><a href="#cb83-3596" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3597"><a href="#cb83-3597" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3598"><a href="#cb83-3598" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3599"><a href="#cb83-3599" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3600"><a href="#cb83-3600" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3601"><a href="#cb83-3601" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3602"><a href="#cb83-3602" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3603"><a href="#cb83-3603" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-3604"><a href="#cb83-3604" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-3605"><a href="#cb83-3605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3606"><a href="#cb83-3606" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large_lowh_50 <span class="ot">&lt;-</span> all_effs_sex_large_lowh_50 <span class="sc">%&gt;%</span></span>
<span id="cb83-3607"><a href="#cb83-3607" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-3608"><a href="#cb83-3608" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb83-3609"><a href="#cb83-3609" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb83-3610"><a href="#cb83-3610" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-3611"><a href="#cb83-3611" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"none"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-3612"><a href="#cb83-3612" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sample_size =</span> <span class="fu">rep</span>(<span class="st">"50M+50F"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-3613"><a href="#cb83-3613" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"low"</span>))</span>
<span id="cb83-3614"><a href="#cb83-3614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3615"><a href="#cb83-3615" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large_lowh_50 <span class="sc">%&gt;%</span></span>
<span id="cb83-3616"><a href="#cb83-3616" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-3617"><a href="#cb83-3617" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-3618"><a href="#cb83-3618" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-3619"><a href="#cb83-3619" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb83-3620"><a href="#cb83-3620" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-3621"><a href="#cb83-3621" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-3622"><a href="#cb83-3622" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb83-3623"><a href="#cb83-3623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3624"><a href="#cb83-3624" aria-hidden="true" tabindex="-1"></a>Large heteroscedasticity:</span>
<span id="cb83-3625"><a href="#cb83-3625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3626"><a href="#cb83-3626" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb83-3627"><a href="#cb83-3627" aria-hidden="true" tabindex="-1"></a><span class="fu">## 5M+5F</span></span>
<span id="cb83-3630"><a href="#cb83-3630" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-3631"><a href="#cb83-3631" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb83-3632"><a href="#cb83-3632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3633"><a href="#cb83-3633" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb83-3634"><a href="#cb83-3634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3635"><a href="#cb83-3635" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb83-3636"><a href="#cb83-3636" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-3637"><a href="#cb83-3637" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-3638"><a href="#cb83-3638" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-3639"><a href="#cb83-3639" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-3640"><a href="#cb83-3640" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-3641"><a href="#cb83-3641" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-3642"><a href="#cb83-3642" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb83-3643"><a href="#cb83-3643" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb83-3644"><a href="#cb83-3644" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-3645"><a href="#cb83-3645" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb83-3646"><a href="#cb83-3646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3647"><a href="#cb83-3647" aria-hidden="true" tabindex="-1"></a>all_effs_sex_large_largeh_5 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-3648"><a href="#cb83-3648" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3649"><a href="#cb83-3649" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3650"><a href="#cb83-3650" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3651"><a href="#cb83-3651" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3652"><a href="#cb83-3652" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3653"><a href="#cb83-3653" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3654"><a href="#cb83-3654" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3655"><a href="#cb83-3655" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3656"><a href="#cb83-3656" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3657"><a href="#cb83-3657" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3658"><a href="#cb83-3658" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3659"><a href="#cb83-3659" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3660"><a href="#cb83-3660" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3661"><a href="#cb83-3661" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3662"><a href="#cb83-3662" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3663"><a href="#cb83-3663" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3664"><a href="#cb83-3664" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3665"><a href="#cb83-3665" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3666"><a href="#cb83-3666" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3667"><a href="#cb83-3667" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3668"><a href="#cb83-3668" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3669"><a href="#cb83-3669" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3670"><a href="#cb83-3670" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3671"><a href="#cb83-3671" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3672"><a href="#cb83-3672" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3673"><a href="#cb83-3673" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3674"><a href="#cb83-3674" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3675"><a href="#cb83-3675" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3676"><a href="#cb83-3676" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3677"><a href="#cb83-3677" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3678"><a href="#cb83-3678" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3679"><a href="#cb83-3679" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3680"><a href="#cb83-3680" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3681"><a href="#cb83-3681" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3682"><a href="#cb83-3682" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3683"><a href="#cb83-3683" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3684"><a href="#cb83-3684" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3685"><a href="#cb83-3685" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3686"><a href="#cb83-3686" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3687"><a href="#cb83-3687" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3688"><a href="#cb83-3688" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3689"><a href="#cb83-3689" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3690"><a href="#cb83-3690" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3691"><a href="#cb83-3691" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3692"><a href="#cb83-3692" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3693"><a href="#cb83-3693" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3694"><a href="#cb83-3694" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3695"><a href="#cb83-3695" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3696"><a href="#cb83-3696" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3697"><a href="#cb83-3697" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3698"><a href="#cb83-3698" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3699"><a href="#cb83-3699" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3700"><a href="#cb83-3700" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3701"><a href="#cb83-3701" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3702"><a href="#cb83-3702" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3703"><a href="#cb83-3703" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3704"><a href="#cb83-3704" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3705"><a href="#cb83-3705" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3706"><a href="#cb83-3706" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3707"><a href="#cb83-3707" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3708"><a href="#cb83-3708" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3709"><a href="#cb83-3709" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3710"><a href="#cb83-3710" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3711"><a href="#cb83-3711" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3712"><a href="#cb83-3712" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3713"><a href="#cb83-3713" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-3714"><a href="#cb83-3714" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-3715"><a href="#cb83-3715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3716"><a href="#cb83-3716" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large_largeh_5 <span class="ot">&lt;-</span> all_effs_sex_large_largeh_5 <span class="sc">%&gt;%</span></span>
<span id="cb83-3717"><a href="#cb83-3717" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-3718"><a href="#cb83-3718" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb83-3719"><a href="#cb83-3719" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb83-3720"><a href="#cb83-3720" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-3721"><a href="#cb83-3721" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"none"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-3722"><a href="#cb83-3722" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sample_size =</span> <span class="fu">rep</span>(<span class="st">"5M+5F"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-3723"><a href="#cb83-3723" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"large"</span>))</span>
<span id="cb83-3724"><a href="#cb83-3724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3725"><a href="#cb83-3725" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large_largeh_5 <span class="sc">%&gt;%</span></span>
<span id="cb83-3726"><a href="#cb83-3726" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-3727"><a href="#cb83-3727" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-3728"><a href="#cb83-3728" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-3729"><a href="#cb83-3729" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb83-3730"><a href="#cb83-3730" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-3731"><a href="#cb83-3731" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-3732"><a href="#cb83-3732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3733"><a href="#cb83-3733" aria-hidden="true" tabindex="-1"></a><span class="fu">## 10M+10F</span></span>
<span id="cb83-3736"><a href="#cb83-3736" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-3737"><a href="#cb83-3737" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb83-3738"><a href="#cb83-3738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3739"><a href="#cb83-3739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3740"><a href="#cb83-3740" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb83-3741"><a href="#cb83-3741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3742"><a href="#cb83-3742" aria-hidden="true" tabindex="-1"></a>all_effs_sex_large_largeh_10 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-3743"><a href="#cb83-3743" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3744"><a href="#cb83-3744" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3745"><a href="#cb83-3745" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3746"><a href="#cb83-3746" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3747"><a href="#cb83-3747" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3748"><a href="#cb83-3748" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3749"><a href="#cb83-3749" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3750"><a href="#cb83-3750" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3751"><a href="#cb83-3751" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3752"><a href="#cb83-3752" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3753"><a href="#cb83-3753" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3754"><a href="#cb83-3754" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3755"><a href="#cb83-3755" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3756"><a href="#cb83-3756" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3757"><a href="#cb83-3757" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3758"><a href="#cb83-3758" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3759"><a href="#cb83-3759" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3760"><a href="#cb83-3760" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3761"><a href="#cb83-3761" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3762"><a href="#cb83-3762" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3763"><a href="#cb83-3763" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3764"><a href="#cb83-3764" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3765"><a href="#cb83-3765" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3766"><a href="#cb83-3766" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3767"><a href="#cb83-3767" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3768"><a href="#cb83-3768" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3769"><a href="#cb83-3769" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3770"><a href="#cb83-3770" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3771"><a href="#cb83-3771" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3772"><a href="#cb83-3772" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3773"><a href="#cb83-3773" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3774"><a href="#cb83-3774" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3775"><a href="#cb83-3775" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3776"><a href="#cb83-3776" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3777"><a href="#cb83-3777" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3778"><a href="#cb83-3778" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3779"><a href="#cb83-3779" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3780"><a href="#cb83-3780" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3781"><a href="#cb83-3781" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3782"><a href="#cb83-3782" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3783"><a href="#cb83-3783" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3784"><a href="#cb83-3784" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3785"><a href="#cb83-3785" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3786"><a href="#cb83-3786" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3787"><a href="#cb83-3787" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3788"><a href="#cb83-3788" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3789"><a href="#cb83-3789" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3790"><a href="#cb83-3790" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3791"><a href="#cb83-3791" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3792"><a href="#cb83-3792" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3793"><a href="#cb83-3793" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3794"><a href="#cb83-3794" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3795"><a href="#cb83-3795" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3796"><a href="#cb83-3796" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3797"><a href="#cb83-3797" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3798"><a href="#cb83-3798" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3799"><a href="#cb83-3799" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3800"><a href="#cb83-3800" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3801"><a href="#cb83-3801" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3802"><a href="#cb83-3802" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3803"><a href="#cb83-3803" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3804"><a href="#cb83-3804" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3805"><a href="#cb83-3805" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3806"><a href="#cb83-3806" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3807"><a href="#cb83-3807" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3808"><a href="#cb83-3808" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-3809"><a href="#cb83-3809" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-3810"><a href="#cb83-3810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3811"><a href="#cb83-3811" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large_largeh_10 <span class="ot">&lt;-</span> all_effs_sex_large_largeh_10 <span class="sc">%&gt;%</span></span>
<span id="cb83-3812"><a href="#cb83-3812" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-3813"><a href="#cb83-3813" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb83-3814"><a href="#cb83-3814" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb83-3815"><a href="#cb83-3815" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-3816"><a href="#cb83-3816" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"none"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-3817"><a href="#cb83-3817" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sample_size =</span> <span class="fu">rep</span>(<span class="st">"10M+10F"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-3818"><a href="#cb83-3818" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"large"</span>))</span>
<span id="cb83-3819"><a href="#cb83-3819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3820"><a href="#cb83-3820" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large_largeh_10 <span class="sc">%&gt;%</span></span>
<span id="cb83-3821"><a href="#cb83-3821" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-3822"><a href="#cb83-3822" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-3823"><a href="#cb83-3823" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-3824"><a href="#cb83-3824" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb83-3825"><a href="#cb83-3825" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-3826"><a href="#cb83-3826" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-3827"><a href="#cb83-3827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3828"><a href="#cb83-3828" aria-hidden="true" tabindex="-1"></a><span class="fu">## 50M+50F</span></span>
<span id="cb83-3831"><a href="#cb83-3831" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-3832"><a href="#cb83-3832" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb83-3833"><a href="#cb83-3833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3834"><a href="#cb83-3834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3835"><a href="#cb83-3835" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb83-3836"><a href="#cb83-3836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3837"><a href="#cb83-3837" aria-hidden="true" tabindex="-1"></a>all_effs_sex_large_largeh_50 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-3838"><a href="#cb83-3838" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3839"><a href="#cb83-3839" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3840"><a href="#cb83-3840" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3841"><a href="#cb83-3841" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3842"><a href="#cb83-3842" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3843"><a href="#cb83-3843" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3844"><a href="#cb83-3844" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3845"><a href="#cb83-3845" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3846"><a href="#cb83-3846" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3847"><a href="#cb83-3847" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3848"><a href="#cb83-3848" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3849"><a href="#cb83-3849" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3850"><a href="#cb83-3850" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3851"><a href="#cb83-3851" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3852"><a href="#cb83-3852" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3853"><a href="#cb83-3853" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3854"><a href="#cb83-3854" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3855"><a href="#cb83-3855" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3856"><a href="#cb83-3856" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3857"><a href="#cb83-3857" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3858"><a href="#cb83-3858" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3859"><a href="#cb83-3859" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3860"><a href="#cb83-3860" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3861"><a href="#cb83-3861" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3862"><a href="#cb83-3862" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3863"><a href="#cb83-3863" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3864"><a href="#cb83-3864" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3865"><a href="#cb83-3865" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3866"><a href="#cb83-3866" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3867"><a href="#cb83-3867" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3868"><a href="#cb83-3868" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3869"><a href="#cb83-3869" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3870"><a href="#cb83-3870" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3871"><a href="#cb83-3871" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3872"><a href="#cb83-3872" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3873"><a href="#cb83-3873" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3874"><a href="#cb83-3874" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3875"><a href="#cb83-3875" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3876"><a href="#cb83-3876" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3877"><a href="#cb83-3877" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3878"><a href="#cb83-3878" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3879"><a href="#cb83-3879" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3880"><a href="#cb83-3880" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3881"><a href="#cb83-3881" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3882"><a href="#cb83-3882" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3883"><a href="#cb83-3883" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3884"><a href="#cb83-3884" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3885"><a href="#cb83-3885" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3886"><a href="#cb83-3886" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3887"><a href="#cb83-3887" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3888"><a href="#cb83-3888" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3889"><a href="#cb83-3889" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3890"><a href="#cb83-3890" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3891"><a href="#cb83-3891" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3892"><a href="#cb83-3892" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3893"><a href="#cb83-3893" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3894"><a href="#cb83-3894" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3895"><a href="#cb83-3895" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3896"><a href="#cb83-3896" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3897"><a href="#cb83-3897" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3898"><a href="#cb83-3898" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3899"><a href="#cb83-3899" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3900"><a href="#cb83-3900" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3901"><a href="#cb83-3901" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3902"><a href="#cb83-3902" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3903"><a href="#cb83-3903" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-3904"><a href="#cb83-3904" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-3905"><a href="#cb83-3905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3906"><a href="#cb83-3906" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large_largeh_50 <span class="ot">&lt;-</span> all_effs_sex_large_largeh_50 <span class="sc">%&gt;%</span></span>
<span id="cb83-3907"><a href="#cb83-3907" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-3908"><a href="#cb83-3908" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb83-3909"><a href="#cb83-3909" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb83-3910"><a href="#cb83-3910" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-3911"><a href="#cb83-3911" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"none"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-3912"><a href="#cb83-3912" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sample_size =</span> <span class="fu">rep</span>(<span class="st">"50M+50F"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-3913"><a href="#cb83-3913" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"large"</span>))</span>
<span id="cb83-3914"><a href="#cb83-3914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3915"><a href="#cb83-3915" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large_largeh_50 <span class="sc">%&gt;%</span></span>
<span id="cb83-3916"><a href="#cb83-3916" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-3917"><a href="#cb83-3917" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-3918"><a href="#cb83-3918" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-3919"><a href="#cb83-3919" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb83-3920"><a href="#cb83-3920" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-3921"><a href="#cb83-3921" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-3922"><a href="#cb83-3922" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb83-3923"><a href="#cb83-3923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3924"><a href="#cb83-3924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3925"><a href="#cb83-3925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3926"><a href="#cb83-3926" aria-hidden="true" tabindex="-1"></a><span class="fu">## Large sex effect, crossed reaction norms (interaction)</span></span>
<span id="cb83-3927"><a href="#cb83-3927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3928"><a href="#cb83-3928" aria-hidden="true" tabindex="-1"></a>Identical sample size scenarios.</span>
<span id="cb83-3929"><a href="#cb83-3929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3930"><a href="#cb83-3930" aria-hidden="true" tabindex="-1"></a>First - **low heteroscedasticity**</span>
<span id="cb83-3931"><a href="#cb83-3931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3932"><a href="#cb83-3932" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb83-3933"><a href="#cb83-3933" aria-hidden="true" tabindex="-1"></a><span class="fu">## 5M+5F</span></span>
<span id="cb83-3936"><a href="#cb83-3936" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-3937"><a href="#cb83-3937" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb83-3938"><a href="#cb83-3938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3939"><a href="#cb83-3939" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-3940"><a href="#cb83-3940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3941"><a href="#cb83-3941" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb83-3942"><a href="#cb83-3942" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-3943"><a href="#cb83-3943" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-3944"><a href="#cb83-3944" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-3945"><a href="#cb83-3945" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span></span>
<span id="cb83-3946"><a href="#cb83-3946" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-3947"><a href="#cb83-3947" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-3948"><a href="#cb83-3948" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb83-3949"><a href="#cb83-3949" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb83-3950"><a href="#cb83-3950" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span></span>
<span id="cb83-3951"><a href="#cb83-3951" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb83-3952"><a href="#cb83-3952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3953"><a href="#cb83-3953" aria-hidden="true" tabindex="-1"></a>all_effs_sex_ix_large_lowh_5 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-3954"><a href="#cb83-3954" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3955"><a href="#cb83-3955" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3956"><a href="#cb83-3956" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3957"><a href="#cb83-3957" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3958"><a href="#cb83-3958" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3959"><a href="#cb83-3959" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3960"><a href="#cb83-3960" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3961"><a href="#cb83-3961" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3962"><a href="#cb83-3962" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3963"><a href="#cb83-3963" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3964"><a href="#cb83-3964" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3965"><a href="#cb83-3965" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3966"><a href="#cb83-3966" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3967"><a href="#cb83-3967" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3968"><a href="#cb83-3968" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3969"><a href="#cb83-3969" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3970"><a href="#cb83-3970" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3971"><a href="#cb83-3971" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3972"><a href="#cb83-3972" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3973"><a href="#cb83-3973" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3974"><a href="#cb83-3974" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3975"><a href="#cb83-3975" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3976"><a href="#cb83-3976" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3977"><a href="#cb83-3977" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3978"><a href="#cb83-3978" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3979"><a href="#cb83-3979" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3980"><a href="#cb83-3980" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3981"><a href="#cb83-3981" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3982"><a href="#cb83-3982" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3983"><a href="#cb83-3983" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3984"><a href="#cb83-3984" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3985"><a href="#cb83-3985" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3986"><a href="#cb83-3986" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3987"><a href="#cb83-3987" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3988"><a href="#cb83-3988" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3989"><a href="#cb83-3989" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3990"><a href="#cb83-3990" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3991"><a href="#cb83-3991" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3992"><a href="#cb83-3992" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3993"><a href="#cb83-3993" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-3994"><a href="#cb83-3994" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-3995"><a href="#cb83-3995" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-3996"><a href="#cb83-3996" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-3997"><a href="#cb83-3997" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-3998"><a href="#cb83-3998" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-3999"><a href="#cb83-3999" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4000"><a href="#cb83-4000" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4001"><a href="#cb83-4001" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4002"><a href="#cb83-4002" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4003"><a href="#cb83-4003" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4004"><a href="#cb83-4004" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4005"><a href="#cb83-4005" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4006"><a href="#cb83-4006" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4007"><a href="#cb83-4007" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4008"><a href="#cb83-4008" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4009"><a href="#cb83-4009" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4010"><a href="#cb83-4010" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4011"><a href="#cb83-4011" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4012"><a href="#cb83-4012" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4013"><a href="#cb83-4013" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4014"><a href="#cb83-4014" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4015"><a href="#cb83-4015" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4016"><a href="#cb83-4016" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4017"><a href="#cb83-4017" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4018"><a href="#cb83-4018" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4019"><a href="#cb83-4019" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-4020"><a href="#cb83-4020" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-4021"><a href="#cb83-4021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4022"><a href="#cb83-4022" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_large_lowh_5 <span class="ot">&lt;-</span> all_effs_sex_ix_large_lowh_5 <span class="sc">%&gt;%</span></span>
<span id="cb83-4023"><a href="#cb83-4023" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-4024"><a href="#cb83-4024" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb83-4025"><a href="#cb83-4025" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb83-4026"><a href="#cb83-4026" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-4027"><a href="#cb83-4027" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-4028"><a href="#cb83-4028" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sample_size =</span> <span class="fu">rep</span>(<span class="st">"5M+5F"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-4029"><a href="#cb83-4029" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"low"</span>))</span>
<span id="cb83-4030"><a href="#cb83-4030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4031"><a href="#cb83-4031" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_large_lowh_5 <span class="sc">%&gt;%</span></span>
<span id="cb83-4032"><a href="#cb83-4032" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-4033"><a href="#cb83-4033" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-4034"><a href="#cb83-4034" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-4035"><a href="#cb83-4035" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb83-4036"><a href="#cb83-4036" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-4037"><a href="#cb83-4037" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-4038"><a href="#cb83-4038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4039"><a href="#cb83-4039" aria-hidden="true" tabindex="-1"></a><span class="fu">## 10M+10F</span></span>
<span id="cb83-4042"><a href="#cb83-4042" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-4043"><a href="#cb83-4043" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb83-4044"><a href="#cb83-4044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4045"><a href="#cb83-4045" aria-hidden="true" tabindex="-1"></a>all_effs_sex_ix_large_lowh_10 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-4046"><a href="#cb83-4046" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4047"><a href="#cb83-4047" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4048"><a href="#cb83-4048" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4049"><a href="#cb83-4049" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4050"><a href="#cb83-4050" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4051"><a href="#cb83-4051" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4052"><a href="#cb83-4052" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4053"><a href="#cb83-4053" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4054"><a href="#cb83-4054" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4055"><a href="#cb83-4055" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4056"><a href="#cb83-4056" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4057"><a href="#cb83-4057" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4058"><a href="#cb83-4058" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4059"><a href="#cb83-4059" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4060"><a href="#cb83-4060" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4061"><a href="#cb83-4061" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4062"><a href="#cb83-4062" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4063"><a href="#cb83-4063" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4064"><a href="#cb83-4064" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4065"><a href="#cb83-4065" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4066"><a href="#cb83-4066" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4067"><a href="#cb83-4067" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4068"><a href="#cb83-4068" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4069"><a href="#cb83-4069" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4070"><a href="#cb83-4070" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4071"><a href="#cb83-4071" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4072"><a href="#cb83-4072" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4073"><a href="#cb83-4073" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4074"><a href="#cb83-4074" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4075"><a href="#cb83-4075" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4076"><a href="#cb83-4076" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4077"><a href="#cb83-4077" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4078"><a href="#cb83-4078" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4079"><a href="#cb83-4079" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4080"><a href="#cb83-4080" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4081"><a href="#cb83-4081" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4082"><a href="#cb83-4082" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4083"><a href="#cb83-4083" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4084"><a href="#cb83-4084" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4085"><a href="#cb83-4085" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4086"><a href="#cb83-4086" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4087"><a href="#cb83-4087" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4088"><a href="#cb83-4088" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4089"><a href="#cb83-4089" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4090"><a href="#cb83-4090" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4091"><a href="#cb83-4091" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4092"><a href="#cb83-4092" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4093"><a href="#cb83-4093" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4094"><a href="#cb83-4094" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4095"><a href="#cb83-4095" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4096"><a href="#cb83-4096" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4097"><a href="#cb83-4097" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4098"><a href="#cb83-4098" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4099"><a href="#cb83-4099" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4100"><a href="#cb83-4100" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4101"><a href="#cb83-4101" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4102"><a href="#cb83-4102" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4103"><a href="#cb83-4103" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4104"><a href="#cb83-4104" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4105"><a href="#cb83-4105" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4106"><a href="#cb83-4106" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4107"><a href="#cb83-4107" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4108"><a href="#cb83-4108" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4109"><a href="#cb83-4109" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4110"><a href="#cb83-4110" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4111"><a href="#cb83-4111" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-4112"><a href="#cb83-4112" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-4113"><a href="#cb83-4113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4114"><a href="#cb83-4114" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_large_lowh_10 <span class="ot">&lt;-</span> all_effs_sex_ix_large_lowh_10 <span class="sc">%&gt;%</span></span>
<span id="cb83-4115"><a href="#cb83-4115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-4116"><a href="#cb83-4116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb83-4117"><a href="#cb83-4117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb83-4118"><a href="#cb83-4118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-4119"><a href="#cb83-4119" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-4120"><a href="#cb83-4120" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sample_size =</span> <span class="fu">rep</span>(<span class="st">"10M+10F"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-4121"><a href="#cb83-4121" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"low"</span>))</span>
<span id="cb83-4122"><a href="#cb83-4122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4123"><a href="#cb83-4123" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_large_lowh_10 <span class="sc">%&gt;%</span></span>
<span id="cb83-4124"><a href="#cb83-4124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-4125"><a href="#cb83-4125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-4126"><a href="#cb83-4126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-4127"><a href="#cb83-4127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb83-4128"><a href="#cb83-4128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-4129"><a href="#cb83-4129" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-4130"><a href="#cb83-4130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4131"><a href="#cb83-4131" aria-hidden="true" tabindex="-1"></a><span class="fu">## 50M+50F</span></span>
<span id="cb83-4134"><a href="#cb83-4134" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-4135"><a href="#cb83-4135" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb83-4136"><a href="#cb83-4136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4137"><a href="#cb83-4137" aria-hidden="true" tabindex="-1"></a>all_effs_sex_ix_large_lowh_50 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-4138"><a href="#cb83-4138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4139"><a href="#cb83-4139" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4140"><a href="#cb83-4140" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4141"><a href="#cb83-4141" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4142"><a href="#cb83-4142" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4143"><a href="#cb83-4143" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4144"><a href="#cb83-4144" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4145"><a href="#cb83-4145" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4146"><a href="#cb83-4146" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4147"><a href="#cb83-4147" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4148"><a href="#cb83-4148" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4149"><a href="#cb83-4149" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4150"><a href="#cb83-4150" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4151"><a href="#cb83-4151" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4152"><a href="#cb83-4152" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4153"><a href="#cb83-4153" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4154"><a href="#cb83-4154" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4155"><a href="#cb83-4155" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4156"><a href="#cb83-4156" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4157"><a href="#cb83-4157" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4158"><a href="#cb83-4158" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4159"><a href="#cb83-4159" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4160"><a href="#cb83-4160" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4161"><a href="#cb83-4161" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4162"><a href="#cb83-4162" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4163"><a href="#cb83-4163" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4164"><a href="#cb83-4164" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4165"><a href="#cb83-4165" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4166"><a href="#cb83-4166" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4167"><a href="#cb83-4167" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4168"><a href="#cb83-4168" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4169"><a href="#cb83-4169" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4170"><a href="#cb83-4170" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4171"><a href="#cb83-4171" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4172"><a href="#cb83-4172" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4173"><a href="#cb83-4173" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4174"><a href="#cb83-4174" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4175"><a href="#cb83-4175" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4176"><a href="#cb83-4176" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4177"><a href="#cb83-4177" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4178"><a href="#cb83-4178" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4179"><a href="#cb83-4179" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4180"><a href="#cb83-4180" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4181"><a href="#cb83-4181" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4182"><a href="#cb83-4182" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4183"><a href="#cb83-4183" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4184"><a href="#cb83-4184" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4185"><a href="#cb83-4185" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4186"><a href="#cb83-4186" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4187"><a href="#cb83-4187" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4188"><a href="#cb83-4188" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4189"><a href="#cb83-4189" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4190"><a href="#cb83-4190" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4191"><a href="#cb83-4191" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4192"><a href="#cb83-4192" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4193"><a href="#cb83-4193" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4194"><a href="#cb83-4194" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4195"><a href="#cb83-4195" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4196"><a href="#cb83-4196" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4197"><a href="#cb83-4197" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4198"><a href="#cb83-4198" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4199"><a href="#cb83-4199" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4200"><a href="#cb83-4200" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4201"><a href="#cb83-4201" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4202"><a href="#cb83-4202" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4203"><a href="#cb83-4203" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-4204"><a href="#cb83-4204" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-4205"><a href="#cb83-4205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4206"><a href="#cb83-4206" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_large_lowh_50 <span class="ot">&lt;-</span> all_effs_sex_ix_large_lowh_50 <span class="sc">%&gt;%</span></span>
<span id="cb83-4207"><a href="#cb83-4207" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-4208"><a href="#cb83-4208" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb83-4209"><a href="#cb83-4209" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb83-4210"><a href="#cb83-4210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-4211"><a href="#cb83-4211" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-4212"><a href="#cb83-4212" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sample_size =</span> <span class="fu">rep</span>(<span class="st">"50M+50F"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-4213"><a href="#cb83-4213" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"low"</span>))</span>
<span id="cb83-4214"><a href="#cb83-4214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4215"><a href="#cb83-4215" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_large_lowh_50 <span class="sc">%&gt;%</span></span>
<span id="cb83-4216"><a href="#cb83-4216" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-4217"><a href="#cb83-4217" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-4218"><a href="#cb83-4218" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-4219"><a href="#cb83-4219" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb83-4220"><a href="#cb83-4220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-4221"><a href="#cb83-4221" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-4222"><a href="#cb83-4222" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb83-4223"><a href="#cb83-4223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4224"><a href="#cb83-4224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4225"><a href="#cb83-4225" aria-hidden="true" tabindex="-1"></a>**Large heteroscedasticity**</span>
<span id="cb83-4226"><a href="#cb83-4226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4227"><a href="#cb83-4227" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb83-4228"><a href="#cb83-4228" aria-hidden="true" tabindex="-1"></a><span class="fu">## 5M+5F</span></span>
<span id="cb83-4231"><a href="#cb83-4231" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-4232"><a href="#cb83-4232" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb83-4233"><a href="#cb83-4233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4234"><a href="#cb83-4234" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb83-4235"><a href="#cb83-4235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4236"><a href="#cb83-4236" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb83-4237"><a href="#cb83-4237" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-4238"><a href="#cb83-4238" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-4239"><a href="#cb83-4239" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-4240"><a href="#cb83-4240" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span></span>
<span id="cb83-4241"><a href="#cb83-4241" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-4242"><a href="#cb83-4242" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-4243"><a href="#cb83-4243" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb83-4244"><a href="#cb83-4244" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb83-4245"><a href="#cb83-4245" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span></span>
<span id="cb83-4246"><a href="#cb83-4246" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb83-4247"><a href="#cb83-4247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4248"><a href="#cb83-4248" aria-hidden="true" tabindex="-1"></a>all_effs_sex_ix_large_largeh_5 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-4249"><a href="#cb83-4249" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4250"><a href="#cb83-4250" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4251"><a href="#cb83-4251" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4252"><a href="#cb83-4252" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4253"><a href="#cb83-4253" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4254"><a href="#cb83-4254" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4255"><a href="#cb83-4255" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4256"><a href="#cb83-4256" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4257"><a href="#cb83-4257" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4258"><a href="#cb83-4258" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4259"><a href="#cb83-4259" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4260"><a href="#cb83-4260" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4261"><a href="#cb83-4261" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4262"><a href="#cb83-4262" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4263"><a href="#cb83-4263" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4264"><a href="#cb83-4264" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4265"><a href="#cb83-4265" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4266"><a href="#cb83-4266" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4267"><a href="#cb83-4267" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4268"><a href="#cb83-4268" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4269"><a href="#cb83-4269" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4270"><a href="#cb83-4270" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4271"><a href="#cb83-4271" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4272"><a href="#cb83-4272" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4273"><a href="#cb83-4273" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4274"><a href="#cb83-4274" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4275"><a href="#cb83-4275" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4276"><a href="#cb83-4276" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4277"><a href="#cb83-4277" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4278"><a href="#cb83-4278" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4279"><a href="#cb83-4279" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4280"><a href="#cb83-4280" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4281"><a href="#cb83-4281" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4282"><a href="#cb83-4282" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4283"><a href="#cb83-4283" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4284"><a href="#cb83-4284" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4285"><a href="#cb83-4285" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4286"><a href="#cb83-4286" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4287"><a href="#cb83-4287" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4288"><a href="#cb83-4288" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4289"><a href="#cb83-4289" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4290"><a href="#cb83-4290" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4291"><a href="#cb83-4291" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4292"><a href="#cb83-4292" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4293"><a href="#cb83-4293" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4294"><a href="#cb83-4294" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4295"><a href="#cb83-4295" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4296"><a href="#cb83-4296" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4297"><a href="#cb83-4297" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4298"><a href="#cb83-4298" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4299"><a href="#cb83-4299" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4300"><a href="#cb83-4300" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4301"><a href="#cb83-4301" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4302"><a href="#cb83-4302" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4303"><a href="#cb83-4303" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4304"><a href="#cb83-4304" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4305"><a href="#cb83-4305" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4306"><a href="#cb83-4306" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4307"><a href="#cb83-4307" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4308"><a href="#cb83-4308" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4309"><a href="#cb83-4309" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4310"><a href="#cb83-4310" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4311"><a href="#cb83-4311" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4312"><a href="#cb83-4312" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4313"><a href="#cb83-4313" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4314"><a href="#cb83-4314" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-4315"><a href="#cb83-4315" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-4316"><a href="#cb83-4316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4317"><a href="#cb83-4317" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_large_largeh_5 <span class="ot">&lt;-</span> all_effs_sex_ix_large_largeh_5 <span class="sc">%&gt;%</span></span>
<span id="cb83-4318"><a href="#cb83-4318" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-4319"><a href="#cb83-4319" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb83-4320"><a href="#cb83-4320" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb83-4321"><a href="#cb83-4321" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-4322"><a href="#cb83-4322" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-4323"><a href="#cb83-4323" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sample_size =</span> <span class="fu">rep</span>(<span class="st">"5M+5F"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-4324"><a href="#cb83-4324" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"large"</span>))</span>
<span id="cb83-4325"><a href="#cb83-4325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4326"><a href="#cb83-4326" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_large_largeh_5 <span class="sc">%&gt;%</span></span>
<span id="cb83-4327"><a href="#cb83-4327" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-4328"><a href="#cb83-4328" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-4329"><a href="#cb83-4329" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-4330"><a href="#cb83-4330" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb83-4331"><a href="#cb83-4331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-4332"><a href="#cb83-4332" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-4333"><a href="#cb83-4333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4334"><a href="#cb83-4334" aria-hidden="true" tabindex="-1"></a><span class="fu">## 10M+10F</span></span>
<span id="cb83-4337"><a href="#cb83-4337" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-4338"><a href="#cb83-4338" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb83-4339"><a href="#cb83-4339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4340"><a href="#cb83-4340" aria-hidden="true" tabindex="-1"></a>all_effs_sex_ix_large_largeh_10 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-4341"><a href="#cb83-4341" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4342"><a href="#cb83-4342" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4343"><a href="#cb83-4343" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4344"><a href="#cb83-4344" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4345"><a href="#cb83-4345" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4346"><a href="#cb83-4346" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4347"><a href="#cb83-4347" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4348"><a href="#cb83-4348" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4349"><a href="#cb83-4349" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4350"><a href="#cb83-4350" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4351"><a href="#cb83-4351" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4352"><a href="#cb83-4352" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4353"><a href="#cb83-4353" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4354"><a href="#cb83-4354" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4355"><a href="#cb83-4355" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4356"><a href="#cb83-4356" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4357"><a href="#cb83-4357" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4358"><a href="#cb83-4358" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4359"><a href="#cb83-4359" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4360"><a href="#cb83-4360" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4361"><a href="#cb83-4361" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4362"><a href="#cb83-4362" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4363"><a href="#cb83-4363" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4364"><a href="#cb83-4364" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4365"><a href="#cb83-4365" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4366"><a href="#cb83-4366" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4367"><a href="#cb83-4367" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4368"><a href="#cb83-4368" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4369"><a href="#cb83-4369" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4370"><a href="#cb83-4370" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4371"><a href="#cb83-4371" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4372"><a href="#cb83-4372" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4373"><a href="#cb83-4373" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4374"><a href="#cb83-4374" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4375"><a href="#cb83-4375" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4376"><a href="#cb83-4376" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4377"><a href="#cb83-4377" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4378"><a href="#cb83-4378" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4379"><a href="#cb83-4379" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4380"><a href="#cb83-4380" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4381"><a href="#cb83-4381" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4382"><a href="#cb83-4382" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4383"><a href="#cb83-4383" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4384"><a href="#cb83-4384" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4385"><a href="#cb83-4385" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4386"><a href="#cb83-4386" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4387"><a href="#cb83-4387" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4388"><a href="#cb83-4388" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4389"><a href="#cb83-4389" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4390"><a href="#cb83-4390" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4391"><a href="#cb83-4391" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4392"><a href="#cb83-4392" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4393"><a href="#cb83-4393" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4394"><a href="#cb83-4394" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4395"><a href="#cb83-4395" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4396"><a href="#cb83-4396" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4397"><a href="#cb83-4397" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4398"><a href="#cb83-4398" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4399"><a href="#cb83-4399" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4400"><a href="#cb83-4400" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4401"><a href="#cb83-4401" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4402"><a href="#cb83-4402" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4403"><a href="#cb83-4403" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4404"><a href="#cb83-4404" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4405"><a href="#cb83-4405" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4406"><a href="#cb83-4406" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-4407"><a href="#cb83-4407" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-4408"><a href="#cb83-4408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4409"><a href="#cb83-4409" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_large_largeh_10 <span class="ot">&lt;-</span> all_effs_sex_ix_large_largeh_10 <span class="sc">%&gt;%</span></span>
<span id="cb83-4410"><a href="#cb83-4410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-4411"><a href="#cb83-4411" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb83-4412"><a href="#cb83-4412" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb83-4413"><a href="#cb83-4413" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-4414"><a href="#cb83-4414" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-4415"><a href="#cb83-4415" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sample_size =</span> <span class="fu">rep</span>(<span class="st">"10M+10F"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-4416"><a href="#cb83-4416" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"large"</span>))</span>
<span id="cb83-4417"><a href="#cb83-4417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4418"><a href="#cb83-4418" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_large_largeh_10 <span class="sc">%&gt;%</span></span>
<span id="cb83-4419"><a href="#cb83-4419" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-4420"><a href="#cb83-4420" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-4421"><a href="#cb83-4421" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-4422"><a href="#cb83-4422" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb83-4423"><a href="#cb83-4423" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-4424"><a href="#cb83-4424" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-4425"><a href="#cb83-4425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4426"><a href="#cb83-4426" aria-hidden="true" tabindex="-1"></a><span class="fu">## 50M+50F</span></span>
<span id="cb83-4429"><a href="#cb83-4429" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-4430"><a href="#cb83-4430" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb83-4431"><a href="#cb83-4431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4432"><a href="#cb83-4432" aria-hidden="true" tabindex="-1"></a>all_effs_sex_ix_large_largeh_50 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-4433"><a href="#cb83-4433" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4434"><a href="#cb83-4434" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4435"><a href="#cb83-4435" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">0</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4436"><a href="#cb83-4436" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4437"><a href="#cb83-4437" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">0</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4438"><a href="#cb83-4438" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4439"><a href="#cb83-4439" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4440"><a href="#cb83-4440" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4441"><a href="#cb83-4441" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4442"><a href="#cb83-4442" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4443"><a href="#cb83-4443" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4444"><a href="#cb83-4444" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4445"><a href="#cb83-4445" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4446"><a href="#cb83-4446" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4447"><a href="#cb83-4447" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4448"><a href="#cb83-4448" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4449"><a href="#cb83-4449" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4450"><a href="#cb83-4450" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4451"><a href="#cb83-4451" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4452"><a href="#cb83-4452" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4453"><a href="#cb83-4453" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4454"><a href="#cb83-4454" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4455"><a href="#cb83-4455" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4456"><a href="#cb83-4456" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4457"><a href="#cb83-4457" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4458"><a href="#cb83-4458" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4459"><a href="#cb83-4459" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4460"><a href="#cb83-4460" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4461"><a href="#cb83-4461" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4462"><a href="#cb83-4462" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4463"><a href="#cb83-4463" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4464"><a href="#cb83-4464" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4465"><a href="#cb83-4465" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4466"><a href="#cb83-4466" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4467"><a href="#cb83-4467" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4468"><a href="#cb83-4468" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4469"><a href="#cb83-4469" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4470"><a href="#cb83-4470" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4471"><a href="#cb83-4471" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4472"><a href="#cb83-4472" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4473"><a href="#cb83-4473" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4474"><a href="#cb83-4474" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4475"><a href="#cb83-4475" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4476"><a href="#cb83-4476" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4477"><a href="#cb83-4477" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4478"><a href="#cb83-4478" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4479"><a href="#cb83-4479" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4480"><a href="#cb83-4480" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4481"><a href="#cb83-4481" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4482"><a href="#cb83-4482" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4483"><a href="#cb83-4483" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4484"><a href="#cb83-4484" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4485"><a href="#cb83-4485" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4486"><a href="#cb83-4486" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4487"><a href="#cb83-4487" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4488"><a href="#cb83-4488" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4489"><a href="#cb83-4489" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4490"><a href="#cb83-4490" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4491"><a href="#cb83-4491" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4492"><a href="#cb83-4492" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4493"><a href="#cb83-4493" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4494"><a href="#cb83-4494" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4495"><a href="#cb83-4495" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="dv">1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4496"><a href="#cb83-4496" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4497"><a href="#cb83-4497" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="dv">1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd</span>
<span id="cb83-4498"><a href="#cb83-4498" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-4499"><a href="#cb83-4499" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-4500"><a href="#cb83-4500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4501"><a href="#cb83-4501" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_large_largeh_50 <span class="ot">&lt;-</span> all_effs_sex_ix_large_largeh_50 <span class="sc">%&gt;%</span></span>
<span id="cb83-4502"><a href="#cb83-4502" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-4503"><a href="#cb83-4503" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc) <span class="sc">%&gt;%</span></span>
<span id="cb83-4504"><a href="#cb83-4504" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb83-4505"><a href="#cb83-4505" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-4506"><a href="#cb83-4506" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-4507"><a href="#cb83-4507" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sample_size =</span> <span class="fu">rep</span>(<span class="st">"50M+50F"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-4508"><a href="#cb83-4508" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"large"</span>))</span>
<span id="cb83-4509"><a href="#cb83-4509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4510"><a href="#cb83-4510" aria-hidden="true" tabindex="-1"></a>calc_power_sex_ix_large_largeh_50 <span class="sc">%&gt;%</span></span>
<span id="cb83-4511"><a href="#cb83-4511" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-4512"><a href="#cb83-4512" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-4513"><a href="#cb83-4513" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-4514"><a href="#cb83-4514" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb83-4515"><a href="#cb83-4515" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Power"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-4516"><a href="#cb83-4516" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-4517"><a href="#cb83-4517" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb83-4518"><a href="#cb83-4518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4519"><a href="#cb83-4519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4520"><a href="#cb83-4520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4521"><a href="#cb83-4521" aria-hidden="true" tabindex="-1"></a><span class="fu">## Summaries of sample size scenarios</span></span>
<span id="cb83-4522"><a href="#cb83-4522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4523"><a href="#cb83-4523" aria-hidden="true" tabindex="-1"></a>No interaction, low (left) and large (right) heteroscedasticity:</span>
<span id="cb83-4524"><a href="#cb83-4524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4527"><a href="#cb83-4527" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-4528"><a href="#cb83-4528" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb83-4529"><a href="#cb83-4529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4530"><a href="#cb83-4530" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-4531"><a href="#cb83-4531" aria-hidden="true" tabindex="-1"></a>    calc_power_sex_large_lowh_5,</span>
<span id="cb83-4532"><a href="#cb83-4532" aria-hidden="true" tabindex="-1"></a>    calc_power_sex_large_lowh_10,</span>
<span id="cb83-4533"><a href="#cb83-4533" aria-hidden="true" tabindex="-1"></a>    calc_power_sex_large_lowh_50,</span>
<span id="cb83-4534"><a href="#cb83-4534" aria-hidden="true" tabindex="-1"></a>    calc_power_sex_large_largeh_5,</span>
<span id="cb83-4535"><a href="#cb83-4535" aria-hidden="true" tabindex="-1"></a>    calc_power_sex_large_largeh_10,</span>
<span id="cb83-4536"><a href="#cb83-4536" aria-hidden="true" tabindex="-1"></a>    calc_power_sex_large_largeh_50</span>
<span id="cb83-4537"><a href="#cb83-4537" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-4538"><a href="#cb83-4538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4539"><a href="#cb83-4539" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">lapply</span>(all_sex_effs_sex_only, unlist))</span>
<span id="cb83-4540"><a href="#cb83-4540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4541"><a href="#cb83-4541" aria-hidden="true" tabindex="-1"></a><span class="co"># plot1 &lt;- all_sex_effs_sex_only %&gt;%</span></span>
<span id="cb83-4542"><a href="#cb83-4542" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(Effect %in% c("Treatment")) %&gt;%</span></span>
<span id="cb83-4543"><a href="#cb83-4543" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(heterosc %in% c("low")) %&gt;%</span></span>
<span id="cb83-4544"><a href="#cb83-4544" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sample_size = factor(sample_size,</span></span>
<span id="cb83-4545"><a href="#cb83-4545" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("5M+5F", "10M+10F", "50M+50F"))) %&gt;%</span></span>
<span id="cb83-4546"><a href="#cb83-4546" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(method = recode(method,</span></span>
<span id="cb83-4547"><a href="#cb83-4547" aria-hidden="true" tabindex="-1"></a><span class="co">#                          "ANOVA" = "Factorial")) %&gt;%</span></span>
<span id="cb83-4548"><a href="#cb83-4548" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x = treat_es2, y = p_value, colour = sample_size)) +</span></span>
<span id="cb83-4549"><a href="#cb83-4549" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_hline(yintercept = 0.8, linetype = 1, colour = "red") +</span></span>
<span id="cb83-4550"><a href="#cb83-4550" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_line() +</span></span>
<span id="cb83-4551"><a href="#cb83-4551" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_bw() +</span></span>
<span id="cb83-4552"><a href="#cb83-4552" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylab("Statistical power") +</span></span>
<span id="cb83-4553"><a href="#cb83-4553" aria-hidden="true" tabindex="-1"></a><span class="co">#   xlab("Main treatment effect") +</span></span>
<span id="cb83-4554"><a href="#cb83-4554" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_colour_manual(name = "Sample size", values = cbb_palette) +</span></span>
<span id="cb83-4555"><a href="#cb83-4555" aria-hidden="true" tabindex="-1"></a><span class="co">#   # scale_linetype_discrete(name = "Heteroscedasticity")  +</span></span>
<span id="cb83-4556"><a href="#cb83-4556" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylim(0, 1)</span></span>
<span id="cb83-4557"><a href="#cb83-4557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4558"><a href="#cb83-4558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4559"><a href="#cb83-4559" aria-hidden="true" tabindex="-1"></a><span class="co"># plot2 &lt;- all_sex_effs_sex_only %&gt;%</span></span>
<span id="cb83-4560"><a href="#cb83-4560" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(Effect %in% c("Treatment")) %&gt;%</span></span>
<span id="cb83-4561"><a href="#cb83-4561" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(heterosc %in% c("large")) %&gt;%</span></span>
<span id="cb83-4562"><a href="#cb83-4562" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sample_size = factor(sample_size,</span></span>
<span id="cb83-4563"><a href="#cb83-4563" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("5M+5F", "10M+10F", "50M+50F"))) %&gt;%</span></span>
<span id="cb83-4564"><a href="#cb83-4564" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(method = recode(method,</span></span>
<span id="cb83-4565"><a href="#cb83-4565" aria-hidden="true" tabindex="-1"></a><span class="co">#                          "ANOVA" = "Factorial")) %&gt;%</span></span>
<span id="cb83-4566"><a href="#cb83-4566" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x = treat_es2, y = p_value, colour = sample_size)) +</span></span>
<span id="cb83-4567"><a href="#cb83-4567" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_hline(yintercept = 0.8, linetype = 1, colour = "red") +</span></span>
<span id="cb83-4568"><a href="#cb83-4568" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_line() +</span></span>
<span id="cb83-4569"><a href="#cb83-4569" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_bw() +</span></span>
<span id="cb83-4570"><a href="#cb83-4570" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylab("Statistical power") +</span></span>
<span id="cb83-4571"><a href="#cb83-4571" aria-hidden="true" tabindex="-1"></a><span class="co">#   xlab("Main treatment effect") +</span></span>
<span id="cb83-4572"><a href="#cb83-4572" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_colour_manual(name = "Sample size", values = cbb_palette) +</span></span>
<span id="cb83-4573"><a href="#cb83-4573" aria-hidden="true" tabindex="-1"></a><span class="co">#   # scale_linetype_discrete(name = "Heteroscedasticity")  +</span></span>
<span id="cb83-4574"><a href="#cb83-4574" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylim(0, 1)</span></span>
<span id="cb83-4575"><a href="#cb83-4575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4576"><a href="#cb83-4576" aria-hidden="true" tabindex="-1"></a><span class="co"># ggarrange(plot1, plot2, ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")</span></span>
<span id="cb83-4577"><a href="#cb83-4577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4578"><a href="#cb83-4578" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> all_sex_effs_sex_only <span class="sc">%&gt;%</span></span>
<span id="cb83-4579"><a href="#cb83-4579" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(heterosc <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"low"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-4580"><a href="#cb83-4580" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sample_size =</span> <span class="fu">factor</span>(sample_size,</span>
<span id="cb83-4581"><a href="#cb83-4581" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"5M+5F"</span>, <span class="st">"10M+10F"</span>, <span class="st">"50M+50F"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb83-4582"><a href="#cb83-4582" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sex_eff_size = factor(sex_eff_size,</span></span>
<span id="cb83-4583"><a href="#cb83-4583" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("none", "small", "large"))) %&gt;%</span></span>
<span id="cb83-4584"><a href="#cb83-4584" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-4585"><a href="#cb83-4585" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-4586"><a href="#cb83-4586" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> sample_size)) <span class="sc">+</span></span>
<span id="cb83-4587"><a href="#cb83-4587" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb83-4588"><a href="#cb83-4588" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Statistical power"</span>) <span class="sc">+</span></span>
<span id="cb83-4589"><a href="#cb83-4589" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Main treatment effect"</span>) <span class="sc">+</span></span>
<span id="cb83-4590"><a href="#cb83-4590" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">name =</span> <span class="st">"Effect"</span>, <span class="at">values =</span> cbb_palette) <span class="sc">+</span></span>
<span id="cb83-4591"><a href="#cb83-4591" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_discrete</span>(<span class="at">name =</span> <span class="st">"Sample size"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-4592"><a href="#cb83-4592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4593"><a href="#cb83-4593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4594"><a href="#cb83-4594" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> all_sex_effs_sex_only <span class="sc">%&gt;%</span></span>
<span id="cb83-4595"><a href="#cb83-4595" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(heterosc <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-4596"><a href="#cb83-4596" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sample_size =</span> <span class="fu">factor</span>(sample_size,</span>
<span id="cb83-4597"><a href="#cb83-4597" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"5M+5F"</span>, <span class="st">"10M+10F"</span>, <span class="st">"50M+50F"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb83-4598"><a href="#cb83-4598" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sex_eff_size = factor(sex_eff_size,</span></span>
<span id="cb83-4599"><a href="#cb83-4599" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("none", "small", "large"))) %&gt;%</span></span>
<span id="cb83-4600"><a href="#cb83-4600" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-4601"><a href="#cb83-4601" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-4602"><a href="#cb83-4602" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> sample_size)) <span class="sc">+</span></span>
<span id="cb83-4603"><a href="#cb83-4603" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb83-4604"><a href="#cb83-4604" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Statistical power"</span>) <span class="sc">+</span></span>
<span id="cb83-4605"><a href="#cb83-4605" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Main treatment effect"</span>) <span class="sc">+</span></span>
<span id="cb83-4606"><a href="#cb83-4606" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">name =</span> <span class="st">"Effect"</span>, <span class="at">values =</span> cbb_palette) <span class="sc">+</span></span>
<span id="cb83-4607"><a href="#cb83-4607" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_discrete</span>(<span class="at">name =</span> <span class="st">"Sample size"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-4608"><a href="#cb83-4608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4609"><a href="#cb83-4609" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(plot1, plot2, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">common.legend =</span> <span class="cn">TRUE</span>, <span class="at">legend =</span> <span class="st">"right"</span>)</span>
<span id="cb83-4610"><a href="#cb83-4610" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-4611"><a href="#cb83-4611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4612"><a href="#cb83-4612" aria-hidden="true" tabindex="-1"></a>Interaction of effect direction present, low (left) and high (right) heteroscedasticity:</span>
<span id="cb83-4613"><a href="#cb83-4613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4616"><a href="#cb83-4616" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-4617"><a href="#cb83-4617" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb83-4618"><a href="#cb83-4618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4619"><a href="#cb83-4619" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-4620"><a href="#cb83-4620" aria-hidden="true" tabindex="-1"></a>    calc_power_sex_ix_large_lowh_5,</span>
<span id="cb83-4621"><a href="#cb83-4621" aria-hidden="true" tabindex="-1"></a>    calc_power_sex_ix_large_lowh_10,</span>
<span id="cb83-4622"><a href="#cb83-4622" aria-hidden="true" tabindex="-1"></a>    calc_power_sex_ix_large_lowh_50,</span>
<span id="cb83-4623"><a href="#cb83-4623" aria-hidden="true" tabindex="-1"></a>    calc_power_sex_ix_large_largeh_5,</span>
<span id="cb83-4624"><a href="#cb83-4624" aria-hidden="true" tabindex="-1"></a>    calc_power_sex_ix_large_largeh_10,</span>
<span id="cb83-4625"><a href="#cb83-4625" aria-hidden="true" tabindex="-1"></a>    calc_power_sex_ix_large_largeh_50</span>
<span id="cb83-4626"><a href="#cb83-4626" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-4627"><a href="#cb83-4627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4628"><a href="#cb83-4628" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">lapply</span>(all_sex_effs_sex_only, unlist))</span>
<span id="cb83-4629"><a href="#cb83-4629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4630"><a href="#cb83-4630" aria-hidden="true" tabindex="-1"></a><span class="co"># plot1 &lt;- all_sex_effs_sex_only %&gt;%</span></span>
<span id="cb83-4631"><a href="#cb83-4631" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(Effect %in% c("Treatment")) %&gt;%</span></span>
<span id="cb83-4632"><a href="#cb83-4632" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(heterosc %in% c("low")) %&gt;%</span></span>
<span id="cb83-4633"><a href="#cb83-4633" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sample_size = factor(sample_size,</span></span>
<span id="cb83-4634"><a href="#cb83-4634" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("5M+5F", "10M+10F", "50M+50F"))) %&gt;%</span></span>
<span id="cb83-4635"><a href="#cb83-4635" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(method = recode(method,</span></span>
<span id="cb83-4636"><a href="#cb83-4636" aria-hidden="true" tabindex="-1"></a><span class="co">#                          "ANOVA" = "Factorial")) %&gt;%</span></span>
<span id="cb83-4637"><a href="#cb83-4637" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x = treat_es2, y = p_value, colour = sample_size)) +</span></span>
<span id="cb83-4638"><a href="#cb83-4638" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_hline(yintercept = 0.8, linetype = 1, colour = "red") +</span></span>
<span id="cb83-4639"><a href="#cb83-4639" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_line() +</span></span>
<span id="cb83-4640"><a href="#cb83-4640" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_bw() +</span></span>
<span id="cb83-4641"><a href="#cb83-4641" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylab("Statistical power") +</span></span>
<span id="cb83-4642"><a href="#cb83-4642" aria-hidden="true" tabindex="-1"></a><span class="co">#   xlab("Main treatment effect") +</span></span>
<span id="cb83-4643"><a href="#cb83-4643" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_colour_manual(name = "Sample size", values = cbb_palette) +</span></span>
<span id="cb83-4644"><a href="#cb83-4644" aria-hidden="true" tabindex="-1"></a><span class="co">#   # scale_linetype_discrete(name = "Heteroscedasticity")  +</span></span>
<span id="cb83-4645"><a href="#cb83-4645" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylim(0, 1)</span></span>
<span id="cb83-4646"><a href="#cb83-4646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4647"><a href="#cb83-4647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4648"><a href="#cb83-4648" aria-hidden="true" tabindex="-1"></a><span class="co"># plot2 &lt;- all_sex_effs_sex_only %&gt;%</span></span>
<span id="cb83-4649"><a href="#cb83-4649" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(Effect %in% c("Treatment")) %&gt;%</span></span>
<span id="cb83-4650"><a href="#cb83-4650" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(heterosc %in% c("large")) %&gt;%</span></span>
<span id="cb83-4651"><a href="#cb83-4651" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sample_size = factor(sample_size,</span></span>
<span id="cb83-4652"><a href="#cb83-4652" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("5M+5F", "10M+10F", "50M+50F"))) %&gt;%</span></span>
<span id="cb83-4653"><a href="#cb83-4653" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(method = recode(method,</span></span>
<span id="cb83-4654"><a href="#cb83-4654" aria-hidden="true" tabindex="-1"></a><span class="co">#                          "ANOVA" = "Factorial")) %&gt;%</span></span>
<span id="cb83-4655"><a href="#cb83-4655" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x = treat_es2, y = p_value, colour = sample_size)) +</span></span>
<span id="cb83-4656"><a href="#cb83-4656" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_hline(yintercept = 0.8, linetype = 1, colour = "red") +</span></span>
<span id="cb83-4657"><a href="#cb83-4657" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_line() +</span></span>
<span id="cb83-4658"><a href="#cb83-4658" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_bw() +</span></span>
<span id="cb83-4659"><a href="#cb83-4659" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylab("Statistical power") +</span></span>
<span id="cb83-4660"><a href="#cb83-4660" aria-hidden="true" tabindex="-1"></a><span class="co">#   xlab("Main treatment effect") +</span></span>
<span id="cb83-4661"><a href="#cb83-4661" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_colour_manual(name = "Sample size", values = cbb_palette) +</span></span>
<span id="cb83-4662"><a href="#cb83-4662" aria-hidden="true" tabindex="-1"></a><span class="co">#   # scale_linetype_discrete(name = "Heteroscedasticity")  +</span></span>
<span id="cb83-4663"><a href="#cb83-4663" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylim(0, 1)</span></span>
<span id="cb83-4664"><a href="#cb83-4664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4665"><a href="#cb83-4665" aria-hidden="true" tabindex="-1"></a><span class="co"># ggarrange(plot1, plot2, ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")</span></span>
<span id="cb83-4666"><a href="#cb83-4666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4667"><a href="#cb83-4667" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> all_sex_effs_sex_only <span class="sc">%&gt;%</span></span>
<span id="cb83-4668"><a href="#cb83-4668" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(heterosc <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"low"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-4669"><a href="#cb83-4669" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sample_size =</span> <span class="fu">factor</span>(sample_size,</span>
<span id="cb83-4670"><a href="#cb83-4670" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"5M+5F"</span>, <span class="st">"10M+10F"</span>, <span class="st">"50M+50F"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb83-4671"><a href="#cb83-4671" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sex_eff_size = factor(sex_eff_size,</span></span>
<span id="cb83-4672"><a href="#cb83-4672" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("none", "small", "large"))) %&gt;%</span></span>
<span id="cb83-4673"><a href="#cb83-4673" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-4674"><a href="#cb83-4674" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-4675"><a href="#cb83-4675" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> sample_size)) <span class="sc">+</span></span>
<span id="cb83-4676"><a href="#cb83-4676" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb83-4677"><a href="#cb83-4677" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Statistical power"</span>) <span class="sc">+</span></span>
<span id="cb83-4678"><a href="#cb83-4678" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Main treatment effect"</span>) <span class="sc">+</span></span>
<span id="cb83-4679"><a href="#cb83-4679" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">name =</span> <span class="st">"Effect"</span>, <span class="at">values =</span> cbb_palette) <span class="sc">+</span></span>
<span id="cb83-4680"><a href="#cb83-4680" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_discrete</span>(<span class="at">name =</span> <span class="st">"Sample size"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-4681"><a href="#cb83-4681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4682"><a href="#cb83-4682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4683"><a href="#cb83-4683" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> all_sex_effs_sex_only <span class="sc">%&gt;%</span></span>
<span id="cb83-4684"><a href="#cb83-4684" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(heterosc <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-4685"><a href="#cb83-4685" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sample_size =</span> <span class="fu">factor</span>(sample_size,</span>
<span id="cb83-4686"><a href="#cb83-4686" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"5M+5F"</span>, <span class="st">"10M+10F"</span>, <span class="st">"50M+50F"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb83-4687"><a href="#cb83-4687" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sex_eff_size = factor(sex_eff_size,</span></span>
<span id="cb83-4688"><a href="#cb83-4688" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("none", "small", "large"))) %&gt;%</span></span>
<span id="cb83-4689"><a href="#cb83-4689" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> p_value, <span class="at">colour =</span> Effect)) <span class="sc">+</span></span>
<span id="cb83-4690"><a href="#cb83-4690" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-4691"><a href="#cb83-4691" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> sample_size)) <span class="sc">+</span></span>
<span id="cb83-4692"><a href="#cb83-4692" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb83-4693"><a href="#cb83-4693" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Statistical power"</span>) <span class="sc">+</span></span>
<span id="cb83-4694"><a href="#cb83-4694" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Main treatment effect"</span>) <span class="sc">+</span></span>
<span id="cb83-4695"><a href="#cb83-4695" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">name =</span> <span class="st">"Effect"</span>, <span class="at">values =</span> cbb_palette) <span class="sc">+</span></span>
<span id="cb83-4696"><a href="#cb83-4696" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_discrete</span>(<span class="at">name =</span> <span class="st">"Sample size"</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb83-4697"><a href="#cb83-4697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4698"><a href="#cb83-4698" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(plot1, plot2, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">common.legend =</span> <span class="cn">TRUE</span>, <span class="at">legend =</span> <span class="st">"right"</span>)</span>
<span id="cb83-4699"><a href="#cb83-4699" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-4700"><a href="#cb83-4700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4701"><a href="#cb83-4701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4702"><a href="#cb83-4702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4703"><a href="#cb83-4703" aria-hidden="true" tabindex="-1"></a><span class="fu"># Simulating sample size</span></span>
<span id="cb83-4704"><a href="#cb83-4704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4705"><a href="#cb83-4705" aria-hidden="true" tabindex="-1"></a><span class="fu">## Simulations assuming target power = 80%</span></span>
<span id="cb83-4706"><a href="#cb83-4706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4707"><a href="#cb83-4707" aria-hidden="true" tabindex="-1"></a>Scenario 1: strong sex effect, none to large heteroscedasticity. Assumed power 80% for treatment effect.</span>
<span id="cb83-4708"><a href="#cb83-4708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4711"><a href="#cb83-4711" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-4712"><a href="#cb83-4712" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb83-4713"><a href="#cb83-4713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4714"><a href="#cb83-4714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4715"><a href="#cb83-4715" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-4716"><a href="#cb83-4716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4717"><a href="#cb83-4717" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb83-4718"><a href="#cb83-4718" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-4719"><a href="#cb83-4719" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-4720"><a href="#cb83-4720" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-4721"><a href="#cb83-4721" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-4722"><a href="#cb83-4722" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-4723"><a href="#cb83-4723" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-4724"><a href="#cb83-4724" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb83-4725"><a href="#cb83-4725" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb83-4726"><a href="#cb83-4726" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-4727"><a href="#cb83-4727" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb83-4728"><a href="#cb83-4728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4729"><a href="#cb83-4729" aria-hidden="true" tabindex="-1"></a>all_effs_sex_large_noh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-4730"><a href="#cb83-4730" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4731"><a href="#cb83-4731" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4732"><a href="#cb83-4732" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4733"><a href="#cb83-4733" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4734"><a href="#cb83-4734" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-4735"><a href="#cb83-4735" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-4736"><a href="#cb83-4736" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4737"><a href="#cb83-4737" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4738"><a href="#cb83-4738" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4739"><a href="#cb83-4739" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4740"><a href="#cb83-4740" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4741"><a href="#cb83-4741" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-4742"><a href="#cb83-4742" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-4743"><a href="#cb83-4743" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4744"><a href="#cb83-4744" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4745"><a href="#cb83-4745" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4746"><a href="#cb83-4746" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4747"><a href="#cb83-4747" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4748"><a href="#cb83-4748" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-4749"><a href="#cb83-4749" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-4750"><a href="#cb83-4750" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4751"><a href="#cb83-4751" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4752"><a href="#cb83-4752" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4753"><a href="#cb83-4753" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4754"><a href="#cb83-4754" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4755"><a href="#cb83-4755" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-4756"><a href="#cb83-4756" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-4757"><a href="#cb83-4757" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4758"><a href="#cb83-4758" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4759"><a href="#cb83-4759" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4760"><a href="#cb83-4760" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4761"><a href="#cb83-4761" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4762"><a href="#cb83-4762" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-4763"><a href="#cb83-4763" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-4764"><a href="#cb83-4764" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4765"><a href="#cb83-4765" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4766"><a href="#cb83-4766" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4767"><a href="#cb83-4767" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4768"><a href="#cb83-4768" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4769"><a href="#cb83-4769" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-4770"><a href="#cb83-4770" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-4771"><a href="#cb83-4771" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4772"><a href="#cb83-4772" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4773"><a href="#cb83-4773" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4774"><a href="#cb83-4774" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4775"><a href="#cb83-4775" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4776"><a href="#cb83-4776" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-4777"><a href="#cb83-4777" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-4778"><a href="#cb83-4778" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4779"><a href="#cb83-4779" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4780"><a href="#cb83-4780" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4781"><a href="#cb83-4781" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4782"><a href="#cb83-4782" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4783"><a href="#cb83-4783" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-4784"><a href="#cb83-4784" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-4785"><a href="#cb83-4785" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4786"><a href="#cb83-4786" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4787"><a href="#cb83-4787" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4788"><a href="#cb83-4788" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4789"><a href="#cb83-4789" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4790"><a href="#cb83-4790" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-4791"><a href="#cb83-4791" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-4792"><a href="#cb83-4792" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-4793"><a href="#cb83-4793" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-4794"><a href="#cb83-4794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4795"><a href="#cb83-4795" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large_noh <span class="ot">&lt;-</span> all_effs_sex_large_noh <span class="sc">%&gt;%</span></span>
<span id="cb83-4796"><a href="#cb83-4796" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-4797"><a href="#cb83-4797" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc, ssize, power) <span class="sc">%&gt;%</span></span>
<span id="cb83-4798"><a href="#cb83-4798" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb83-4799"><a href="#cb83-4799" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-4800"><a href="#cb83-4800" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"none"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-4801"><a href="#cb83-4801" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"none"</span>))</span>
<span id="cb83-4802"><a href="#cb83-4802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4803"><a href="#cb83-4803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4804"><a href="#cb83-4804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4805"><a href="#cb83-4805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4806"><a href="#cb83-4806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4807"><a href="#cb83-4807" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-4808"><a href="#cb83-4808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4809"><a href="#cb83-4809" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb83-4810"><a href="#cb83-4810" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-4811"><a href="#cb83-4811" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-4812"><a href="#cb83-4812" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-4813"><a href="#cb83-4813" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-4814"><a href="#cb83-4814" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-4815"><a href="#cb83-4815" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-4816"><a href="#cb83-4816" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb83-4817"><a href="#cb83-4817" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb83-4818"><a href="#cb83-4818" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-4819"><a href="#cb83-4819" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb83-4820"><a href="#cb83-4820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4821"><a href="#cb83-4821" aria-hidden="true" tabindex="-1"></a>all_effs_sex_large_lowh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-4822"><a href="#cb83-4822" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4823"><a href="#cb83-4823" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4824"><a href="#cb83-4824" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4825"><a href="#cb83-4825" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4826"><a href="#cb83-4826" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-4827"><a href="#cb83-4827" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-4828"><a href="#cb83-4828" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4829"><a href="#cb83-4829" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4830"><a href="#cb83-4830" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4831"><a href="#cb83-4831" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4832"><a href="#cb83-4832" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4833"><a href="#cb83-4833" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-4834"><a href="#cb83-4834" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-4835"><a href="#cb83-4835" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4836"><a href="#cb83-4836" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4837"><a href="#cb83-4837" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4838"><a href="#cb83-4838" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4839"><a href="#cb83-4839" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4840"><a href="#cb83-4840" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-4841"><a href="#cb83-4841" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-4842"><a href="#cb83-4842" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4843"><a href="#cb83-4843" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4844"><a href="#cb83-4844" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4845"><a href="#cb83-4845" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4846"><a href="#cb83-4846" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4847"><a href="#cb83-4847" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-4848"><a href="#cb83-4848" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-4849"><a href="#cb83-4849" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4850"><a href="#cb83-4850" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4851"><a href="#cb83-4851" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4852"><a href="#cb83-4852" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4853"><a href="#cb83-4853" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4854"><a href="#cb83-4854" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-4855"><a href="#cb83-4855" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-4856"><a href="#cb83-4856" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4857"><a href="#cb83-4857" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4858"><a href="#cb83-4858" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4859"><a href="#cb83-4859" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4860"><a href="#cb83-4860" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4861"><a href="#cb83-4861" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-4862"><a href="#cb83-4862" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-4863"><a href="#cb83-4863" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4864"><a href="#cb83-4864" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4865"><a href="#cb83-4865" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4866"><a href="#cb83-4866" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4867"><a href="#cb83-4867" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4868"><a href="#cb83-4868" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-4869"><a href="#cb83-4869" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-4870"><a href="#cb83-4870" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4871"><a href="#cb83-4871" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4872"><a href="#cb83-4872" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4873"><a href="#cb83-4873" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4874"><a href="#cb83-4874" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4875"><a href="#cb83-4875" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-4876"><a href="#cb83-4876" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-4877"><a href="#cb83-4877" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4878"><a href="#cb83-4878" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4879"><a href="#cb83-4879" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4880"><a href="#cb83-4880" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4881"><a href="#cb83-4881" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4882"><a href="#cb83-4882" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-4883"><a href="#cb83-4883" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-4884"><a href="#cb83-4884" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-4885"><a href="#cb83-4885" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-4886"><a href="#cb83-4886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4887"><a href="#cb83-4887" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large_lowh <span class="ot">&lt;-</span> all_effs_sex_large_lowh <span class="sc">%&gt;%</span></span>
<span id="cb83-4888"><a href="#cb83-4888" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-4889"><a href="#cb83-4889" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc, ssize, power) <span class="sc">%&gt;%</span></span>
<span id="cb83-4890"><a href="#cb83-4890" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb83-4891"><a href="#cb83-4891" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-4892"><a href="#cb83-4892" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"none"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-4893"><a href="#cb83-4893" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"low"</span>))</span>
<span id="cb83-4894"><a href="#cb83-4894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4895"><a href="#cb83-4895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4896"><a href="#cb83-4896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4897"><a href="#cb83-4897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4898"><a href="#cb83-4898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4899"><a href="#cb83-4899" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb83-4900"><a href="#cb83-4900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4901"><a href="#cb83-4901" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb83-4902"><a href="#cb83-4902" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-4903"><a href="#cb83-4903" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-4904"><a href="#cb83-4904" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-4905"><a href="#cb83-4905" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-4906"><a href="#cb83-4906" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-4907"><a href="#cb83-4907" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-4908"><a href="#cb83-4908" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb83-4909"><a href="#cb83-4909" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb83-4910"><a href="#cb83-4910" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-4911"><a href="#cb83-4911" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb83-4912"><a href="#cb83-4912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4913"><a href="#cb83-4913" aria-hidden="true" tabindex="-1"></a>all_effs_sex_large_largeh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-4914"><a href="#cb83-4914" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4915"><a href="#cb83-4915" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4916"><a href="#cb83-4916" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4917"><a href="#cb83-4917" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4918"><a href="#cb83-4918" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-4919"><a href="#cb83-4919" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-4920"><a href="#cb83-4920" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4921"><a href="#cb83-4921" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4922"><a href="#cb83-4922" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4923"><a href="#cb83-4923" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4924"><a href="#cb83-4924" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4925"><a href="#cb83-4925" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-4926"><a href="#cb83-4926" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-4927"><a href="#cb83-4927" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4928"><a href="#cb83-4928" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4929"><a href="#cb83-4929" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4930"><a href="#cb83-4930" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4931"><a href="#cb83-4931" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4932"><a href="#cb83-4932" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-4933"><a href="#cb83-4933" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-4934"><a href="#cb83-4934" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4935"><a href="#cb83-4935" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4936"><a href="#cb83-4936" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4937"><a href="#cb83-4937" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4938"><a href="#cb83-4938" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4939"><a href="#cb83-4939" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-4940"><a href="#cb83-4940" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-4941"><a href="#cb83-4941" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4942"><a href="#cb83-4942" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4943"><a href="#cb83-4943" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4944"><a href="#cb83-4944" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4945"><a href="#cb83-4945" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4946"><a href="#cb83-4946" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-4947"><a href="#cb83-4947" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-4948"><a href="#cb83-4948" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4949"><a href="#cb83-4949" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4950"><a href="#cb83-4950" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4951"><a href="#cb83-4951" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4952"><a href="#cb83-4952" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4953"><a href="#cb83-4953" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-4954"><a href="#cb83-4954" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-4955"><a href="#cb83-4955" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4956"><a href="#cb83-4956" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4957"><a href="#cb83-4957" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4958"><a href="#cb83-4958" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4959"><a href="#cb83-4959" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4960"><a href="#cb83-4960" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-4961"><a href="#cb83-4961" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-4962"><a href="#cb83-4962" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4963"><a href="#cb83-4963" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4964"><a href="#cb83-4964" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4965"><a href="#cb83-4965" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4966"><a href="#cb83-4966" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4967"><a href="#cb83-4967" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-4968"><a href="#cb83-4968" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-4969"><a href="#cb83-4969" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-4970"><a href="#cb83-4970" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-4971"><a href="#cb83-4971" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-4972"><a href="#cb83-4972" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-4973"><a href="#cb83-4973" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-4974"><a href="#cb83-4974" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-4975"><a href="#cb83-4975" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-4976"><a href="#cb83-4976" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-4977"><a href="#cb83-4977" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-4978"><a href="#cb83-4978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4979"><a href="#cb83-4979" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large_largeh <span class="ot">&lt;-</span> all_effs_sex_large_largeh <span class="sc">%&gt;%</span></span>
<span id="cb83-4980"><a href="#cb83-4980" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-4981"><a href="#cb83-4981" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc, ssize, power) <span class="sc">%&gt;%</span></span>
<span id="cb83-4982"><a href="#cb83-4982" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb83-4983"><a href="#cb83-4983" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-4984"><a href="#cb83-4984" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"none"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-4985"><a href="#cb83-4985" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"large"</span>))</span>
<span id="cb83-4986"><a href="#cb83-4986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4987"><a href="#cb83-4987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4988"><a href="#cb83-4988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4989"><a href="#cb83-4989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4990"><a href="#cb83-4990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4991"><a href="#cb83-4991" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-4992"><a href="#cb83-4992" aria-hidden="true" tabindex="-1"></a>    calc_power_sex_large_noh,</span>
<span id="cb83-4993"><a href="#cb83-4993" aria-hidden="true" tabindex="-1"></a>    calc_power_sex_large_lowh,</span>
<span id="cb83-4994"><a href="#cb83-4994" aria-hidden="true" tabindex="-1"></a>    calc_power_sex_large_largeh</span>
<span id="cb83-4995"><a href="#cb83-4995" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-4996"><a href="#cb83-4996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4997"><a href="#cb83-4997" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">lapply</span>(all_sex_effs_sex_only, unlist))</span>
<span id="cb83-4998"><a href="#cb83-4998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4999"><a href="#cb83-4999" aria-hidden="true" tabindex="-1"></a><span class="co"># plot1 &lt;- all_sex_effs_sex_only %&gt;%</span></span>
<span id="cb83-5000"><a href="#cb83-5000" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(Effect %in% c("Treatment")) %&gt;%</span></span>
<span id="cb83-5001"><a href="#cb83-5001" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(heterosc %in% c("low")) %&gt;%</span></span>
<span id="cb83-5002"><a href="#cb83-5002" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sample_size = factor(sample_size,</span></span>
<span id="cb83-5003"><a href="#cb83-5003" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("5M+5F", "10M+10F", "50M+50F"))) %&gt;%</span></span>
<span id="cb83-5004"><a href="#cb83-5004" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(method = recode(method,</span></span>
<span id="cb83-5005"><a href="#cb83-5005" aria-hidden="true" tabindex="-1"></a><span class="co">#                          "ANOVA" = "Factorial")) %&gt;%</span></span>
<span id="cb83-5006"><a href="#cb83-5006" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x = treat_es2, y = p_value, colour = sample_size)) +</span></span>
<span id="cb83-5007"><a href="#cb83-5007" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_hline(yintercept = 0.8, linetype = 1, colour = "red") +</span></span>
<span id="cb83-5008"><a href="#cb83-5008" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_line() +</span></span>
<span id="cb83-5009"><a href="#cb83-5009" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_bw() +</span></span>
<span id="cb83-5010"><a href="#cb83-5010" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylab("Statistical power") +</span></span>
<span id="cb83-5011"><a href="#cb83-5011" aria-hidden="true" tabindex="-1"></a><span class="co">#   xlab("Main treatment effect") +</span></span>
<span id="cb83-5012"><a href="#cb83-5012" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_colour_manual(name = "Sample size", values = cbb_palette) +</span></span>
<span id="cb83-5013"><a href="#cb83-5013" aria-hidden="true" tabindex="-1"></a><span class="co">#   # scale_linetype_discrete(name = "Heteroscedasticity")  +</span></span>
<span id="cb83-5014"><a href="#cb83-5014" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylim(0, 1)</span></span>
<span id="cb83-5015"><a href="#cb83-5015" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5016"><a href="#cb83-5016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5017"><a href="#cb83-5017" aria-hidden="true" tabindex="-1"></a><span class="co"># plot2 &lt;- all_sex_effs_sex_only %&gt;%</span></span>
<span id="cb83-5018"><a href="#cb83-5018" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(Effect %in% c("Treatment")) %&gt;%</span></span>
<span id="cb83-5019"><a href="#cb83-5019" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(heterosc %in% c("large")) %&gt;%</span></span>
<span id="cb83-5020"><a href="#cb83-5020" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sample_size = factor(sample_size,</span></span>
<span id="cb83-5021"><a href="#cb83-5021" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("5M+5F", "10M+10F", "50M+50F"))) %&gt;%</span></span>
<span id="cb83-5022"><a href="#cb83-5022" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(method = recode(method,</span></span>
<span id="cb83-5023"><a href="#cb83-5023" aria-hidden="true" tabindex="-1"></a><span class="co">#                          "ANOVA" = "Factorial")) %&gt;%</span></span>
<span id="cb83-5024"><a href="#cb83-5024" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x = treat_es2, y = p_value, colour = sample_size)) +</span></span>
<span id="cb83-5025"><a href="#cb83-5025" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_hline(yintercept = 0.8, linetype = 1, colour = "red") +</span></span>
<span id="cb83-5026"><a href="#cb83-5026" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_line() +</span></span>
<span id="cb83-5027"><a href="#cb83-5027" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_bw() +</span></span>
<span id="cb83-5028"><a href="#cb83-5028" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylab("Statistical power") +</span></span>
<span id="cb83-5029"><a href="#cb83-5029" aria-hidden="true" tabindex="-1"></a><span class="co">#   xlab("Main treatment effect") +</span></span>
<span id="cb83-5030"><a href="#cb83-5030" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_colour_manual(name = "Sample size", values = cbb_palette) +</span></span>
<span id="cb83-5031"><a href="#cb83-5031" aria-hidden="true" tabindex="-1"></a><span class="co">#   # scale_linetype_discrete(name = "Heteroscedasticity")  +</span></span>
<span id="cb83-5032"><a href="#cb83-5032" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylim(0, 1)</span></span>
<span id="cb83-5033"><a href="#cb83-5033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5034"><a href="#cb83-5034" aria-hidden="true" tabindex="-1"></a><span class="co"># ggarrange(plot1, plot2, ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")</span></span>
<span id="cb83-5035"><a href="#cb83-5035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5036"><a href="#cb83-5036" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> all_sex_effs_sex_only <span class="sc">%&gt;%</span></span>
<span id="cb83-5037"><a href="#cb83-5037" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(heterosc %in% c("low")) %&gt;%</span></span>
<span id="cb83-5038"><a href="#cb83-5038" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sample_size = factor(sample_size,</span></span>
<span id="cb83-5039"><a href="#cb83-5039" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("5M+5F", "10M+10F", "50M+50F"))) %&gt;%</span></span>
<span id="cb83-5040"><a href="#cb83-5040" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sex_eff_size = factor(sex_eff_size,</span></span>
<span id="cb83-5041"><a href="#cb83-5041" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("none", "small", "large"))) %&gt;%</span></span>
<span id="cb83-5042"><a href="#cb83-5042" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> ssize, <span class="at">colour =</span> heterosc)) <span class="sc">+</span></span>
<span id="cb83-5043"><a href="#cb83-5043" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_hline(yintercept = 0.8, linetype = 1, colour = "red") +</span></span>
<span id="cb83-5044"><a href="#cb83-5044" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb83-5045"><a href="#cb83-5045" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb83-5046"><a href="#cb83-5046" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Sample size"</span>) <span class="sc">+</span></span>
<span id="cb83-5047"><a href="#cb83-5047" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Main treatment effect"</span>) <span class="sc">+</span></span>
<span id="cb83-5048"><a href="#cb83-5048" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">name =</span> <span class="st">"Heteroscedasticity"</span>, <span class="at">values =</span> cbb_palette) <span class="sc">+</span> <span class="fu">coord_trans</span>(<span class="at">y =</span> <span class="st">"log10"</span>) <span class="sc">+</span></span>
<span id="cb83-5049"><a href="#cb83-5049" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">15</span>))</span>
<span id="cb83-5050"><a href="#cb83-5050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5051"><a href="#cb83-5051" aria-hidden="true" tabindex="-1"></a><span class="co"># plot1</span></span>
<span id="cb83-5052"><a href="#cb83-5052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5053"><a href="#cb83-5053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5054"><a href="#cb83-5054" aria-hidden="true" tabindex="-1"></a>plot1<span class="fl">.1</span> <span class="ot">&lt;-</span> all_sex_effs_sex_only <span class="sc">%&gt;%</span></span>
<span id="cb83-5055"><a href="#cb83-5055" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(heterosc %in% c("low")) %&gt;%</span></span>
<span id="cb83-5056"><a href="#cb83-5056" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sample_size = factor(sample_size,</span></span>
<span id="cb83-5057"><a href="#cb83-5057" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("5M+5F", "10M+10F", "50M+50F"))) %&gt;%</span></span>
<span id="cb83-5058"><a href="#cb83-5058" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sex_eff_size = factor(sex_eff_size,</span></span>
<span id="cb83-5059"><a href="#cb83-5059" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("none", "small", "large"))) %&gt;%</span></span>
<span id="cb83-5060"><a href="#cb83-5060" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> ssize, <span class="at">linetype =</span> heterosc)) <span class="sc">+</span></span>
<span id="cb83-5061"><a href="#cb83-5061" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_hline(yintercept = 0.8, linetype = 1, colour = "red") +</span></span>
<span id="cb83-5062"><a href="#cb83-5062" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb83-5063"><a href="#cb83-5063" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb83-5064"><a href="#cb83-5064" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Sample size"</span>) <span class="sc">+</span></span>
<span id="cb83-5065"><a href="#cb83-5065" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Main treatment effect"</span>) <span class="sc">+</span></span>
<span id="cb83-5066"><a href="#cb83-5066" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">linetype =</span> <span class="st">"Heteroscedasticity"</span>) <span class="sc">+</span></span>
<span id="cb83-5067"><a href="#cb83-5067" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_colour_manual(name = "Heteroscedasticity", values = cbb_palette) +</span></span>
<span id="cb83-5068"><a href="#cb83-5068" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fl">0.3</span>, <span class="fl">0.7</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">5</span>, <span class="dv">70</span>)</span>
<span id="cb83-5069"><a href="#cb83-5069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5070"><a href="#cb83-5070" aria-hidden="true" tabindex="-1"></a><span class="co"># plot1.1</span></span>
<span id="cb83-5071"><a href="#cb83-5071" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-5072"><a href="#cb83-5072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5073"><a href="#cb83-5073" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5074"><a href="#cb83-5074" aria-hidden="true" tabindex="-1"></a>Scenario 2: same but interaction of magnitude with more variable sex responding more strongly to the treatment.</span>
<span id="cb83-5075"><a href="#cb83-5075" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5078"><a href="#cb83-5078" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-5079"><a href="#cb83-5079" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb83-5080"><a href="#cb83-5080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5081"><a href="#cb83-5081" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-5082"><a href="#cb83-5082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5083"><a href="#cb83-5083" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb83-5084"><a href="#cb83-5084" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-5085"><a href="#cb83-5085" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-5086"><a href="#cb83-5086" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-5087"><a href="#cb83-5087" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-5088"><a href="#cb83-5088" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-5089"><a href="#cb83-5089" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-5090"><a href="#cb83-5090" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb83-5091"><a href="#cb83-5091" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb83-5092"><a href="#cb83-5092" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-5093"><a href="#cb83-5093" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb83-5094"><a href="#cb83-5094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5095"><a href="#cb83-5095" aria-hidden="true" tabindex="-1"></a>all_effs_sex_large_noh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-5096"><a href="#cb83-5096" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5097"><a href="#cb83-5097" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5098"><a href="#cb83-5098" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5099"><a href="#cb83-5099" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5100"><a href="#cb83-5100" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5101"><a href="#cb83-5101" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5102"><a href="#cb83-5102" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-5103"><a href="#cb83-5103" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5104"><a href="#cb83-5104" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5105"><a href="#cb83-5105" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5106"><a href="#cb83-5106" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5107"><a href="#cb83-5107" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5108"><a href="#cb83-5108" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5109"><a href="#cb83-5109" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-5110"><a href="#cb83-5110" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5111"><a href="#cb83-5111" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5112"><a href="#cb83-5112" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5113"><a href="#cb83-5113" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5114"><a href="#cb83-5114" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5115"><a href="#cb83-5115" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5116"><a href="#cb83-5116" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-5117"><a href="#cb83-5117" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5118"><a href="#cb83-5118" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5119"><a href="#cb83-5119" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5120"><a href="#cb83-5120" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5121"><a href="#cb83-5121" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5122"><a href="#cb83-5122" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5123"><a href="#cb83-5123" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-5124"><a href="#cb83-5124" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5125"><a href="#cb83-5125" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5126"><a href="#cb83-5126" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5127"><a href="#cb83-5127" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5128"><a href="#cb83-5128" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5129"><a href="#cb83-5129" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5130"><a href="#cb83-5130" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-5131"><a href="#cb83-5131" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5132"><a href="#cb83-5132" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5133"><a href="#cb83-5133" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5134"><a href="#cb83-5134" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5135"><a href="#cb83-5135" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5136"><a href="#cb83-5136" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5137"><a href="#cb83-5137" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-5138"><a href="#cb83-5138" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5139"><a href="#cb83-5139" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5140"><a href="#cb83-5140" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5141"><a href="#cb83-5141" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5142"><a href="#cb83-5142" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5143"><a href="#cb83-5143" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5144"><a href="#cb83-5144" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-5145"><a href="#cb83-5145" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5146"><a href="#cb83-5146" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5147"><a href="#cb83-5147" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5148"><a href="#cb83-5148" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5149"><a href="#cb83-5149" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5150"><a href="#cb83-5150" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5151"><a href="#cb83-5151" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-5152"><a href="#cb83-5152" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5153"><a href="#cb83-5153" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5154"><a href="#cb83-5154" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5155"><a href="#cb83-5155" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5156"><a href="#cb83-5156" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5157"><a href="#cb83-5157" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5158"><a href="#cb83-5158" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-5159"><a href="#cb83-5159" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-5160"><a href="#cb83-5160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5161"><a href="#cb83-5161" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large_noh <span class="ot">&lt;-</span> all_effs_sex_large_noh <span class="sc">%&gt;%</span></span>
<span id="cb83-5162"><a href="#cb83-5162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-5163"><a href="#cb83-5163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc, ssize, power) <span class="sc">%&gt;%</span></span>
<span id="cb83-5164"><a href="#cb83-5164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb83-5165"><a href="#cb83-5165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-5166"><a href="#cb83-5166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"none"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-5167"><a href="#cb83-5167" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"none"</span>))</span>
<span id="cb83-5168"><a href="#cb83-5168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5169"><a href="#cb83-5169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5170"><a href="#cb83-5170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5171"><a href="#cb83-5171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5172"><a href="#cb83-5172" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-5173"><a href="#cb83-5173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5174"><a href="#cb83-5174" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb83-5175"><a href="#cb83-5175" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-5176"><a href="#cb83-5176" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-5177"><a href="#cb83-5177" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-5178"><a href="#cb83-5178" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-5179"><a href="#cb83-5179" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-5180"><a href="#cb83-5180" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-5181"><a href="#cb83-5181" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb83-5182"><a href="#cb83-5182" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb83-5183"><a href="#cb83-5183" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-5184"><a href="#cb83-5184" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb83-5185"><a href="#cb83-5185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5186"><a href="#cb83-5186" aria-hidden="true" tabindex="-1"></a>all_effs_sex_large_lowh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-5187"><a href="#cb83-5187" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5188"><a href="#cb83-5188" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5189"><a href="#cb83-5189" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5190"><a href="#cb83-5190" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5191"><a href="#cb83-5191" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5192"><a href="#cb83-5192" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5193"><a href="#cb83-5193" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-5194"><a href="#cb83-5194" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5195"><a href="#cb83-5195" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5196"><a href="#cb83-5196" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5197"><a href="#cb83-5197" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5198"><a href="#cb83-5198" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5199"><a href="#cb83-5199" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5200"><a href="#cb83-5200" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-5201"><a href="#cb83-5201" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5202"><a href="#cb83-5202" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5203"><a href="#cb83-5203" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5204"><a href="#cb83-5204" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5205"><a href="#cb83-5205" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5206"><a href="#cb83-5206" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5207"><a href="#cb83-5207" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-5208"><a href="#cb83-5208" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5209"><a href="#cb83-5209" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5210"><a href="#cb83-5210" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5211"><a href="#cb83-5211" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5212"><a href="#cb83-5212" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5213"><a href="#cb83-5213" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5214"><a href="#cb83-5214" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-5215"><a href="#cb83-5215" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5216"><a href="#cb83-5216" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5217"><a href="#cb83-5217" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5218"><a href="#cb83-5218" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5219"><a href="#cb83-5219" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5220"><a href="#cb83-5220" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5221"><a href="#cb83-5221" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-5222"><a href="#cb83-5222" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5223"><a href="#cb83-5223" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5224"><a href="#cb83-5224" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5225"><a href="#cb83-5225" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5226"><a href="#cb83-5226" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5227"><a href="#cb83-5227" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5228"><a href="#cb83-5228" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-5229"><a href="#cb83-5229" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5230"><a href="#cb83-5230" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5231"><a href="#cb83-5231" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5232"><a href="#cb83-5232" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5233"><a href="#cb83-5233" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5234"><a href="#cb83-5234" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5235"><a href="#cb83-5235" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-5236"><a href="#cb83-5236" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5237"><a href="#cb83-5237" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5238"><a href="#cb83-5238" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5239"><a href="#cb83-5239" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5240"><a href="#cb83-5240" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5241"><a href="#cb83-5241" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5242"><a href="#cb83-5242" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-5243"><a href="#cb83-5243" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5244"><a href="#cb83-5244" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5245"><a href="#cb83-5245" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5246"><a href="#cb83-5246" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5247"><a href="#cb83-5247" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5248"><a href="#cb83-5248" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5249"><a href="#cb83-5249" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-5250"><a href="#cb83-5250" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-5251"><a href="#cb83-5251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5252"><a href="#cb83-5252" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large_lowh <span class="ot">&lt;-</span> all_effs_sex_large_lowh <span class="sc">%&gt;%</span></span>
<span id="cb83-5253"><a href="#cb83-5253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-5254"><a href="#cb83-5254" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc, ssize, power) <span class="sc">%&gt;%</span></span>
<span id="cb83-5255"><a href="#cb83-5255" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb83-5256"><a href="#cb83-5256" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-5257"><a href="#cb83-5257" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"none"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-5258"><a href="#cb83-5258" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"low"</span>))</span>
<span id="cb83-5259"><a href="#cb83-5259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5260"><a href="#cb83-5260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5261"><a href="#cb83-5261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5262"><a href="#cb83-5262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5263"><a href="#cb83-5263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5264"><a href="#cb83-5264" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb83-5265"><a href="#cb83-5265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5266"><a href="#cb83-5266" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb83-5267"><a href="#cb83-5267" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-5268"><a href="#cb83-5268" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-5269"><a href="#cb83-5269" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-5270"><a href="#cb83-5270" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-5271"><a href="#cb83-5271" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-5272"><a href="#cb83-5272" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-5273"><a href="#cb83-5273" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb83-5274"><a href="#cb83-5274" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb83-5275"><a href="#cb83-5275" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-5276"><a href="#cb83-5276" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb83-5277"><a href="#cb83-5277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5278"><a href="#cb83-5278" aria-hidden="true" tabindex="-1"></a>all_effs_sex_large_largeh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-5279"><a href="#cb83-5279" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5280"><a href="#cb83-5280" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5281"><a href="#cb83-5281" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5282"><a href="#cb83-5282" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5283"><a href="#cb83-5283" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5284"><a href="#cb83-5284" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5285"><a href="#cb83-5285" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-5286"><a href="#cb83-5286" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5287"><a href="#cb83-5287" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5288"><a href="#cb83-5288" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5289"><a href="#cb83-5289" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5290"><a href="#cb83-5290" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5291"><a href="#cb83-5291" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5292"><a href="#cb83-5292" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-5293"><a href="#cb83-5293" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5294"><a href="#cb83-5294" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5295"><a href="#cb83-5295" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5296"><a href="#cb83-5296" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5297"><a href="#cb83-5297" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5298"><a href="#cb83-5298" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5299"><a href="#cb83-5299" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-5300"><a href="#cb83-5300" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5301"><a href="#cb83-5301" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5302"><a href="#cb83-5302" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5303"><a href="#cb83-5303" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5304"><a href="#cb83-5304" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5305"><a href="#cb83-5305" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5306"><a href="#cb83-5306" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-5307"><a href="#cb83-5307" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5308"><a href="#cb83-5308" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5309"><a href="#cb83-5309" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5310"><a href="#cb83-5310" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5311"><a href="#cb83-5311" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5312"><a href="#cb83-5312" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5313"><a href="#cb83-5313" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-5314"><a href="#cb83-5314" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5315"><a href="#cb83-5315" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5316"><a href="#cb83-5316" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5317"><a href="#cb83-5317" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5318"><a href="#cb83-5318" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5319"><a href="#cb83-5319" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5320"><a href="#cb83-5320" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-5321"><a href="#cb83-5321" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5322"><a href="#cb83-5322" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5323"><a href="#cb83-5323" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5324"><a href="#cb83-5324" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5325"><a href="#cb83-5325" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5326"><a href="#cb83-5326" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5327"><a href="#cb83-5327" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-5328"><a href="#cb83-5328" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5329"><a href="#cb83-5329" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5330"><a href="#cb83-5330" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5331"><a href="#cb83-5331" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5332"><a href="#cb83-5332" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5333"><a href="#cb83-5333" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5334"><a href="#cb83-5334" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-5335"><a href="#cb83-5335" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5336"><a href="#cb83-5336" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5337"><a href="#cb83-5337" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5338"><a href="#cb83-5338" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5339"><a href="#cb83-5339" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5340"><a href="#cb83-5340" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5341"><a href="#cb83-5341" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-5342"><a href="#cb83-5342" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-5343"><a href="#cb83-5343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5344"><a href="#cb83-5344" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large_largeh <span class="ot">&lt;-</span> all_effs_sex_large_largeh <span class="sc">%&gt;%</span></span>
<span id="cb83-5345"><a href="#cb83-5345" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-5346"><a href="#cb83-5346" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc, ssize, power) <span class="sc">%&gt;%</span></span>
<span id="cb83-5347"><a href="#cb83-5347" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb83-5348"><a href="#cb83-5348" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-5349"><a href="#cb83-5349" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"none"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-5350"><a href="#cb83-5350" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"large"</span>))</span>
<span id="cb83-5351"><a href="#cb83-5351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5352"><a href="#cb83-5352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5353"><a href="#cb83-5353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5354"><a href="#cb83-5354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5355"><a href="#cb83-5355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5356"><a href="#cb83-5356" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-5357"><a href="#cb83-5357" aria-hidden="true" tabindex="-1"></a>    calc_power_sex_large_noh,</span>
<span id="cb83-5358"><a href="#cb83-5358" aria-hidden="true" tabindex="-1"></a>    calc_power_sex_large_lowh,</span>
<span id="cb83-5359"><a href="#cb83-5359" aria-hidden="true" tabindex="-1"></a>    calc_power_sex_large_largeh</span>
<span id="cb83-5360"><a href="#cb83-5360" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-5361"><a href="#cb83-5361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5362"><a href="#cb83-5362" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">lapply</span>(all_sex_effs_sex_only, unlist))</span>
<span id="cb83-5363"><a href="#cb83-5363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5364"><a href="#cb83-5364" aria-hidden="true" tabindex="-1"></a><span class="co"># plot1 &lt;- all_sex_effs_sex_only %&gt;%</span></span>
<span id="cb83-5365"><a href="#cb83-5365" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(Effect %in% c("Treatment")) %&gt;%</span></span>
<span id="cb83-5366"><a href="#cb83-5366" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(heterosc %in% c("low")) %&gt;%</span></span>
<span id="cb83-5367"><a href="#cb83-5367" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sample_size = factor(sample_size,</span></span>
<span id="cb83-5368"><a href="#cb83-5368" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("5M+5F", "10M+10F", "50M+50F"))) %&gt;%</span></span>
<span id="cb83-5369"><a href="#cb83-5369" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(method = recode(method,</span></span>
<span id="cb83-5370"><a href="#cb83-5370" aria-hidden="true" tabindex="-1"></a><span class="co">#                          "ANOVA" = "Factorial")) %&gt;%</span></span>
<span id="cb83-5371"><a href="#cb83-5371" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x = treat_es2, y = p_value, colour = sample_size)) +</span></span>
<span id="cb83-5372"><a href="#cb83-5372" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_hline(yintercept = 0.8, linetype = 1, colour = "red") +</span></span>
<span id="cb83-5373"><a href="#cb83-5373" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_line() +</span></span>
<span id="cb83-5374"><a href="#cb83-5374" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_bw() +</span></span>
<span id="cb83-5375"><a href="#cb83-5375" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylab("Statistical power") +</span></span>
<span id="cb83-5376"><a href="#cb83-5376" aria-hidden="true" tabindex="-1"></a><span class="co">#   xlab("Main treatment effect") +</span></span>
<span id="cb83-5377"><a href="#cb83-5377" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_colour_manual(name = "Sample size", values = cbb_palette) +</span></span>
<span id="cb83-5378"><a href="#cb83-5378" aria-hidden="true" tabindex="-1"></a><span class="co">#   # scale_linetype_discrete(name = "Heteroscedasticity")  +</span></span>
<span id="cb83-5379"><a href="#cb83-5379" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylim(0, 1)</span></span>
<span id="cb83-5380"><a href="#cb83-5380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5381"><a href="#cb83-5381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5382"><a href="#cb83-5382" aria-hidden="true" tabindex="-1"></a><span class="co"># plot2 &lt;- all_sex_effs_sex_only %&gt;%</span></span>
<span id="cb83-5383"><a href="#cb83-5383" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(Effect %in% c("Treatment")) %&gt;%</span></span>
<span id="cb83-5384"><a href="#cb83-5384" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(heterosc %in% c("large")) %&gt;%</span></span>
<span id="cb83-5385"><a href="#cb83-5385" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sample_size = factor(sample_size,</span></span>
<span id="cb83-5386"><a href="#cb83-5386" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("5M+5F", "10M+10F", "50M+50F"))) %&gt;%</span></span>
<span id="cb83-5387"><a href="#cb83-5387" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(method = recode(method,</span></span>
<span id="cb83-5388"><a href="#cb83-5388" aria-hidden="true" tabindex="-1"></a><span class="co">#                          "ANOVA" = "Factorial")) %&gt;%</span></span>
<span id="cb83-5389"><a href="#cb83-5389" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x = treat_es2, y = p_value, colour = sample_size)) +</span></span>
<span id="cb83-5390"><a href="#cb83-5390" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_hline(yintercept = 0.8, linetype = 1, colour = "red") +</span></span>
<span id="cb83-5391"><a href="#cb83-5391" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_line() +</span></span>
<span id="cb83-5392"><a href="#cb83-5392" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_bw() +</span></span>
<span id="cb83-5393"><a href="#cb83-5393" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylab("Statistical power") +</span></span>
<span id="cb83-5394"><a href="#cb83-5394" aria-hidden="true" tabindex="-1"></a><span class="co">#   xlab("Main treatment effect") +</span></span>
<span id="cb83-5395"><a href="#cb83-5395" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_colour_manual(name = "Sample size", values = cbb_palette) +</span></span>
<span id="cb83-5396"><a href="#cb83-5396" aria-hidden="true" tabindex="-1"></a><span class="co">#   # scale_linetype_discrete(name = "Heteroscedasticity")  +</span></span>
<span id="cb83-5397"><a href="#cb83-5397" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylim(0, 1)</span></span>
<span id="cb83-5398"><a href="#cb83-5398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5399"><a href="#cb83-5399" aria-hidden="true" tabindex="-1"></a><span class="co"># ggarrange(plot1, plot2, ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")</span></span>
<span id="cb83-5400"><a href="#cb83-5400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5401"><a href="#cb83-5401" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> all_sex_effs_sex_only <span class="sc">%&gt;%</span></span>
<span id="cb83-5402"><a href="#cb83-5402" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(heterosc %in% c("low")) %&gt;%</span></span>
<span id="cb83-5403"><a href="#cb83-5403" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sample_size = factor(sample_size,</span></span>
<span id="cb83-5404"><a href="#cb83-5404" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("5M+5F", "10M+10F", "50M+50F"))) %&gt;%</span></span>
<span id="cb83-5405"><a href="#cb83-5405" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sex_eff_size = factor(sex_eff_size,</span></span>
<span id="cb83-5406"><a href="#cb83-5406" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("none", "small", "large"))) %&gt;%</span></span>
<span id="cb83-5407"><a href="#cb83-5407" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> ssize, <span class="at">colour =</span> heterosc)) <span class="sc">+</span></span>
<span id="cb83-5408"><a href="#cb83-5408" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_hline(yintercept = 0.8, linetype = 1, colour = "red") +</span></span>
<span id="cb83-5409"><a href="#cb83-5409" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb83-5410"><a href="#cb83-5410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb83-5411"><a href="#cb83-5411" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Sample size"</span>) <span class="sc">+</span></span>
<span id="cb83-5412"><a href="#cb83-5412" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Main treatment effect"</span>) <span class="sc">+</span></span>
<span id="cb83-5413"><a href="#cb83-5413" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">name =</span> <span class="st">"Effect"</span>, <span class="at">values =</span> cbb_palette) <span class="sc">+</span> <span class="fu">coord_trans</span>(<span class="at">y =</span> <span class="st">"log10"</span>) <span class="sc">+</span></span>
<span id="cb83-5414"><a href="#cb83-5414" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">15</span>))</span>
<span id="cb83-5415"><a href="#cb83-5415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5416"><a href="#cb83-5416" aria-hidden="true" tabindex="-1"></a><span class="co"># plot2</span></span>
<span id="cb83-5417"><a href="#cb83-5417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5418"><a href="#cb83-5418" aria-hidden="true" tabindex="-1"></a>plot2<span class="fl">.1</span> <span class="ot">&lt;-</span> all_sex_effs_sex_only <span class="sc">%&gt;%</span></span>
<span id="cb83-5419"><a href="#cb83-5419" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(heterosc %in% c("low")) %&gt;%</span></span>
<span id="cb83-5420"><a href="#cb83-5420" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sample_size = factor(sample_size,</span></span>
<span id="cb83-5421"><a href="#cb83-5421" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("5M+5F", "10M+10F", "50M+50F"))) %&gt;%</span></span>
<span id="cb83-5422"><a href="#cb83-5422" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sex_eff_size = factor(sex_eff_size,</span></span>
<span id="cb83-5423"><a href="#cb83-5423" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("none", "small", "large"))) %&gt;%</span></span>
<span id="cb83-5424"><a href="#cb83-5424" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> ssize, <span class="at">linetype =</span> heterosc)) <span class="sc">+</span></span>
<span id="cb83-5425"><a href="#cb83-5425" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_hline(yintercept = 0.8, linetype = 1, colour = "red") +</span></span>
<span id="cb83-5426"><a href="#cb83-5426" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb83-5427"><a href="#cb83-5427" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb83-5428"><a href="#cb83-5428" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Sample size"</span>) <span class="sc">+</span></span>
<span id="cb83-5429"><a href="#cb83-5429" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Main treatment effect"</span>) <span class="sc">+</span></span>
<span id="cb83-5430"><a href="#cb83-5430" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">linetype =</span> <span class="st">"Heteroscedasticity"</span>) <span class="sc">+</span></span>
<span id="cb83-5431"><a href="#cb83-5431" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_colour_manual(name = "Heteroscedasticity", values = cbb_palette) +</span></span>
<span id="cb83-5432"><a href="#cb83-5432" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fl">0.3</span>, <span class="fl">0.7</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">5</span>, <span class="dv">25</span>)</span>
<span id="cb83-5433"><a href="#cb83-5433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5434"><a href="#cb83-5434" aria-hidden="true" tabindex="-1"></a><span class="co"># plot2.1</span></span>
<span id="cb83-5435"><a href="#cb83-5435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5436"><a href="#cb83-5436" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-5437"><a href="#cb83-5437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5438"><a href="#cb83-5438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5439"><a href="#cb83-5439" aria-hidden="true" tabindex="-1"></a>Scenario 3: same as no. 1 but with interaction of magnitude present, with the less variable group responding more strongly to the treatment.</span>
<span id="cb83-5440"><a href="#cb83-5440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5441"><a href="#cb83-5441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5444"><a href="#cb83-5444" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-5445"><a href="#cb83-5445" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb83-5446"><a href="#cb83-5446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5447"><a href="#cb83-5447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5448"><a href="#cb83-5448" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-5449"><a href="#cb83-5449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5450"><a href="#cb83-5450" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb83-5451"><a href="#cb83-5451" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-5452"><a href="#cb83-5452" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-5453"><a href="#cb83-5453" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-5454"><a href="#cb83-5454" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-5455"><a href="#cb83-5455" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-5456"><a href="#cb83-5456" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-5457"><a href="#cb83-5457" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb83-5458"><a href="#cb83-5458" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb83-5459"><a href="#cb83-5459" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.5</span></span>
<span id="cb83-5460"><a href="#cb83-5460" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb83-5461"><a href="#cb83-5461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5462"><a href="#cb83-5462" aria-hidden="true" tabindex="-1"></a>all_effs_sex_large_noh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-5463"><a href="#cb83-5463" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5464"><a href="#cb83-5464" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5465"><a href="#cb83-5465" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5466"><a href="#cb83-5466" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5467"><a href="#cb83-5467" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5468"><a href="#cb83-5468" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5469"><a href="#cb83-5469" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-5470"><a href="#cb83-5470" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5471"><a href="#cb83-5471" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5472"><a href="#cb83-5472" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5473"><a href="#cb83-5473" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5474"><a href="#cb83-5474" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5475"><a href="#cb83-5475" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5476"><a href="#cb83-5476" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-5477"><a href="#cb83-5477" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5478"><a href="#cb83-5478" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5479"><a href="#cb83-5479" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5480"><a href="#cb83-5480" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5481"><a href="#cb83-5481" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5482"><a href="#cb83-5482" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5483"><a href="#cb83-5483" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-5484"><a href="#cb83-5484" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5485"><a href="#cb83-5485" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5486"><a href="#cb83-5486" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5487"><a href="#cb83-5487" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5488"><a href="#cb83-5488" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5489"><a href="#cb83-5489" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5490"><a href="#cb83-5490" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-5491"><a href="#cb83-5491" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5492"><a href="#cb83-5492" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5493"><a href="#cb83-5493" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5494"><a href="#cb83-5494" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5495"><a href="#cb83-5495" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5496"><a href="#cb83-5496" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5497"><a href="#cb83-5497" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-5498"><a href="#cb83-5498" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5499"><a href="#cb83-5499" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5500"><a href="#cb83-5500" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5501"><a href="#cb83-5501" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5502"><a href="#cb83-5502" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5503"><a href="#cb83-5503" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5504"><a href="#cb83-5504" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-5505"><a href="#cb83-5505" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5506"><a href="#cb83-5506" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5507"><a href="#cb83-5507" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5508"><a href="#cb83-5508" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5509"><a href="#cb83-5509" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5510"><a href="#cb83-5510" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5511"><a href="#cb83-5511" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-5512"><a href="#cb83-5512" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5513"><a href="#cb83-5513" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5514"><a href="#cb83-5514" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5515"><a href="#cb83-5515" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5516"><a href="#cb83-5516" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5517"><a href="#cb83-5517" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5518"><a href="#cb83-5518" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-5519"><a href="#cb83-5519" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5520"><a href="#cb83-5520" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5521"><a href="#cb83-5521" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5522"><a href="#cb83-5522" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5523"><a href="#cb83-5523" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5524"><a href="#cb83-5524" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5525"><a href="#cb83-5525" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-5526"><a href="#cb83-5526" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-5527"><a href="#cb83-5527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5528"><a href="#cb83-5528" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large_noh <span class="ot">&lt;-</span> all_effs_sex_large_noh <span class="sc">%&gt;%</span></span>
<span id="cb83-5529"><a href="#cb83-5529" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-5530"><a href="#cb83-5530" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc, ssize, power) <span class="sc">%&gt;%</span></span>
<span id="cb83-5531"><a href="#cb83-5531" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb83-5532"><a href="#cb83-5532" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-5533"><a href="#cb83-5533" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"none"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-5534"><a href="#cb83-5534" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"none"</span>))</span>
<span id="cb83-5535"><a href="#cb83-5535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5536"><a href="#cb83-5536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5537"><a href="#cb83-5537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5538"><a href="#cb83-5538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5539"><a href="#cb83-5539" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-5540"><a href="#cb83-5540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5541"><a href="#cb83-5541" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb83-5542"><a href="#cb83-5542" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-5543"><a href="#cb83-5543" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-5544"><a href="#cb83-5544" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-5545"><a href="#cb83-5545" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-5546"><a href="#cb83-5546" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-5547"><a href="#cb83-5547" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-5548"><a href="#cb83-5548" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb83-5549"><a href="#cb83-5549" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb83-5550"><a href="#cb83-5550" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.5</span></span>
<span id="cb83-5551"><a href="#cb83-5551" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb83-5552"><a href="#cb83-5552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5553"><a href="#cb83-5553" aria-hidden="true" tabindex="-1"></a>all_effs_sex_large_lowh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-5554"><a href="#cb83-5554" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5555"><a href="#cb83-5555" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5556"><a href="#cb83-5556" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5557"><a href="#cb83-5557" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5558"><a href="#cb83-5558" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5559"><a href="#cb83-5559" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5560"><a href="#cb83-5560" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-5561"><a href="#cb83-5561" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5562"><a href="#cb83-5562" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5563"><a href="#cb83-5563" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5564"><a href="#cb83-5564" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5565"><a href="#cb83-5565" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5566"><a href="#cb83-5566" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5567"><a href="#cb83-5567" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-5568"><a href="#cb83-5568" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5569"><a href="#cb83-5569" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5570"><a href="#cb83-5570" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5571"><a href="#cb83-5571" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5572"><a href="#cb83-5572" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5573"><a href="#cb83-5573" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5574"><a href="#cb83-5574" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-5575"><a href="#cb83-5575" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5576"><a href="#cb83-5576" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5577"><a href="#cb83-5577" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5578"><a href="#cb83-5578" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5579"><a href="#cb83-5579" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5580"><a href="#cb83-5580" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5581"><a href="#cb83-5581" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-5582"><a href="#cb83-5582" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5583"><a href="#cb83-5583" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5584"><a href="#cb83-5584" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5585"><a href="#cb83-5585" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5586"><a href="#cb83-5586" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5587"><a href="#cb83-5587" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5588"><a href="#cb83-5588" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-5589"><a href="#cb83-5589" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5590"><a href="#cb83-5590" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5591"><a href="#cb83-5591" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5592"><a href="#cb83-5592" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5593"><a href="#cb83-5593" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5594"><a href="#cb83-5594" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5595"><a href="#cb83-5595" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-5596"><a href="#cb83-5596" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5597"><a href="#cb83-5597" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5598"><a href="#cb83-5598" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5599"><a href="#cb83-5599" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5600"><a href="#cb83-5600" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5601"><a href="#cb83-5601" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5602"><a href="#cb83-5602" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-5603"><a href="#cb83-5603" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5604"><a href="#cb83-5604" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5605"><a href="#cb83-5605" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5606"><a href="#cb83-5606" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5607"><a href="#cb83-5607" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5608"><a href="#cb83-5608" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5609"><a href="#cb83-5609" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-5610"><a href="#cb83-5610" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5611"><a href="#cb83-5611" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5612"><a href="#cb83-5612" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5613"><a href="#cb83-5613" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5614"><a href="#cb83-5614" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5615"><a href="#cb83-5615" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5616"><a href="#cb83-5616" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-5617"><a href="#cb83-5617" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-5618"><a href="#cb83-5618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5619"><a href="#cb83-5619" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large_lowh <span class="ot">&lt;-</span> all_effs_sex_large_lowh <span class="sc">%&gt;%</span></span>
<span id="cb83-5620"><a href="#cb83-5620" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-5621"><a href="#cb83-5621" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc, ssize, power) <span class="sc">%&gt;%</span></span>
<span id="cb83-5622"><a href="#cb83-5622" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb83-5623"><a href="#cb83-5623" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-5624"><a href="#cb83-5624" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"none"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-5625"><a href="#cb83-5625" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"low"</span>))</span>
<span id="cb83-5626"><a href="#cb83-5626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5627"><a href="#cb83-5627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5628"><a href="#cb83-5628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5629"><a href="#cb83-5629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5630"><a href="#cb83-5630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5631"><a href="#cb83-5631" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb83-5632"><a href="#cb83-5632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5633"><a href="#cb83-5633" aria-hidden="true" tabindex="-1"></a>no_per_gp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb83-5634"><a href="#cb83-5634" aria-hidden="true" tabindex="-1"></a>variable_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-5635"><a href="#cb83-5635" aria-hidden="true" tabindex="-1"></a>variable_sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-5636"><a href="#cb83-5636" aria-hidden="true" tabindex="-1"></a>treat_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-5637"><a href="#cb83-5637" aria-hidden="true" tabindex="-1"></a>sex_es <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-5638"><a href="#cb83-5638" aria-hidden="true" tabindex="-1"></a>female_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-5639"><a href="#cb83-5639" aria-hidden="true" tabindex="-1"></a>male_es <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-5640"><a href="#cb83-5640" aria-hidden="true" tabindex="-1"></a>treat_es2 <span class="ot">&lt;-</span> treat_es</span>
<span id="cb83-5641"><a href="#cb83-5641" aria-hidden="true" tabindex="-1"></a>sex_es2 <span class="ot">&lt;-</span> sex_es</span>
<span id="cb83-5642"><a href="#cb83-5642" aria-hidden="true" tabindex="-1"></a>ix_es2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.5</span></span>
<span id="cb83-5643"><a href="#cb83-5643" aria-hidden="true" tabindex="-1"></a>sex_sd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span>alpha</span>
<span id="cb83-5644"><a href="#cb83-5644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5645"><a href="#cb83-5645" aria-hidden="true" tabindex="-1"></a>all_effs_sex_large_largeh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-5646"><a href="#cb83-5646" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5647"><a href="#cb83-5647" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5648"><a href="#cb83-5648" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.1</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5649"><a href="#cb83-5649" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5650"><a href="#cb83-5650" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.1</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5651"><a href="#cb83-5651" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5652"><a href="#cb83-5652" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-5653"><a href="#cb83-5653" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5654"><a href="#cb83-5654" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5655"><a href="#cb83-5655" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.2</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5656"><a href="#cb83-5656" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5657"><a href="#cb83-5657" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.2</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5658"><a href="#cb83-5658" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5659"><a href="#cb83-5659" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-5660"><a href="#cb83-5660" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5661"><a href="#cb83-5661" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5662"><a href="#cb83-5662" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.3</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5663"><a href="#cb83-5663" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5664"><a href="#cb83-5664" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.3</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5665"><a href="#cb83-5665" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5666"><a href="#cb83-5666" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-5667"><a href="#cb83-5667" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5668"><a href="#cb83-5668" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5669"><a href="#cb83-5669" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.4</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5670"><a href="#cb83-5670" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5671"><a href="#cb83-5671" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.4</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5672"><a href="#cb83-5672" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5673"><a href="#cb83-5673" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-5674"><a href="#cb83-5674" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5675"><a href="#cb83-5675" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5676"><a href="#cb83-5676" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.5</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5677"><a href="#cb83-5677" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5678"><a href="#cb83-5678" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.5</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5679"><a href="#cb83-5679" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5680"><a href="#cb83-5680" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-5681"><a href="#cb83-5681" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5682"><a href="#cb83-5682" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5683"><a href="#cb83-5683" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.6</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5684"><a href="#cb83-5684" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5685"><a href="#cb83-5685" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.6</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5686"><a href="#cb83-5686" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5687"><a href="#cb83-5687" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-5688"><a href="#cb83-5688" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5689"><a href="#cb83-5689" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5690"><a href="#cb83-5690" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.7</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5691"><a href="#cb83-5691" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5692"><a href="#cb83-5692" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.7</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5693"><a href="#cb83-5693" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5694"><a href="#cb83-5694" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-5695"><a href="#cb83-5695" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5696"><a href="#cb83-5696" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5697"><a href="#cb83-5697" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.8</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5698"><a href="#cb83-5698" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5699"><a href="#cb83-5699" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.8</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5700"><a href="#cb83-5700" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5701"><a href="#cb83-5701" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-5702"><a href="#cb83-5702" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p_value_interaction_crossed</span>(</span>
<span id="cb83-5703"><a href="#cb83-5703" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_rep =</span> <span class="dv">1000</span>, <span class="at">no_per_gp =</span> no_per_gp, <span class="at">variable_mean =</span> variable_mean,</span>
<span id="cb83-5704"><a href="#cb83-5704" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_sd =</span> variable_sd, <span class="at">treat_es =</span> <span class="fl">0.9</span>, <span class="at">sex_es =</span> sex_es,</span>
<span id="cb83-5705"><a href="#cb83-5705" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_es =</span> male_es, <span class="at">female_es =</span> female_es,</span>
<span id="cb83-5706"><a href="#cb83-5706" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat_es2 =</span> <span class="fl">0.9</span>, <span class="at">sex_es2 =</span> sex_es2, <span class="at">ix_es2 =</span> ix_es2, <span class="at">sex_sd =</span> sex_sd,</span>
<span id="cb83-5707"><a href="#cb83-5707" aria-hidden="true" tabindex="-1"></a>        <span class="at">fix_power =</span> T</span>
<span id="cb83-5708"><a href="#cb83-5708" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-5709"><a href="#cb83-5709" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-5710"><a href="#cb83-5710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5711"><a href="#cb83-5711" aria-hidden="true" tabindex="-1"></a>calc_power_sex_large_largeh <span class="ot">&lt;-</span> all_effs_sex_large_largeh <span class="sc">%&gt;%</span></span>
<span id="cb83-5712"><a href="#cb83-5712" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Effect <span class="sc">==</span> <span class="st">"Residuals    "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-5713"><a href="#cb83-5713" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Effect, treat_es2, sex_es2, method, heterosc, ssize, power) <span class="sc">%&gt;%</span></span>
<span id="cb83-5714"><a href="#cb83-5714" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="fu">sum</span>(. <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb83-5715"><a href="#cb83-5715" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_eff_size =</span> <span class="fu">rep</span>(<span class="st">"large"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-5716"><a href="#cb83-5716" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ix_eff_size =</span> <span class="fu">rep</span>(<span class="st">"none"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-5717"><a href="#cb83-5717" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">heterosc =</span> <span class="fu">rep</span>(<span class="st">"large"</span>))</span>
<span id="cb83-5718"><a href="#cb83-5718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5719"><a href="#cb83-5719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5720"><a href="#cb83-5720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5721"><a href="#cb83-5721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5722"><a href="#cb83-5722" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb83-5723"><a href="#cb83-5723" aria-hidden="true" tabindex="-1"></a>    calc_power_sex_large_noh,</span>
<span id="cb83-5724"><a href="#cb83-5724" aria-hidden="true" tabindex="-1"></a>    calc_power_sex_large_lowh,</span>
<span id="cb83-5725"><a href="#cb83-5725" aria-hidden="true" tabindex="-1"></a>    calc_power_sex_large_largeh</span>
<span id="cb83-5726"><a href="#cb83-5726" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-5727"><a href="#cb83-5727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5728"><a href="#cb83-5728" aria-hidden="true" tabindex="-1"></a>all_sex_effs_sex_only <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">lapply</span>(all_sex_effs_sex_only, unlist))</span>
<span id="cb83-5729"><a href="#cb83-5729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5730"><a href="#cb83-5730" aria-hidden="true" tabindex="-1"></a><span class="co"># plot1 &lt;- all_sex_effs_sex_only %&gt;%</span></span>
<span id="cb83-5731"><a href="#cb83-5731" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(Effect %in% c("Treatment")) %&gt;%</span></span>
<span id="cb83-5732"><a href="#cb83-5732" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(heterosc %in% c("low")) %&gt;%</span></span>
<span id="cb83-5733"><a href="#cb83-5733" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sample_size = factor(sample_size,</span></span>
<span id="cb83-5734"><a href="#cb83-5734" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("5M+5F", "10M+10F", "50M+50F"))) %&gt;%</span></span>
<span id="cb83-5735"><a href="#cb83-5735" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(method = recode(method,</span></span>
<span id="cb83-5736"><a href="#cb83-5736" aria-hidden="true" tabindex="-1"></a><span class="co">#                          "ANOVA" = "Factorial")) %&gt;%</span></span>
<span id="cb83-5737"><a href="#cb83-5737" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x = treat_es2, y = p_value, colour = sample_size)) +</span></span>
<span id="cb83-5738"><a href="#cb83-5738" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_hline(yintercept = 0.8, linetype = 1, colour = "red") +</span></span>
<span id="cb83-5739"><a href="#cb83-5739" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_line() +</span></span>
<span id="cb83-5740"><a href="#cb83-5740" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_bw() +</span></span>
<span id="cb83-5741"><a href="#cb83-5741" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylab("Statistical power") +</span></span>
<span id="cb83-5742"><a href="#cb83-5742" aria-hidden="true" tabindex="-1"></a><span class="co">#   xlab("Main treatment effect") +</span></span>
<span id="cb83-5743"><a href="#cb83-5743" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_colour_manual(name = "Sample size", values = cbb_palette) +</span></span>
<span id="cb83-5744"><a href="#cb83-5744" aria-hidden="true" tabindex="-1"></a><span class="co">#   # scale_linetype_discrete(name = "Heteroscedasticity")  +</span></span>
<span id="cb83-5745"><a href="#cb83-5745" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylim(0, 1)</span></span>
<span id="cb83-5746"><a href="#cb83-5746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5747"><a href="#cb83-5747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5748"><a href="#cb83-5748" aria-hidden="true" tabindex="-1"></a><span class="co"># plot2 &lt;- all_sex_effs_sex_only %&gt;%</span></span>
<span id="cb83-5749"><a href="#cb83-5749" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(Effect %in% c("Treatment")) %&gt;%</span></span>
<span id="cb83-5750"><a href="#cb83-5750" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(heterosc %in% c("large")) %&gt;%</span></span>
<span id="cb83-5751"><a href="#cb83-5751" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sample_size = factor(sample_size,</span></span>
<span id="cb83-5752"><a href="#cb83-5752" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("5M+5F", "10M+10F", "50M+50F"))) %&gt;%</span></span>
<span id="cb83-5753"><a href="#cb83-5753" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(method = recode(method,</span></span>
<span id="cb83-5754"><a href="#cb83-5754" aria-hidden="true" tabindex="-1"></a><span class="co">#                          "ANOVA" = "Factorial")) %&gt;%</span></span>
<span id="cb83-5755"><a href="#cb83-5755" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x = treat_es2, y = p_value, colour = sample_size)) +</span></span>
<span id="cb83-5756"><a href="#cb83-5756" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_hline(yintercept = 0.8, linetype = 1, colour = "red") +</span></span>
<span id="cb83-5757"><a href="#cb83-5757" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_line() +</span></span>
<span id="cb83-5758"><a href="#cb83-5758" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_bw() +</span></span>
<span id="cb83-5759"><a href="#cb83-5759" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylab("Statistical power") +</span></span>
<span id="cb83-5760"><a href="#cb83-5760" aria-hidden="true" tabindex="-1"></a><span class="co">#   xlab("Main treatment effect") +</span></span>
<span id="cb83-5761"><a href="#cb83-5761" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_colour_manual(name = "Sample size", values = cbb_palette) +</span></span>
<span id="cb83-5762"><a href="#cb83-5762" aria-hidden="true" tabindex="-1"></a><span class="co">#   # scale_linetype_discrete(name = "Heteroscedasticity")  +</span></span>
<span id="cb83-5763"><a href="#cb83-5763" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylim(0, 1)</span></span>
<span id="cb83-5764"><a href="#cb83-5764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5765"><a href="#cb83-5765" aria-hidden="true" tabindex="-1"></a><span class="co"># ggarrange(plot1, plot2, ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")</span></span>
<span id="cb83-5766"><a href="#cb83-5766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5767"><a href="#cb83-5767" aria-hidden="true" tabindex="-1"></a>plot3 <span class="ot">&lt;-</span> all_sex_effs_sex_only <span class="sc">%&gt;%</span></span>
<span id="cb83-5768"><a href="#cb83-5768" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(heterosc %in% c("low")) %&gt;%</span></span>
<span id="cb83-5769"><a href="#cb83-5769" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sample_size = factor(sample_size,</span></span>
<span id="cb83-5770"><a href="#cb83-5770" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("5M+5F", "10M+10F", "50M+50F"))) %&gt;%</span></span>
<span id="cb83-5771"><a href="#cb83-5771" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sex_eff_size = factor(sex_eff_size,</span></span>
<span id="cb83-5772"><a href="#cb83-5772" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("none", "small", "large"))) %&gt;%</span></span>
<span id="cb83-5773"><a href="#cb83-5773" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> ssize, <span class="at">colour =</span> heterosc)) <span class="sc">+</span></span>
<span id="cb83-5774"><a href="#cb83-5774" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_hline(yintercept = 0.8, linetype = 1, colour = "red") +</span></span>
<span id="cb83-5775"><a href="#cb83-5775" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb83-5776"><a href="#cb83-5776" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb83-5777"><a href="#cb83-5777" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Sample size"</span>) <span class="sc">+</span></span>
<span id="cb83-5778"><a href="#cb83-5778" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Main treatment effect"</span>) <span class="sc">+</span></span>
<span id="cb83-5779"><a href="#cb83-5779" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">name =</span> <span class="st">"Effect"</span>, <span class="at">values =</span> cbb_palette) <span class="sc">+</span> <span class="fu">coord_trans</span>(<span class="at">y =</span> <span class="st">"log10"</span>) <span class="sc">+</span></span>
<span id="cb83-5780"><a href="#cb83-5780" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">15</span>))</span>
<span id="cb83-5781"><a href="#cb83-5781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5782"><a href="#cb83-5782" aria-hidden="true" tabindex="-1"></a><span class="co"># plot3</span></span>
<span id="cb83-5783"><a href="#cb83-5783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5784"><a href="#cb83-5784" aria-hidden="true" tabindex="-1"></a>plot3<span class="fl">.1</span> <span class="ot">&lt;-</span> all_sex_effs_sex_only <span class="sc">%&gt;%</span></span>
<span id="cb83-5785"><a href="#cb83-5785" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(heterosc %in% c("low")) %&gt;%</span></span>
<span id="cb83-5786"><a href="#cb83-5786" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sample_size = factor(sample_size,</span></span>
<span id="cb83-5787"><a href="#cb83-5787" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("5M+5F", "10M+10F", "50M+50F"))) %&gt;%</span></span>
<span id="cb83-5788"><a href="#cb83-5788" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(sex_eff_size = factor(sex_eff_size,</span></span>
<span id="cb83-5789"><a href="#cb83-5789" aria-hidden="true" tabindex="-1"></a><span class="co">#                                levels = c("none", "small", "large"))) %&gt;%</span></span>
<span id="cb83-5790"><a href="#cb83-5790" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treat_es2, <span class="at">y =</span> ssize, <span class="at">linetype =</span> heterosc)) <span class="sc">+</span></span>
<span id="cb83-5791"><a href="#cb83-5791" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_hline(yintercept = 0.8, linetype = 1, colour = "red") +</span></span>
<span id="cb83-5792"><a href="#cb83-5792" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb83-5793"><a href="#cb83-5793" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb83-5794"><a href="#cb83-5794" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Sample size"</span>) <span class="sc">+</span></span>
<span id="cb83-5795"><a href="#cb83-5795" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Main treatment effect"</span>) <span class="sc">+</span></span>
<span id="cb83-5796"><a href="#cb83-5796" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">linetype =</span> <span class="st">"Heteroscedasticity"</span>) <span class="sc">+</span></span>
<span id="cb83-5797"><a href="#cb83-5797" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_colour_manual(name = "Heteroscedasticity", values = cbb_palette) +</span></span>
<span id="cb83-5798"><a href="#cb83-5798" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fl">0.3</span>, <span class="fl">0.7</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">5</span>, <span class="dv">2200</span>)</span>
<span id="cb83-5799"><a href="#cb83-5799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5800"><a href="#cb83-5800" aria-hidden="true" tabindex="-1"></a><span class="co"># plot3.1</span></span>
<span id="cb83-5801"><a href="#cb83-5801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5802"><a href="#cb83-5802" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-5803"><a href="#cb83-5803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5804"><a href="#cb83-5804" aria-hidden="true" tabindex="-1"></a><span class="fu">## Combined plots</span></span>
<span id="cb83-5805"><a href="#cb83-5805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5806"><a href="#cb83-5806" aria-hidden="true" tabindex="-1"></a>(In all below examples the y axis (sample size) indicates the number of individuals per group and sex - hence the total sample size is 4 times the number indicated on the y axis.)</span>
<span id="cb83-5807"><a href="#cb83-5807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5808"><a href="#cb83-5808" aria-hidden="true" tabindex="-1"></a>Combined plot for scenarios of no interaction (A), interaction with stronger effect in more variable sex (B) and stronger effect in less variable sex (C) for full range of effect sizes and on log-scale for sample size:</span>
<span id="cb83-5809"><a href="#cb83-5809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5812"><a href="#cb83-5812" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-5813"><a href="#cb83-5813" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 13</span></span>
<span id="cb83-5814"><a href="#cb83-5814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5815"><a href="#cb83-5815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5816"><a href="#cb83-5816" aria-hidden="true" tabindex="-1"></a>comb1 <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(plot1, plot2, plot3, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">common.legend =</span> <span class="cn">TRUE</span>, <span class="at">legend =</span> <span class="st">"bottom"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>))</span>
<span id="cb83-5817"><a href="#cb83-5817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5818"><a href="#cb83-5818" aria-hidden="true" tabindex="-1"></a>comb1</span>
<span id="cb83-5819"><a href="#cb83-5819" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-5820"><a href="#cb83-5820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5821"><a href="#cb83-5821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5822"><a href="#cb83-5822" aria-hidden="true" tabindex="-1"></a>Combined plot for scenarios of no interaction (A), interaction with stronger effect in more variable sex (B) and stronger effect in less variable sex (C) for moderate-sized effect sizes using identity scale for sample size. Capping of some relationships (high sample sizes hitting a ceiling in (C) or low sample sizes hitting a floor in (B) results from simulation limitations - sample sizes were modelled from a minimum of 5 (per sex per group) and were capped at the first value exceeding 2000 individuals, as any such sample would anyway be already impractical).</span>
<span id="cb83-5823"><a href="#cb83-5823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5826"><a href="#cb83-5826" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-5827"><a href="#cb83-5827" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 13</span></span>
<span id="cb83-5828"><a href="#cb83-5828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5829"><a href="#cb83-5829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5830"><a href="#cb83-5830" aria-hidden="true" tabindex="-1"></a>comb2 <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(plot1<span class="fl">.1</span>, plot2<span class="fl">.1</span>, plot3<span class="fl">.1</span>, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">common.legend =</span> <span class="cn">TRUE</span>, <span class="at">legend =</span> <span class="st">"bottom"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>))</span>
<span id="cb83-5831"><a href="#cb83-5831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5832"><a href="#cb83-5832" aria-hidden="true" tabindex="-1"></a>comb2</span>
<span id="cb83-5833"><a href="#cb83-5833" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-5834"><a href="#cb83-5834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5835"><a href="#cb83-5835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5836"><a href="#cb83-5836" aria-hidden="true" tabindex="-1"></a>Combined plots demonstrating the impact of heteroscedasticity on power (repeated from section @sec-powerbreakdown) for a no-interaction case (A) and interaction-of-magnitude case (B; stronger effect in the more variable sex):</span>
<span id="cb83-5837"><a href="#cb83-5837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5840"><a href="#cb83-5840" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-5841"><a href="#cb83-5841" aria-hidden="true" tabindex="-1"></a>comb3 <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(plotA, plotB, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">common.legend =</span> <span class="cn">TRUE</span>, <span class="at">legend =</span> <span class="st">"bottom"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>))</span>
<span id="cb83-5842"><a href="#cb83-5842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5843"><a href="#cb83-5843" aria-hidden="true" tabindex="-1"></a>comb3</span>
<span id="cb83-5844"><a href="#cb83-5844" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-5845"><a href="#cb83-5845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5846"><a href="#cb83-5846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5847"><a href="#cb83-5847" aria-hidden="true" tabindex="-1"></a><span class="fu"># Source of heterogeneity</span></span>
<span id="cb83-5848"><a href="#cb83-5848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5849"><a href="#cb83-5849" aria-hidden="true" tabindex="-1"></a>Below plots show hypothetical scenarios when heterogeneity is a natural outcome of the underlying statistical process. Diagonal lines connect averages belonging to one treatment group (control vs. experimental). Thick vertical lines show SD of each subgroup.</span>
<span id="cb83-5850"><a href="#cb83-5850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5851"><a href="#cb83-5851" aria-hidden="true" tabindex="-1"></a><span class="fu">## Poisson distribution</span></span>
<span id="cb83-5852"><a href="#cb83-5852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5853"><a href="#cb83-5853" aria-hidden="true" tabindex="-1"></a>Simulation draws from $Pois(\lambda_i)$ assumes sex/treatment specific averages ($\lambda_i$) - see <span class="in">`lambda1...lambda4`</span> below.</span>
<span id="cb83-5854"><a href="#cb83-5854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5857"><a href="#cb83-5857" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-5858"><a href="#cb83-5858" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb83-5859"><a href="#cb83-5859" aria-hidden="true" tabindex="-1"></a>lambda1 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb83-5860"><a href="#cb83-5860" aria-hidden="true" tabindex="-1"></a>lambda2 <span class="ot">&lt;-</span> <span class="dv">9</span></span>
<span id="cb83-5861"><a href="#cb83-5861" aria-hidden="true" tabindex="-1"></a>lambda3 <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb83-5862"><a href="#cb83-5862" aria-hidden="true" tabindex="-1"></a>lambda4 <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb83-5863"><a href="#cb83-5863" aria-hidden="true" tabindex="-1"></a>toy_poisson <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb83-5864"><a href="#cb83-5864" aria-hidden="true" tabindex="-1"></a>    <span class="at">Treatment =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"Ctrl"</span>, <span class="dv">2</span><span class="sc">*</span>N), <span class="fu">rep</span>(<span class="st">"Exp"</span>, <span class="dv">2</span><span class="sc">*</span>N)),</span>
<span id="cb83-5865"><a href="#cb83-5865" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sex =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"F"</span>, N), <span class="fu">rep</span>(<span class="st">"M"</span>, N), <span class="fu">rep</span>(<span class="st">"F"</span>, N), <span class="fu">rep</span>(<span class="st">"M"</span>, N)),</span>
<span id="cb83-5866"><a href="#cb83-5866" aria-hidden="true" tabindex="-1"></a>    <span class="at">Response =</span> <span class="fu">c</span>(<span class="fu">rpois</span>(N, lambda1), <span class="fu">rpois</span>(N, lambda2), <span class="fu">rpois</span>(N, lambda3), <span class="fu">rpois</span>(N, lambda4))</span>
<span id="cb83-5867"><a href="#cb83-5867" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-5868"><a href="#cb83-5868" aria-hidden="true" tabindex="-1"></a>toy_poisson<span class="sc">$</span>Group <span class="ot">&lt;-</span> <span class="fu">interaction</span>(toy_poisson<span class="sc">$</span>Sex, toy_poisson<span class="sc">$</span>Treatment)</span>
<span id="cb83-5869"><a href="#cb83-5869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5870"><a href="#cb83-5870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5871"><a href="#cb83-5871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5872"><a href="#cb83-5872" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> toy_poisson, <span class="fu">aes</span>(<span class="at">x =</span> Response, <span class="at">y =</span> Group)) <span class="sc">+</span></span>
<span id="cb83-5873"><a href="#cb83-5873" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density_ridges</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Sex, <span class="at">scale =</span> <span class="fl">0.8</span>),</span>
<span id="cb83-5874"><a href="#cb83-5874" aria-hidden="true" tabindex="-1"></a>        <span class="at">stat =</span> <span class="st">"binline"</span>, <span class="at">bins =</span> <span class="dv">15</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">draw_baseline =</span> <span class="cn">FALSE</span></span>
<span id="cb83-5875"><a href="#cb83-5875" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb83-5876"><a href="#cb83-5876" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_ridges</span>() <span class="sc">+</span></span>
<span id="cb83-5877"><a href="#cb83-5877" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">stat =</span> <span class="st">"summary"</span>, <span class="at">fun =</span> <span class="st">"mean"</span>) <span class="sc">+</span></span>
<span id="cb83-5878"><a href="#cb83-5878" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_summary</span>(</span>
<span id="cb83-5879"><a href="#cb83-5879" aria-hidden="true" tabindex="-1"></a>        <span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"line"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>,</span>
<span id="cb83-5880"><a href="#cb83-5880" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">group =</span> Treatment, <span class="at">linetype =</span> Treatment)</span>
<span id="cb83-5881"><a href="#cb83-5881" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb83-5882"><a href="#cb83-5882" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_summary</span>(</span>
<span id="cb83-5883"><a href="#cb83-5883" aria-hidden="true" tabindex="-1"></a>        <span class="at">fun.max =</span> <span class="cf">function</span>(x) <span class="fu">mean</span>(x) <span class="sc">+</span> <span class="fu">sd</span>(x),</span>
<span id="cb83-5884"><a href="#cb83-5884" aria-hidden="true" tabindex="-1"></a>        <span class="at">fun.min =</span> <span class="cf">function</span>(x) <span class="fu">mean</span>(x) <span class="sc">-</span> <span class="fu">sd</span>(x), <span class="at">geom =</span> <span class="st">"errorbar"</span>,</span>
<span id="cb83-5885"><a href="#cb83-5885" aria-hidden="true" tabindex="-1"></a>        <span class="at">linewidth =</span> <span class="fl">1.5</span>, <span class="at">width =</span> <span class="dv">0</span></span>
<span id="cb83-5886"><a href="#cb83-5886" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb83-5887"><a href="#cb83-5887" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb83-5888"><a href="#cb83-5888" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb83-5889"><a href="#cb83-5889" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>))</span>
<span id="cb83-5890"><a href="#cb83-5890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5891"><a href="#cb83-5891" aria-hidden="true" tabindex="-1"></a><span class="co"># plot1</span></span>
<span id="cb83-5892"><a href="#cb83-5892" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-5893"><a href="#cb83-5893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5894"><a href="#cb83-5894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5895"><a href="#cb83-5895" aria-hidden="true" tabindex="-1"></a><span class="fu">## Log-normal distribution</span></span>
<span id="cb83-5896"><a href="#cb83-5896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5897"><a href="#cb83-5897" aria-hidden="true" tabindex="-1"></a>Simulation samples from $Lognormal(\mu_i, \sigma^2=0.1)$ with sex/treatment specific means (<span class="in">`mu1...mu4`</span>) below.</span>
<span id="cb83-5898"><a href="#cb83-5898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5899"><a href="#cb83-5899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5902"><a href="#cb83-5902" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-5903"><a href="#cb83-5903" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb83-5904"><a href="#cb83-5904" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb83-5905"><a href="#cb83-5905" aria-hidden="true" tabindex="-1"></a>mu2 <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-5906"><a href="#cb83-5906" aria-hidden="true" tabindex="-1"></a>mu3 <span class="ot">&lt;-</span> <span class="fl">0.4</span></span>
<span id="cb83-5907"><a href="#cb83-5907" aria-hidden="true" tabindex="-1"></a>mu4 <span class="ot">&lt;-</span> <span class="fl">0.8</span></span>
<span id="cb83-5908"><a href="#cb83-5908" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="fl">0.31</span></span>
<span id="cb83-5909"><a href="#cb83-5909" aria-hidden="true" tabindex="-1"></a>toy_lognorm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb83-5910"><a href="#cb83-5910" aria-hidden="true" tabindex="-1"></a>    <span class="at">Treatment =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"Ctrl"</span>, <span class="dv">2</span><span class="sc">*</span>N), <span class="fu">rep</span>(<span class="st">"Exp"</span>, <span class="dv">2</span><span class="sc">*</span>N)),</span>
<span id="cb83-5911"><a href="#cb83-5911" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sex =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"F"</span>, N), <span class="fu">rep</span>(<span class="st">"M"</span>, N), <span class="fu">rep</span>(<span class="st">"F"</span>, N), <span class="fu">rep</span>(<span class="st">"M"</span>, N)),</span>
<span id="cb83-5912"><a href="#cb83-5912" aria-hidden="true" tabindex="-1"></a>    <span class="at">Response =</span> <span class="fu">c</span>(<span class="fu">rlnorm</span>(N, mu1, sd), <span class="fu">rlnorm</span>(N, mu2, sd), <span class="fu">rlnorm</span>(N, mu3, sd), <span class="fu">rlnorm</span>(N, mu4, sd))</span>
<span id="cb83-5913"><a href="#cb83-5913" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-5914"><a href="#cb83-5914" aria-hidden="true" tabindex="-1"></a>toy_lognorm<span class="sc">$</span>Group <span class="ot">&lt;-</span> <span class="fu">interaction</span>(toy_poisson<span class="sc">$</span>Sex, toy_poisson<span class="sc">$</span>Treatment)</span>
<span id="cb83-5915"><a href="#cb83-5915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5916"><a href="#cb83-5916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5917"><a href="#cb83-5917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5918"><a href="#cb83-5918" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> figure1C <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> toy_lognorm, <span class="fu">aes</span>(<span class="at">x =</span> Response, <span class="at">y =</span> Group)) <span class="sc">+</span></span>
<span id="cb83-5919"><a href="#cb83-5919" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density_ridges</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Sex, <span class="at">scale =</span> <span class="fl">0.8</span>),</span>
<span id="cb83-5920"><a href="#cb83-5920" aria-hidden="true" tabindex="-1"></a>        <span class="at">stat =</span> <span class="st">"binline"</span>, <span class="at">bins =</span> <span class="dv">15</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">draw_baseline =</span> <span class="cn">FALSE</span></span>
<span id="cb83-5921"><a href="#cb83-5921" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb83-5922"><a href="#cb83-5922" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_ridges</span>() <span class="sc">+</span></span>
<span id="cb83-5923"><a href="#cb83-5923" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">stat =</span> <span class="st">"summary"</span>, <span class="at">fun =</span> <span class="st">"mean"</span>) <span class="sc">+</span></span>
<span id="cb83-5924"><a href="#cb83-5924" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_summary</span>(</span>
<span id="cb83-5925"><a href="#cb83-5925" aria-hidden="true" tabindex="-1"></a>        <span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"line"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>,</span>
<span id="cb83-5926"><a href="#cb83-5926" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">group =</span> Treatment, <span class="at">linetype =</span> Treatment)</span>
<span id="cb83-5927"><a href="#cb83-5927" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb83-5928"><a href="#cb83-5928" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_summary</span>(</span>
<span id="cb83-5929"><a href="#cb83-5929" aria-hidden="true" tabindex="-1"></a>        <span class="at">fun.max =</span> <span class="cf">function</span>(x) <span class="fu">mean</span>(x) <span class="sc">+</span> <span class="fu">sd</span>(x),</span>
<span id="cb83-5930"><a href="#cb83-5930" aria-hidden="true" tabindex="-1"></a>        <span class="at">fun.min =</span> <span class="cf">function</span>(x) <span class="fu">mean</span>(x) <span class="sc">-</span> <span class="fu">sd</span>(x), <span class="at">geom =</span> <span class="st">"errorbar"</span>,</span>
<span id="cb83-5931"><a href="#cb83-5931" aria-hidden="true" tabindex="-1"></a>        <span class="at">linewidth =</span> <span class="fl">1.5</span>, <span class="at">width =</span> <span class="dv">0</span></span>
<span id="cb83-5932"><a href="#cb83-5932" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb83-5933"><a href="#cb83-5933" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb83-5934"><a href="#cb83-5934" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb83-5935"><a href="#cb83-5935" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>))</span>
<span id="cb83-5936"><a href="#cb83-5936" aria-hidden="true" tabindex="-1"></a><span class="co"># plot2</span></span>
<span id="cb83-5937"><a href="#cb83-5937" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-5938"><a href="#cb83-5938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5939"><a href="#cb83-5939" aria-hidden="true" tabindex="-1"></a><span class="fu">## Combined plot</span></span>
<span id="cb83-5940"><a href="#cb83-5940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5943"><a href="#cb83-5943" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-5944"><a href="#cb83-5944" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-label: fig:source_hetero1</span></span>
<span id="cb83-5945"><a href="#cb83-5945" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Simulated sex-by-treatment data using a Poisson (A) and log-normal (B) distribution. Diagonal lines connect averages belonging to one treatment group (control vs. experimental). Thick vertical lines show SD of each subgroup.</span></span>
<span id="cb83-5946"><a href="#cb83-5946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5947"><a href="#cb83-5947" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(plot1, plot2, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">1</span>,</span>
<span id="cb83-5948"><a href="#cb83-5948" aria-hidden="true" tabindex="-1"></a><span class="at">common.legend =</span> <span class="cn">TRUE</span>, <span class="at">legend =</span> <span class="st">"bottom"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>))</span>
<span id="cb83-5949"><a href="#cb83-5949" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-5950"><a href="#cb83-5950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5951"><a href="#cb83-5951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5952"><a href="#cb83-5952" aria-hidden="true" tabindex="-1"></a><span class="fu">## Non-linear response in sexes</span></span>
<span id="cb83-5953"><a href="#cb83-5953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5954"><a href="#cb83-5954" aria-hidden="true" tabindex="-1"></a>Heterogeneity in variances may also arise if the underlying phenotypic mapping function is non linear and has saturating/desaturating character in a range modified by sex dimorphism and/or experimental treatment.</span>
<span id="cb83-5955"><a href="#cb83-5955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5956"><a href="#cb83-5956" aria-hidden="true" tabindex="-1"></a>Here we assume a logistic function:</span>
<span id="cb83-5957"><a href="#cb83-5957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5958"><a href="#cb83-5958" aria-hidden="true" tabindex="-1"></a>$$f(x)=\frac{L}{e^{-k(x-x_0)}}$$</span>
<span id="cb83-5959"><a href="#cb83-5959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5960"><a href="#cb83-5960" aria-hidden="true" tabindex="-1"></a>with parameter values: <span class="in">`L = 3.5`</span>, <span class="in">`k = 1`</span>, <span class="in">`x0 = 1`</span>.</span>
<span id="cb83-5961"><a href="#cb83-5961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5964"><a href="#cb83-5964" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-5965"><a href="#cb83-5965" aria-hidden="true" tabindex="-1"></a>mapping_logistic <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">L =</span> <span class="fl">3.5</span>, <span class="at">x0 =</span> <span class="dv">1</span>, <span class="at">k =</span> <span class="dv">1</span>) L<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">*</span>k<span class="sc">*</span>(x <span class="sc">-</span> x0)))</span>
<span id="cb83-5966"><a href="#cb83-5966" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-5967"><a href="#cb83-5967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5968"><a href="#cb83-5968" aria-hidden="true" tabindex="-1"></a>Using this function, we can generate data assuming some treatment and sex differences:</span>
<span id="cb83-5969"><a href="#cb83-5969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5972"><a href="#cb83-5972" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-5973"><a href="#cb83-5973" aria-hidden="true" tabindex="-1"></a>SD_N <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb83-5974"><a href="#cb83-5974" aria-hidden="true" tabindex="-1"></a>mu_env1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb83-5975"><a href="#cb83-5975" aria-hidden="true" tabindex="-1"></a>mu_env2 <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb83-5976"><a href="#cb83-5976" aria-hidden="true" tabindex="-1"></a>mu_env3 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb83-5977"><a href="#cb83-5977" aria-hidden="true" tabindex="-1"></a>mu_env4 <span class="ot">&lt;-</span> <span class="fl">4.5</span></span>
<span id="cb83-5978"><a href="#cb83-5978" aria-hidden="true" tabindex="-1"></a>toy_nonlin <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb83-5979"><a href="#cb83-5979" aria-hidden="true" tabindex="-1"></a>    <span class="at">Treatment =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"Ctrl"</span>, <span class="dv">2</span> <span class="sc">*</span> N), <span class="fu">rep</span>(<span class="st">"Exp"</span>, <span class="dv">2</span> <span class="sc">*</span> N)),</span>
<span id="cb83-5980"><a href="#cb83-5980" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sex =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"F"</span>, N), <span class="fu">rep</span>(<span class="st">"M"</span>, N), <span class="fu">rep</span>(<span class="st">"F"</span>, N), <span class="fu">rep</span>(<span class="st">"M"</span>, N)),</span>
<span id="cb83-5981"><a href="#cb83-5981" aria-hidden="true" tabindex="-1"></a>    <span class="at">Env =</span> <span class="fu">c</span>(</span>
<span id="cb83-5982"><a href="#cb83-5982" aria-hidden="true" tabindex="-1"></a>        <span class="fu">rnorm</span>(N, mu_env1, SD_N), <span class="fu">rnorm</span>(N, mu_env2, SD_N),</span>
<span id="cb83-5983"><a href="#cb83-5983" aria-hidden="true" tabindex="-1"></a>        <span class="fu">rnorm</span>(N, mu_env3, SD_N), <span class="fu">rnorm</span>(N, mu_env4, SD_N)</span>
<span id="cb83-5984"><a href="#cb83-5984" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-5985"><a href="#cb83-5985" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-5986"><a href="#cb83-5986" aria-hidden="true" tabindex="-1"></a>toy_nonlin<span class="sc">$</span>Response <span class="ot">&lt;-</span> <span class="fu">mapping_logistic</span>(toy_nonlin<span class="sc">$</span>Env)</span>
<span id="cb83-5987"><a href="#cb83-5987" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-5988"><a href="#cb83-5988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5989"><a href="#cb83-5989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5992"><a href="#cb83-5992" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-5993"><a href="#cb83-5993" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-label: source_hetero2</span></span>
<span id="cb83-5994"><a href="#cb83-5994" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Heteroscedasticity between sexes (colours) and treatment groups (solid/dashed lines) resulting from a non-linear (here - logistic) mapping of some manipulated environemntal variable into the measured response. Thin dotted line - underlying mapping function. Points - realisations of mapping for simulated environmental data. Histograms relate to observed response measurements.</span></span>
<span id="cb83-5995"><a href="#cb83-5995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5996"><a href="#cb83-5996" aria-hidden="true" tabindex="-1"></a>figure1D <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb83-5997"><a href="#cb83-5997" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(</span>
<span id="cb83-5998"><a href="#cb83-5998" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> toy_nonlin,</span>
<span id="cb83-5999"><a href="#cb83-5999" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">y =</span> Env, <span class="at">x =</span> Response, <span class="at">colour =</span> Sex),</span>
<span id="cb83-6000"><a href="#cb83-6000" aria-hidden="true" tabindex="-1"></a>        <span class="at">pch =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.8</span></span>
<span id="cb83-6001"><a href="#cb83-6001" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb83-6002"><a href="#cb83-6002" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(</span>
<span id="cb83-6003"><a href="#cb83-6003" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="dv">2</span>,</span>
<span id="cb83-6004"><a href="#cb83-6004" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">8</span>, <span class="fl">0.1</span>), <span class="at">x =</span> <span class="fu">mapping_logistic</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">8</span>, <span class="fl">0.1</span>)))</span>
<span id="cb83-6005"><a href="#cb83-6005" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb83-6006"><a href="#cb83-6006" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density_ridges</span>(</span>
<span id="cb83-6007"><a href="#cb83-6007" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> toy_nonlin <span class="sc">%&gt;%</span></span>
<span id="cb83-6008"><a href="#cb83-6008" aria-hidden="true" tabindex="-1"></a>            <span class="fu">group_by</span>(Sex, Treatment) <span class="sc">%&gt;%</span></span>
<span id="cb83-6009"><a href="#cb83-6009" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mutate</span>(<span class="at">meanEnv =</span> <span class="fu">mean</span>(Env)),</span>
<span id="cb83-6010"><a href="#cb83-6010" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">x =</span> Response, <span class="at">group =</span> meanEnv, <span class="at">y =</span> meanEnv, <span class="at">fill =</span> Sex),</span>
<span id="cb83-6011"><a href="#cb83-6011" aria-hidden="true" tabindex="-1"></a>        <span class="at">stat =</span> <span class="st">"binline"</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">draw_baseline =</span> F</span>
<span id="cb83-6012"><a href="#cb83-6012" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb83-6013"><a href="#cb83-6013" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(</span>
<span id="cb83-6014"><a href="#cb83-6014" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> toy_nonlin <span class="sc">%&gt;%</span></span>
<span id="cb83-6015"><a href="#cb83-6015" aria-hidden="true" tabindex="-1"></a>            <span class="fu">group_by</span>(Sex, Treatment) <span class="sc">%&gt;%</span></span>
<span id="cb83-6016"><a href="#cb83-6016" aria-hidden="true" tabindex="-1"></a>            <span class="fu">summarise</span>(<span class="at">meanEnv =</span> <span class="fu">mean</span>(Env), <span class="at">meanResp =</span> <span class="fu">mean</span>(Response)),</span>
<span id="cb83-6017"><a href="#cb83-6017" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">x =</span> meanResp, <span class="at">y =</span> meanEnv),</span>
<span id="cb83-6018"><a href="#cb83-6018" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="dv">4</span></span>
<span id="cb83-6019"><a href="#cb83-6019" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb83-6020"><a href="#cb83-6020" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(</span>
<span id="cb83-6021"><a href="#cb83-6021" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> toy_nonlin <span class="sc">%&gt;%</span></span>
<span id="cb83-6022"><a href="#cb83-6022" aria-hidden="true" tabindex="-1"></a>            <span class="fu">group_by</span>(Sex, Treatment) <span class="sc">%&gt;%</span></span>
<span id="cb83-6023"><a href="#cb83-6023" aria-hidden="true" tabindex="-1"></a>            <span class="fu">summarise</span>(<span class="at">meanEnv =</span> <span class="fu">mean</span>(Env), <span class="at">meanResp =</span> <span class="fu">mean</span>(Response)),</span>
<span id="cb83-6024"><a href="#cb83-6024" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">x =</span> meanResp, <span class="at">y =</span> meanEnv, <span class="at">linetype =</span> Treatment),</span>
<span id="cb83-6025"><a href="#cb83-6025" aria-hidden="true" tabindex="-1"></a>        <span class="at">linewidth =</span> <span class="dv">1</span></span>
<span id="cb83-6026"><a href="#cb83-6026" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb83-6027"><a href="#cb83-6027" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbarh</span>(</span>
<span id="cb83-6028"><a href="#cb83-6028" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> toy_nonlin <span class="sc">%&gt;%</span></span>
<span id="cb83-6029"><a href="#cb83-6029" aria-hidden="true" tabindex="-1"></a>            <span class="fu">group_by</span>(Sex, Treatment) <span class="sc">%&gt;%</span></span>
<span id="cb83-6030"><a href="#cb83-6030" aria-hidden="true" tabindex="-1"></a>            <span class="fu">summarise</span>(<span class="at">meanEnv =</span> <span class="fu">mean</span>(Env), <span class="at">meanResp =</span> <span class="fu">mean</span>(Response),</span>
<span id="cb83-6031"><a href="#cb83-6031" aria-hidden="true" tabindex="-1"></a>            <span class="at">minResp =</span> <span class="fu">mean</span>(Response) <span class="sc">-</span> <span class="fu">sd</span>(Response),</span>
<span id="cb83-6032"><a href="#cb83-6032" aria-hidden="true" tabindex="-1"></a>            <span class="at">maxResp =</span> <span class="fu">mean</span>(Response) <span class="sc">+</span> <span class="fu">sd</span>(Response)),</span>
<span id="cb83-6033"><a href="#cb83-6033" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">y =</span> meanEnv, <span class="at">xmin =</span> minResp, <span class="at">xmax =</span> maxResp),</span>
<span id="cb83-6034"><a href="#cb83-6034" aria-hidden="true" tabindex="-1"></a>        <span class="at">linewidth =</span> <span class="fl">1.5</span>, <span class="at">height =</span> <span class="dv">0</span></span>
<span id="cb83-6035"><a href="#cb83-6035" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span> <span class="fu">guides</span>(<span class="at">colour =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb83-6036"><a href="#cb83-6036" aria-hidden="true" tabindex="-1"></a>    <span class="co"># stat_summary(data = toy_nonlin %&gt;%</span></span>
<span id="cb83-6037"><a href="#cb83-6037" aria-hidden="true" tabindex="-1"></a>    <span class="co">#         group_by(Sex, Treatment) %&gt;%</span></span>
<span id="cb83-6038"><a href="#cb83-6038" aria-hidden="true" tabindex="-1"></a>    <span class="co">#         mutate(meanEnv = mean(Env)),</span></span>
<span id="cb83-6039"><a href="#cb83-6039" aria-hidden="true" tabindex="-1"></a>    <span class="co">#     fun = "mean", geom = "line", linewidth = 1,</span></span>
<span id="cb83-6040"><a href="#cb83-6040" aria-hidden="true" tabindex="-1"></a>    <span class="co">#     aes(x = Response, group = meanEnv, y = meanEnv, linetype = Treatment)</span></span>
<span id="cb83-6041"><a href="#cb83-6041" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ) +</span></span>
<span id="cb83-6042"><a href="#cb83-6042" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Manipulated environmental variable"</span>) <span class="sc">+</span></span>
<span id="cb83-6043"><a href="#cb83-6043" aria-hidden="true" tabindex="-1"></a>    <span class="co"># theme_ridges() +</span></span>
<span id="cb83-6044"><a href="#cb83-6044" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>))</span>
<span id="cb83-6045"><a href="#cb83-6045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-6046"><a href="#cb83-6046" aria-hidden="true" tabindex="-1"></a>figure1D</span>
<span id="cb83-6047"><a href="#cb83-6047" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-6048"><a href="#cb83-6048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-6049"><a href="#cb83-6049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-6050"><a href="#cb83-6050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-6051"><a href="#cb83-6051" aria-hidden="true" tabindex="-1"></a><span class="fu"># Taylor law in comparative data</span></span>
<span id="cb83-6052"><a href="#cb83-6052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-6053"><a href="#cb83-6053" aria-hidden="true" tabindex="-1"></a>Here we use previously published synthetic data to demonstrate the degree and ubiquity of mean-variance relationships typical to the Taylor's law.</span>
<span id="cb83-6054"><a href="#cb83-6054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-6055"><a href="#cb83-6055" aria-hidden="true" tabindex="-1"></a>First let's load the relevant data.</span>
<span id="cb83-6056"><a href="#cb83-6056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-6059"><a href="#cb83-6059" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-6060"><a href="#cb83-6060" aria-hidden="true" tabindex="-1"></a>data_all <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"ALL_TRAITS_20200514.xlsx"</span>), <span class="at">sheet =</span> <span class="st">"main"</span>)</span>
<span id="cb83-6061"><a href="#cb83-6061" aria-hidden="true" tabindex="-1"></a><span class="co"># names(data_all)</span></span>
<span id="cb83-6062"><a href="#cb83-6062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-6063"><a href="#cb83-6063" aria-hidden="true" tabindex="-1"></a><span class="do">## analyses on adiposity [g] data only:</span></span>
<span id="cb83-6064"><a href="#cb83-6064" aria-hidden="true" tabindex="-1"></a>data_all <span class="sc">%&gt;%</span></span>
<span id="cb83-6065"><a href="#cb83-6065" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Trait <span class="sc">==</span> <span class="st">"Adiposity"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-6066"><a href="#cb83-6066" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(Paper_ID)</span>
<span id="cb83-6067"><a href="#cb83-6067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-6068"><a href="#cb83-6068" aria-hidden="true" tabindex="-1"></a><span class="co"># offspring ages</span></span>
<span id="cb83-6069"><a href="#cb83-6069" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data_all<span class="sc">$</span>Age_at_Measurement_Days[data_all<span class="sc">$</span>Trait <span class="sc">==</span> <span class="st">"Adiposity"</span>])</span>
<span id="cb83-6070"><a href="#cb83-6070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-6071"><a href="#cb83-6071" aria-hidden="true" tabindex="-1"></a><span class="co"># species</span></span>
<span id="cb83-6072"><a href="#cb83-6072" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">factor</span>(data_all<span class="sc">$</span>Rodent_Type[data_all<span class="sc">$</span>Trait <span class="sc">==</span> <span class="st">"Adiposity"</span>]))</span>
<span id="cb83-6073"><a href="#cb83-6073" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-6074"><a href="#cb83-6074" aria-hidden="true" tabindex="-1"></a><span class="co"># merge control and treatment data (all traits)</span></span>
<span id="cb83-6075"><a href="#cb83-6075" aria-hidden="true" tabindex="-1"></a>dataA <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb83-6076"><a href="#cb83-6076" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">c</span>(data_all<span class="sc">$</span>Mean_Treatment, data_all<span class="sc">$</span>Mean_Control),</span>
<span id="cb83-6077"><a href="#cb83-6077" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd =</span> <span class="fu">c</span>(data_all<span class="sc">$</span>SD_Treatment, data_all<span class="sc">$</span>SD_Control),</span>
<span id="cb83-6078"><a href="#cb83-6078" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fu">c</span>(data_all<span class="sc">$</span>Sample_Size_n_Treatment, data_all<span class="sc">$</span>Sample_Size_n_Control),</span>
<span id="cb83-6079"><a href="#cb83-6079" aria-hidden="true" tabindex="-1"></a>    <span class="at">sex =</span> <span class="fu">c</span>(data_all<span class="sc">$</span>Offspring_Sex, data_all<span class="sc">$</span>Offspring_Sex),</span>
<span id="cb83-6080"><a href="#cb83-6080" aria-hidden="true" tabindex="-1"></a>    <span class="at">trait =</span> <span class="fu">c</span>(data_all<span class="sc">$</span>Trait, data_all<span class="sc">$</span>Trait),</span>
<span id="cb83-6081"><a href="#cb83-6081" aria-hidden="true" tabindex="-1"></a>    <span class="at">species =</span> <span class="fu">c</span>(data_all<span class="sc">$</span>Rodent_Type, data_all<span class="sc">$</span>Rodent_Type)</span>
<span id="cb83-6082"><a href="#cb83-6082" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-6083"><a href="#cb83-6083" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-6084"><a href="#cb83-6084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-6085"><a href="#cb83-6085" aria-hidden="true" tabindex="-1"></a>Plotting individual subplots for mice, rats, and both species jointly.</span>
<span id="cb83-6086"><a href="#cb83-6086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-6089"><a href="#cb83-6089" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-6090"><a href="#cb83-6090" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb83-6091"><a href="#cb83-6091" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 10</span></span>
<span id="cb83-6092"><a href="#cb83-6092" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb83-6093"><a href="#cb83-6093" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb83-6094"><a href="#cb83-6094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-6095"><a href="#cb83-6095" aria-hidden="true" tabindex="-1"></a>dataA <span class="sc">%&gt;%</span></span>
<span id="cb83-6096"><a href="#cb83-6096" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(trait <span class="sc">==</span> <span class="st">"Adiposity"</span> <span class="sc">&amp;</span> species <span class="sc">==</span> <span class="st">"Mouse"</span>) <span class="sc">%$%</span></span>
<span id="cb83-6097"><a href="#cb83-6097" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cor.test</span>(<span class="fu">log</span>(mean), <span class="fu">log</span>(sd)) <span class="ot">-&gt;</span> cor_mice <span class="co"># calculate correlation</span></span>
<span id="cb83-6098"><a href="#cb83-6098" aria-hidden="true" tabindex="-1"></a>figA <span class="ot">&lt;-</span> dataA <span class="sc">%&gt;%</span></span>
<span id="cb83-6099"><a href="#cb83-6099" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(trait <span class="sc">==</span> <span class="st">"Adiposity"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-6100"><a href="#cb83-6100" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(species <span class="sc">==</span> <span class="st">"Mouse"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-6101"><a href="#cb83-6101" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log</span>(mean), <span class="at">y =</span> <span class="fu">log</span>(sd), <span class="at">col =</span> sex)) <span class="sc">+</span></span>
<span id="cb83-6102"><a href="#cb83-6102" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> size), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb83-6103"><a href="#cb83-6103" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb83-6104"><a href="#cb83-6104" aria-hidden="true" tabindex="-1"></a>    <span class="co"># coord_trans(x = "log10", y = "log10") +</span></span>
<span id="cb83-6105"><a href="#cb83-6105" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">guides</span>(<span class="at">size =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb83-6106"><a href="#cb83-6106" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Mouse adiposity"</span>, <span class="at">x =</span> <span class="st">"ln (mean)"</span>, <span class="at">y =</span> <span class="st">"ln (SD)"</span>,</span>
<span id="cb83-6107"><a href="#cb83-6107" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"Sex"</span>) <span class="sc">+</span></span>
<span id="cb83-6108"><a href="#cb83-6108" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>), <span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb83-6109"><a href="#cb83-6109" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">x =</span> <span class="sc">-</span><span class="fl">5.2</span>, <span class="at">y =</span> <span class="fl">1.5</span>, <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"italic(r) == %.2f"</span>, cor_mice<span class="sc">$</span>estimate)), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">5</span>)</span>
<span id="cb83-6110"><a href="#cb83-6110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-6111"><a href="#cb83-6111" aria-hidden="true" tabindex="-1"></a>dataA <span class="sc">%&gt;%</span></span>
<span id="cb83-6112"><a href="#cb83-6112" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(trait <span class="sc">==</span> <span class="st">"Adiposity"</span> <span class="sc">&amp;</span> species <span class="sc">==</span> <span class="st">"Rat"</span>) <span class="sc">%$%</span></span>
<span id="cb83-6113"><a href="#cb83-6113" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cor.test</span>(<span class="fu">log</span>(mean), <span class="fu">log</span>(sd)) <span class="ot">-&gt;</span> cor_rats <span class="co"># calculate correlation</span></span>
<span id="cb83-6114"><a href="#cb83-6114" aria-hidden="true" tabindex="-1"></a>figB <span class="ot">&lt;-</span> dataA <span class="sc">%&gt;%</span></span>
<span id="cb83-6115"><a href="#cb83-6115" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(trait <span class="sc">==</span> <span class="st">"Adiposity"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-6116"><a href="#cb83-6116" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(species <span class="sc">==</span> <span class="st">"Rat"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-6117"><a href="#cb83-6117" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log</span>(mean), <span class="at">y =</span> <span class="fu">log</span>(sd), <span class="at">col =</span> sex)) <span class="sc">+</span></span>
<span id="cb83-6118"><a href="#cb83-6118" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> size), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb83-6119"><a href="#cb83-6119" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb83-6120"><a href="#cb83-6120" aria-hidden="true" tabindex="-1"></a>    <span class="co"># coord_trans(x = "log10", y = "log10") +</span></span>
<span id="cb83-6121"><a href="#cb83-6121" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">guides</span>(<span class="at">size =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb83-6122"><a href="#cb83-6122" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Rat adiposity"</span>, <span class="at">x =</span> <span class="st">"ln (mean)"</span>, <span class="at">y =</span> <span class="st">"ln (SD)"</span>,</span>
<span id="cb83-6123"><a href="#cb83-6123" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"Sex"</span>) <span class="sc">+</span></span>
<span id="cb83-6124"><a href="#cb83-6124" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>), <span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb83-6125"><a href="#cb83-6125" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">y =</span> <span class="dv">4</span>, <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"italic(r) == %.2f"</span>, cor_rats<span class="sc">$</span>estimate)), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">5</span>)</span>
<span id="cb83-6126"><a href="#cb83-6126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-6127"><a href="#cb83-6127" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation - all</span></span>
<span id="cb83-6128"><a href="#cb83-6128" aria-hidden="true" tabindex="-1"></a>dataA <span class="sc">%&gt;%</span></span>
<span id="cb83-6129"><a href="#cb83-6129" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(trait <span class="sc">==</span> <span class="st">"Adiposity"</span>) <span class="sc">%$%</span></span>
<span id="cb83-6130"><a href="#cb83-6130" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cor.test</span>(<span class="fu">log</span>(mean), <span class="fu">log</span>(sd)) <span class="ot">-&gt;</span> cor_all</span>
<span id="cb83-6131"><a href="#cb83-6131" aria-hidden="true" tabindex="-1"></a>figC <span class="ot">&lt;-</span> dataA <span class="sc">%&gt;%</span></span>
<span id="cb83-6132"><a href="#cb83-6132" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(trait <span class="sc">==</span> <span class="st">"Adiposity"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-6133"><a href="#cb83-6133" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log</span>(mean), <span class="at">y =</span> <span class="fu">log</span>(sd), <span class="at">col =</span> sex)) <span class="sc">+</span></span>
<span id="cb83-6134"><a href="#cb83-6134" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> size), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb83-6135"><a href="#cb83-6135" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb83-6136"><a href="#cb83-6136" aria-hidden="true" tabindex="-1"></a>    <span class="co"># coord_trans(x = "log10", y = "log10") +</span></span>
<span id="cb83-6137"><a href="#cb83-6137" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">guides</span>(<span class="at">size =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb83-6138"><a href="#cb83-6138" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Mouse and rat adiposity"</span>, <span class="at">x =</span> <span class="st">"ln (mean)"</span>, <span class="at">y =</span> <span class="st">"ln (SD)"</span>) <span class="sc">+</span></span>
<span id="cb83-6139"><a href="#cb83-6139" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>), <span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb83-6140"><a href="#cb83-6140" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">y =</span> <span class="dv">4</span>, <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"italic(r) == %.2f"</span>, cor_all<span class="sc">$</span>estimate)), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">5</span>)</span>
<span id="cb83-6141"><a href="#cb83-6141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-6142"><a href="#cb83-6142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-6143"><a href="#cb83-6143" aria-hidden="true" tabindex="-1"></a><span class="co"># assemble the panels using patchwork package</span></span>
<span id="cb83-6144"><a href="#cb83-6144" aria-hidden="true" tabindex="-1"></a>figure1 <span class="ot">&lt;-</span> figA <span class="sc">/</span> figB <span class="sc">/</span> figC <span class="sc">+</span></span>
<span id="cb83-6145"><a href="#cb83-6145" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">3</span>,</span>
<span id="cb83-6146"><a href="#cb83-6146" aria-hidden="true" tabindex="-1"></a>    <span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">1.1</span>))</span>
<span id="cb83-6147"><a href="#cb83-6147" aria-hidden="true" tabindex="-1"></a>figure1</span>
<span id="cb83-6148"><a href="#cb83-6148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-6149"><a href="#cb83-6149" aria-hidden="true" tabindex="-1"></a>figure1AB <span class="ot">&lt;-</span> figA <span class="sc">/</span> figB <span class="sc">+</span></span>
<span id="cb83-6150"><a href="#cb83-6150" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">guides =</span> <span class="st">"collect"</span>) <span class="sc">+</span></span>
<span id="cb83-6151"><a href="#cb83-6151" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"A"</span>) <span class="sc">&amp;</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>)</span>
<span id="cb83-6152"><a href="#cb83-6152" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-6153"><a href="#cb83-6153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-6154"><a href="#cb83-6154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-6157"><a href="#cb83-6157" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-6158"><a href="#cb83-6158" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb83-6159"><a href="#cb83-6159" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb83-6160"><a href="#cb83-6160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-6161"><a href="#cb83-6161" aria-hidden="true" tabindex="-1"></a><span class="co"># chunk to save the figure - not printed to html</span></span>
<span id="cb83-6162"><a href="#cb83-6162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-6163"><a href="#cb83-6163" aria-hidden="true" tabindex="-1"></a>figure1 <span class="ot">&lt;-</span> figure1AB <span class="sc">/</span></span>
<span id="cb83-6164"><a href="#cb83-6164" aria-hidden="true" tabindex="-1"></a>    ((figure1C <span class="sc">|</span> figure1D) <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>)) <span class="sc">+</span></span>
<span id="cb83-6165"><a href="#cb83-6165" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"A"</span>)</span>
<span id="cb83-6166"><a href="#cb83-6166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-6167"><a href="#cb83-6167" aria-hidden="true" tabindex="-1"></a>figure2 <span class="ot">&lt;-</span> ((plot1<span class="fl">.1</span> <span class="sc">|</span> plot2<span class="fl">.1</span> <span class="sc">|</span> plot3<span class="fl">.1</span>) <span class="sc">+</span></span>
<span id="cb83-6168"><a href="#cb83-6168" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>) <span class="sc">&amp;</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)) <span class="sc">/</span></span>
<span id="cb83-6169"><a href="#cb83-6169" aria-hidden="true" tabindex="-1"></a>    ((plotA <span class="sc">|</span> plotB) <span class="sc">+</span></span>
<span id="cb83-6170"><a href="#cb83-6170" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>) <span class="sc">&amp;</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)) <span class="sc">+</span></span>
<span id="cb83-6171"><a href="#cb83-6171" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"A"</span>)</span>
<span id="cb83-6172"><a href="#cb83-6172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-6173"><a href="#cb83-6173" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">plot =</span> figure1, <span class="st">"Figure1_v1.pdf"</span>, <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">units =</span> <span class="st">"cm"</span>, <span class="at">scale =</span> <span class="dv">2</span>)</span>
<span id="cb83-6174"><a href="#cb83-6174" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">plot =</span> figure2, <span class="st">"Figure2_v1.pdf"</span>, <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">units =</span> <span class="st">"cm"</span>, <span class="at">scale =</span> <span class="dv">2</span>)</span>
<span id="cb83-6175"><a href="#cb83-6175" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>